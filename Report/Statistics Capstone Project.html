<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Harper Kates">
<meta name="dcterms.date" content="2022-09-01">

<title>Statistics Capstone Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Statistics Capstone Project_files/libs/clipboard/clipboard.min.js"></script>
<script src="Statistics Capstone Project_files/libs/quarto-html/quarto.js"></script>
<script src="Statistics Capstone Project_files/libs/quarto-html/popper.min.js"></script>
<script src="Statistics Capstone Project_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Statistics Capstone Project_files/libs/quarto-html/anchor.min.js"></script>
<link href="Statistics Capstone Project_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Statistics Capstone Project_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Statistics Capstone Project_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Statistics Capstone Project_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Statistics Capstone Project_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Statistics Capstone Project</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Harper Kates </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 1, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="template-final-paper" class="level2">
<h2 class="anchored" data-anchor-id="template-final-paper">Template Final Paper</h2>
<p>Your paper should be written in single-spaced text. The title and abstract should be on a separate page (with no other information listed). You should use Arial, 11 pt font, single spaced with standard 1 inch margins. Each section (or subsection) should receive a heading.</p>
<p>While there are no specific structural limitations to the paper, one possible structure is suggested below.</p>
<ul>
<li>Title (on title page)</li>
<li>Abstract (on title page)</li>
<li>Background and Significance</li>
<li>Methods</li>
<li>Results</li>
<li>Discussion/Conclusions</li>
<li>References</li>
</ul>
<section id="title" class="level3">
<h3 class="anchored" data-anchor-id="title">1. Title</h3>
<p>No Easy Solution: An Observational Study on the Effects of Various Factors on Traffic Congestion and Highway Fatalities</p>
<p>Assessment: Does the title give an accurate preview of what the paper is about? Is it informative, specific and precise?</p>
</section>
<section id="abstract" class="level3">
<h3 class="anchored" data-anchor-id="abstract">2. Abstract</h3>
<p>Traffic congestion is an important subject to study, as the negative effects and complexities of this issue are well-documented. Prior research hypothesizes that public transportation is negatively correlated to traffic congestion, but this study also analyzed many different variables such as demographic data, health data, and housing data to see if there are other factors. This study uses four different traffic-related metrics across the US, with three at the city level and one at the state level, as well as an extra time series graph to show public transport ridership over time. The results show that variables including region of the US, binge drinking, and people per household all play noticeable roles in explaining traffic congestion, while variables such as median income, gas usage, and miles driven are better for explaining highway fatality rate. The results also found that public transport ridership is positively correlated with traffic congestion, which can be explained by the fact that cities that naturally have more traffic congestion will invest in public transportation as a potential solution. Overall, the study does not find any significant evidence to confirm or reject the hypothesis that public transportation is good for traffic, but it introduces many new variables that can intuitively have a noticeable effect on how traffic works.</p>
</section>
<section id="background-and-significance" class="level3">
<h3 class="anchored" data-anchor-id="background-and-significance">3. Background and significance</h3>
<p>Traffic congestion is something that almost everyone has experienced at least sometime in their lives, some people more than others. There are many negative effects of traffic congestion, but there does not exist an easy “solution” to this problem. Some of these negative effects can be practical, such as losing hours due to congestion and potentially being late to important events. It can also have psychological effects, as seen in “road rage,” where even the most mild-mannered driver can become irritable and unforgiving towards other drivers. In fact, there is scientific evidence that traffic congestion is heavily correlated with increased levels of stress and anxiety, which leads to a decline in mental health (Nadrian et al., 2019). The closest we have to a “solution” to traffic congestion is investing more in public transportation, but this may not work as well in less densely populated areas. This is because public transportation works over a specific area, so it will be more effective for densely populated areas than for less densely populated areas. Some public transportation experts state that the threshold for implementing reliable public transportation systems is around 3,000 people per square mile (Binkovitz 2018), but this number can potentially change as many newer cities are starting to fall short of this mark. This phenomenon can sometimes make up for the natural development of traffic congestion that more often appears in densely populated areas. After studying the effects of public transportation, one can ask why cities are less densely populated in the first place if their lack of density lowers the effectiveness of public transportation.</p>
<p>Traffic congestion is a valuable subject to study, but why did I specifically choose traffic congestion as my topic of choice? I have always been intrigued (mainly frustrated) by traffic congestion in the area where I grew up. For reference, I grew up in the Nashville metropolitan area, an area of the US infamous for its traffic congestion and inexplicably common occurrences of highway accidents. This level of congestion is not only present on highways; it is arguably worse within major cities such as Nashville, Murfreesboro, or Franklin. Furthermore, the way cities in the area have been constructed yields traffic congestion in pretty much every part of the city, not just the city center. There have been countless examples of my car going at an average speed lower than my walking speed for minutes at a time, which prompts me to ask this question time and time again: How is this an acceptable way to live?</p>
<p>A less emotionally charged reason as to why I chose this subject is because there are plenty of statistics out there pertaining to not only traffic metrics, but other factors that may explain/relate to said traffic metrics. These other factors can be demographics, health factors, education, etc. Studying traffic patterns will inevitably involve statistics in some form, so this subject would be perfect for a statistics-based project. However, it is important to make the distinction between correlation and causation. Many things are said to “cause” traffic congestion, but some of these factors may just be simple correlations. I decided to do an observational study on traffic factors, so no conclusions on causation can be made, but I will make note of factors that can reasonably have a causal relationship with traffic metrics.</p>
<p>I have personally heard many good things about public transportation and how it can be a remedy for traffic congestion, but, being from an area with poor public transportation systems, I had never experienced this positive effect. This means that I have preconceived positive notions about public transportation without any real experience to back it up. This project will be a perfect opportunity to prove or disprove this notion, but I have to be careful not to implement any confirmation bias in my findings. Like traffic metrics, there are plenty of metrics out there to measure public transit ridership, whether it be over time, per capita, etc. In this paper I will explain whether or not public transportation truly is beneficial for traffic flow, as well as determine other potential factors for explaining traffic congestion.</p>
</section>
<section id="methods" class="level3">
<h3 class="anchored" data-anchor-id="methods">4. Methods</h3>
<p>After selecting my topic, in a few days’ time, I immediately encountered a significant obstacle: where I was going to get the data from. Turns out, there is no one source that includes every variable I need, so I would have to create multiple data sets and merge them. One source, INRIX, contained many traffic metrics by city. The ones I chose were hours lost due to traffic congestion per person per year (or just hours lost due to traffic for short), change in traffic due to COVID, and last-mile speed (average speed in mph within 1 mile from the city center). INRIX is a software company that gives reliable information on countless traffic metrics not only throughout the US, but around the world. It even looks at factors like traffic light data, parking data, and weather; the extent of information in this source is truly astounding. Unfortunately, the page has been updated since I retrieved the data (also, the change due to COVID column was removed), so if this study were to be replicated, it would require a different data set. Therefore, it is important to note that the data was retrieved on 9/5/22. By the way, each observation will be marked as a city-state combo, since there are cities in different states with the same name (example: Columbus, GA and Columbus, OH). Also, I intended to look at traffic metrics by state, since INRIX only includes relatively large cities in their data set, rendering a two-level analysis impractical (especially since some states would have no cities). This means that I would actually be using 2 separate data sets, one for cities and the other for states. The main state-level data would come from the Bureau of Transportation Statistics (BTS), an officially government-licensed database that includes metrics on highway fatalities, public transport ridership, total gas usage and miles driven, number of registered licenses, and number of total vehicles. These data sets are just two of the many data sets I used in my project; much explanation will be provided to show the validity of each section of my full data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'mosaic':
  method                           from   
  fortify.SpatialPolygonsDataFrame ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
The 'mosaic' package masks several functions from core packages in order to add 
additional features.  The original behavior of these functions should not be affected by this.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'mosaic'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    count, do, tally</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Matrix':

    mean</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    stat</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,
    quantile, sd, t.test, var</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    max, mean, min, prod, range, sample, sum</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'skimr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:mosaic':

    n_missing</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)  </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'tidyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:Matrix':

    expand, pack, unpack</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'data.table'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    between, first, last</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages
───────────────────────────────────────
tidyverse 1.3.2 ──</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ tibble  3.1.8     ✔ purrr   0.3.4
✔ readr   2.1.2     ✔ forcats 0.5.2
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ data.table::between() masks dplyr::between()
✖ gridExtra::combine()  masks dplyr::combine()
✖ mosaic::count()       masks dplyr::count()
✖ purrr::cross()        masks mosaic::cross()
✖ mosaic::do()          masks dplyr::do()
✖ tidyr::expand()       masks Matrix::expand()
✖ dplyr::filter()       masks stats::filter()
✖ data.table::first()   masks dplyr::first()
✖ dplyr::lag()          masks stats::lag()
✖ data.table::last()    masks dplyr::last()
✖ tidyr::pack()         masks Matrix::pack()
✖ mosaic::stat()        masks ggplot2::stat()
✖ mosaic::tally()       masks dplyr::tally()
✖ purrr::transpose()    masks data.table::transpose()
✖ tidyr::unpack()       masks Matrix::unpack()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(expss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: maditr

To get total summary skip 'by' argument: take_all(mtcars, mean)


Attaching package: 'maditr'

The following object is masked from 'package:purrr':

    transpose

The following object is masked from 'package:readr':

    cols

The following objects are masked from 'package:data.table':

    copy, dcast, melt

The following object is masked from 'package:skimr':

    to_long

The following objects are masked from 'package:dplyr':

    between, coalesce, first, last


Attaching package: 'expss'

The following objects are masked from 'package:purrr':

    keep, modify, modify_if, when

The following objects are masked from 'package:data.table':

    copy, like

The following objects are masked from 'package:stringr':

    fixed, regex

The following objects are masked from 'package:tidyr':

    contains, nest

The following object is masked from 'package:skimr':

    contains

The following object is masked from 'package:mosaic':

    prop

The following objects are masked from 'package:dplyr':

    compute, contains, na_if, recode, vars

The following object is masked from 'package:ggplot2':

    vars</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: nlme

Attaching package: 'nlme'

The following object is masked from 'package:dplyr':

    collapse

This is mgcv 1.8-40. For overview type 'help("mgcv-package")'.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'

The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.92 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'corrr'

The following object is masked from 'package:skimr':

    focus</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"~/R Studio Stuff"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>demographics <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"us-cities-demographics.csv"</span>, <span class="at">sep=</span><span class="st">";"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>censusTract <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"500_Cities__Census_Tract-level_Data__GIS_Friendly_Format___2017_release.csv"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>inrix <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"INRIX Data.csv"</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"CityPop.csv"</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>uptCity <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"UPT City Data.csv"</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>incomeCity <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"kaggle_income.csv"</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>timeCity <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"table_01_70_092021.csv"</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>uscities <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"uscities.csv"</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>highwayState <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"table_data.csv"</span>, <span class="at">locale=</span><span class="fu">locale</span>(<span class="at">encoding=</span><span class="st">"UTF-16"</span>), <span class="at">delim=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 3613 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: "\t"
chr (2): State, Measures
dbl (2): Year, Values

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>demogState <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"StateDemog.csv"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>demogState2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"stateDemog2.csv"</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>houseState <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"DECENNIALPL2020.csv"</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>gqState <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"groupQuartersByState.csv"</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>popState <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"NST-EST2021-POP.csv"</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>speedState <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"State Speed Limits.csv"</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>alcState <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"csvData.csv"</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>incomeState <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"income.csv"</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>areaState <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Untitled spreadsheet - Sheet1.csv"</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>densityState <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"state_demographics.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">subset</span>(pop, <span class="at">select=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pop)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"City"</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pop)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"AprilEst"</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pop)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"JulyEst"</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pop)[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">"Est2021"</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>pop[<span class="dv">59</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Honolulu, Hawaii"</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> pop[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">808</span><span class="sc">:</span><span class="dv">812</span>),]</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">separate</span>(pop, <span class="st">"City"</span>, <span class="fu">c</span>(<span class="st">"City"</span>, <span class="st">"State"</span>), <span class="at">sep=</span><span class="st">", "</span>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">804</span>){</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(pop<span class="sc">$</span>State[x]<span class="sc">==</span><span class="st">"District of Columbia"</span>){</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    pop<span class="sc">$</span>stateAbb[x] <span class="ot">&lt;-</span> <span class="st">"DC"</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    pop<span class="sc">$</span>stateAbb[x] <span class="ot">&lt;-</span> state.abb[<span class="fu">grep</span>(pop[x, <span class="dv">2</span>], state.name)]</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in pop$stateAbb[x] &lt;- state.abb[grep(pop[x, 2], state.name)]: number of
items to replace is not a multiple of replacement length

Warning in pop$stateAbb[x] &lt;- state.abb[grep(pop[x, 2], state.name)]: number of
items to replace is not a multiple of replacement length

Warning in pop$stateAbb[x] &lt;- state.abb[grep(pop[x, 2], state.name)]: number of
items to replace is not a multiple of replacement length

Warning in pop$stateAbb[x] &lt;- state.abb[grep(pop[x, 2], state.name)]: number of
items to replace is not a multiple of replacement length

Warning in pop$stateAbb[x] &lt;- state.abb[grep(pop[x, 2], state.name)]: number of
items to replace is not a multiple of replacement length

Warning in pop$stateAbb[x] &lt;- state.abb[grep(pop[x, 2], state.name)]: number of
items to replace is not a multiple of replacement length

Warning in pop$stateAbb[x] &lt;- state.abb[grep(pop[x, 2], state.name)]: number of
items to replace is not a multiple of replacement length

Warning in pop$stateAbb[x] &lt;- state.abb[grep(pop[x, 2], state.name)]: number of
items to replace is not a multiple of replacement length

Warning in pop$stateAbb[x] &lt;- state.abb[grep(pop[x, 2], state.name)]: number of
items to replace is not a multiple of replacement length

Warning in pop$stateAbb[x] &lt;- state.abb[grep(pop[x, 2], state.name)]: number of
items to replace is not a multiple of replacement length

Warning in pop$stateAbb[x] &lt;- state.abb[grep(pop[x, 2], state.name)]: number of
items to replace is not a multiple of replacement length

Warning in pop$stateAbb[x] &lt;- state.abb[grep(pop[x, 2], state.name)]: number of
items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>pop<span class="sc">$</span>City <span class="ot">&lt;-</span> <span class="fu">paste</span>(pop<span class="sc">$</span>City, pop<span class="sc">$</span>stateAbb, <span class="at">sep=</span><span class="st">" "</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(uscities)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"City"</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>uscities<span class="sc">$</span>City <span class="ot">&lt;-</span> <span class="fu">paste</span>(uscities<span class="sc">$</span>City, uscities<span class="sc">$</span>state_id, <span class="at">sep=</span><span class="st">" "</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>uscities <span class="ot">&lt;-</span> uscities[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">11</span><span class="sc">:</span><span class="dv">17</span>)]</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>citydata <span class="ot">&lt;-</span> <span class="fu">merge</span>(pop, uscities, <span class="at">by=</span><span class="st">"City"</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>inrix[<span class="dv">162</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"New York NY"</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(inrix)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"City"</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>citydata <span class="ot">&lt;-</span> <span class="fu">merge</span>(citydata,inrix,<span class="at">by=</span><span class="st">"City"</span>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>citydata <span class="ot">&lt;-</span> <span class="fu">separate</span>(citydata, <span class="st">"impactRank2020"</span>, <span class="fu">c</span>(<span class="st">"impactRank2020"</span>, <span class="st">"delete"</span>), <span class="at">sep=</span><span class="st">" "</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>citydata <span class="ot">&lt;-</span> <span class="fu">subset</span>(citydata, <span class="at">select=</span><span class="sc">-</span><span class="dv">9</span>)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>citydata <span class="ot">&lt;-</span> <span class="fu">separate</span>(citydata, <span class="st">"hrsLostInCongestion2020"</span>, <span class="fu">c</span>(<span class="st">"hrsLost2020"</span>, <span class="st">"delete"</span>), <span class="at">sep=</span><span class="st">" "</span>)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>citydata <span class="ot">&lt;-</span> <span class="fu">subset</span>(citydata, <span class="at">select=</span><span class="sc">-</span><span class="dv">10</span>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>preCovidChange <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"%"</span>, <span class="st">""</span>, citydata<span class="sc">$</span>preCovidChange)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>preCovidChange <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"−"</span>, <span class="st">"-"</span>, citydata<span class="sc">$</span>preCovidChange)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>preCovidChange <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(citydata<span class="sc">$</span>preCovidChange)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: NAs introduced by coercion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>AprilEst <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, citydata<span class="sc">$</span>AprilEst)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>JulyEst <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, citydata<span class="sc">$</span>JulyEst)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>Est2021 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, citydata<span class="sc">$</span>Est2021)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>demographics<span class="sc">$</span>longname <span class="ot">&lt;-</span> <span class="fu">nchar</span>(demographics<span class="sc">$</span>City)<span class="sc">&gt;</span><span class="dv">20</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>demographics[<span class="fu">c</span>(<span class="dv">160</span>,<span class="dv">253</span>,<span class="dv">815</span>,<span class="dv">1436</span>,<span class="dv">2565</span>), <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"Athens"</span>, <span class="dv">5</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>demographics[<span class="fu">c</span>(<span class="dv">56</span>,<span class="dv">387</span>,<span class="dv">774</span>,<span class="dv">1754</span>,<span class="dv">2104</span>), <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"Augusta"</span>, <span class="dv">5</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>demographics[<span class="fu">c</span>(<span class="dv">1217</span>,<span class="dv">1688</span>,<span class="dv">2083</span>,<span class="dv">2170</span>,<span class="dv">2320</span>), <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"Lexington"</span>, <span class="dv">5</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>demographics[<span class="fu">c</span>(<span class="dv">973</span>,<span class="dv">1347</span>,<span class="dv">1433</span>,<span class="dv">1684</span>,<span class="dv">2851</span>), <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"Louisville"</span>, <span class="dv">5</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>demographics<span class="sc">$</span>City <span class="ot">&lt;-</span> <span class="fu">paste</span>(demographics<span class="sc">$</span>City, demographics<span class="sc">$</span>State.Code, <span class="at">sep=</span><span class="st">" "</span>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>demographics<span class="sc">$</span>AmInd <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(demographics<span class="sc">$</span>Race<span class="sc">==</span><span class="st">"American Indian and Alaska Native"</span>,demographics<span class="sc">$</span>Count,<span class="dv">0</span>)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>demographics<span class="sc">$</span>Asian <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(demographics<span class="sc">$</span>Race<span class="sc">==</span><span class="st">"Asian"</span>,demographics<span class="sc">$</span>Count,<span class="dv">0</span>)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>demographics<span class="sc">$</span>Black <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(demographics<span class="sc">$</span>Race<span class="sc">==</span><span class="st">"Black or African-American"</span>,demographics<span class="sc">$</span>Count,<span class="dv">0</span>)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>demographics<span class="sc">$</span>Hispanic <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(demographics<span class="sc">$</span>Race<span class="sc">==</span><span class="st">"Hispanic or Latino"</span>,demographics<span class="sc">$</span>Count,<span class="dv">0</span>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>demographics<span class="sc">$</span>White <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(demographics<span class="sc">$</span>Race<span class="sc">==</span><span class="st">"White"</span>,demographics<span class="sc">$</span>Count,<span class="dv">0</span>)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>demCondensed <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(<span class="fu">cbind</span>(AmInd, Asian, Black, Hispanic, White) <span class="sc">~</span> City, <span class="at">data=</span>demographics, <span class="at">FUN=</span>sum)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>demographics <span class="ot">&lt;-</span> <span class="fu">subset</span>(demographics, <span class="at">select=</span><span class="sc">-</span><span class="fu">c</span>(<span class="dv">11</span><span class="sc">:</span><span class="dv">18</span>))</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>demographics <span class="ot">&lt;-</span> demographics[<span class="sc">!</span><span class="fu">duplicated</span>(demographics), ]</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>demCondensed <span class="ot">&lt;-</span> <span class="fu">merge</span>(demographics,demCondensed,<span class="at">by=</span><span class="st">"City"</span>)</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>demCondensed <span class="ot">&lt;-</span> <span class="fu">subset</span>(demCondensed, <span class="at">select=</span><span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">10</span>))</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>citydata <span class="ot">&lt;-</span> <span class="fu">merge</span>(citydata,demCondensed,<span class="at">by=</span><span class="st">"City"</span>)</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>censusTract<span class="sc">$</span>City <span class="ot">&lt;-</span> <span class="fu">paste</span>(censusTract<span class="sc">$</span>PlaceName, censusTract<span class="sc">$</span>StateAbbr, <span class="at">sep=</span><span class="st">" "</span>)</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>censusTract <span class="ot">&lt;-</span> <span class="fu">subset</span>(censusTract, <span class="at">select=</span><span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">22</span>,<span class="dv">24</span>,<span class="dv">26</span>,<span class="dv">28</span>,<span class="dv">30</span>,<span class="dv">32</span>,<span class="dv">34</span>,<span class="dv">36</span>,<span class="dv">38</span>,<span class="dv">40</span>,<span class="dv">42</span>,<span class="dv">44</span>,<span class="dv">46</span>,<span class="dv">48</span>,<span class="dv">50</span>,<span class="dv">52</span>,<span class="dv">54</span>,<span class="dv">56</span>,<span class="dv">58</span>,<span class="dv">60</span>,<span class="dv">62</span><span class="sc">:</span><span class="dv">63</span>))</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>keys <span class="ot">&lt;-</span> <span class="fu">colnames</span>(censusTract)[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">'value'</span>,<span class="fu">colnames</span>(censusTract))]</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>keys <span class="ot">&lt;-</span> keys[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>censusTract <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(<span class="fu">cbind</span>(ACCESS2_CrudePrev,ARTHRITIS_CrudePrev,BINGE_CrudePrev,BPHIGH_CrudePrev,BPMED_CrudePrev,CANCER_CrudePrev,CASTHMA_CrudePrev,CHD_CrudePrev,CHECKUP_CrudePrev,CHOLSCREEN_CrudePrev,COLON_SCREEN_CrudePrev,COPD_CrudePrev,COREM_CrudePrev,COREW_CrudePrev,CSMOKING_CrudePrev,DENTAL_CrudePrev,DIABETES_CrudePrev,HIGHCHOL_CrudePrev,KIDNEY_CrudePrev,LPA_CrudePrev,MAMMOUSE_CrudePrev,MHLTH_CrudePrev,OBESITY_CrudePrev,PAPTEST_CrudePrev,PHLTH_CrudePrev,SLEEP_CrudePrev,STROKE_CrudePrev,TEETHLOST_CrudePrev) <span class="sc">~</span> City, <span class="at">data=</span>censusTract, <span class="at">FUN=</span><span class="st">"mean"</span>)</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>citydata <span class="ot">&lt;-</span> <span class="fu">merge</span>(citydata,censusTract,<span class="at">by=</span><span class="st">"City"</span>)</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>AprilEst <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, citydata<span class="sc">$</span>AprilEst)</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>JulyEst <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, citydata<span class="sc">$</span>JulyEst)</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>Est2021 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, citydata<span class="sc">$</span>Est2021)</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>citydata[<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">8</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">11</span>)] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(citydata[<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">8</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">11</span>)], <span class="at">FUN =</span> <span class="cf">function</span>(y){<span class="fu">as.numeric</span>(y)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in FUN(X[[i]], ...): NAs introduced by coercion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>uptCity <span class="ot">&lt;-</span> <span class="fu">subset</span>(uptCity, <span class="at">select=</span><span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">8</span><span class="sc">:</span><span class="dv">9</span>))</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>uptCond <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(<span class="fu">cbind</span>(X2002,X2003,X2004,X2005,X2006,X2007,X2008,X2009,X2010,X2011,X2012,X2013,X2014,X2015,X2016,X2017,X2018,X2019,X2020,X2021,X2022) <span class="sc">~</span> UZA.Name, <span class="at">data=</span>uptCity, <span class="at">FUN=</span>sum)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>uptCond <span class="ot">&lt;-</span> <span class="fu">rename</span>(uptCond, <span class="st">"City"</span><span class="ot">=</span><span class="st">"UZA.Name"</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>citydata <span class="ot">&lt;-</span> <span class="fu">merge</span>(citydata,uptCond,<span class="at">by=</span><span class="st">"City"</span>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>popChange <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>(citydata<span class="sc">$</span>Est2021<span class="sc">-</span>citydata<span class="sc">$</span>JulyEst)<span class="sc">/</span>citydata<span class="sc">$</span>JulyEst</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>incomeCity<span class="sc">$</span>City <span class="ot">&lt;-</span> <span class="fu">paste</span>(incomeCity<span class="sc">$</span>City, incomeCity<span class="sc">$</span>State_ab, <span class="at">sep=</span><span class="st">" "</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>incomeCity <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(<span class="fu">cbind</span>(Mean, Median, Stdev) <span class="sc">~</span> City, <span class="at">data=</span>incomeCity, <span class="at">FUN=</span><span class="st">"mean"</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>citydata <span class="ot">&lt;-</span> <span class="fu">merge</span>(citydata,incomeCity,<span class="at">by=</span><span class="st">"City"</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>timeCity<span class="sc">$</span>Urban.area <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, timeCity<span class="sc">$</span>Urban.area)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>timeCity <span class="ot">&lt;-</span> <span class="fu">rename</span>(timeCity, <span class="st">"City"</span><span class="ot">=</span><span class="st">"Urban.area"</span>)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>citydata <span class="ot">&lt;-</span> <span class="fu">merge</span>(citydata,timeCity,<span class="at">by=</span><span class="st">"City"</span>)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>citylong1 <span class="ot">&lt;-</span> <span class="fu">gather</span>(citydata, year, ridership, <span class="fu">c</span>(X2002<span class="sc">:</span>X2020), <span class="at">factor_key=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>citylong1<span class="sc">$</span>ID <span class="ot">&lt;-</span> <span class="fu">paste</span>(citylong1<span class="sc">$</span>City, citylong1<span class="sc">$</span>year, <span class="at">sep=</span><span class="st">" "</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>citylong2 <span class="ot">&lt;-</span> <span class="fu">gather</span>(citydata, year, peakRatio, <span class="fu">c</span>(tr02<span class="sc">:</span>tr20), <span class="at">factor_key=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>citylong2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(citylong2, <span class="at">select=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">78</span><span class="sc">:</span><span class="dv">79</span>))</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>citylong2<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"tr"</span>, <span class="st">"X20"</span>, citylong2<span class="sc">$</span>year)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>citylong2<span class="sc">$</span>ID <span class="ot">&lt;-</span> <span class="fu">paste</span>(citylong2<span class="sc">$</span>City, citylong2<span class="sc">$</span>year, <span class="at">sep=</span><span class="st">" "</span>)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>citylong <span class="ot">&lt;-</span> <span class="fu">merge</span>(citylong1, citylong2, <span class="at">by=</span><span class="st">"ID"</span>)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>citylong <span class="ot">&lt;-</span> <span class="fu">rename</span>(citylong, <span class="st">"City"</span><span class="ot">=</span><span class="st">"City.x"</span>)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>citylong <span class="ot">&lt;-</span> <span class="fu">rename</span>(citylong, <span class="st">"year02"</span><span class="ot">=</span><span class="st">"year.x"</span>)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>citylong<span class="sc">$</span>year02 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"X"</span>, <span class="st">""</span>, citylong<span class="sc">$</span>year02)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>citylong<span class="sc">$</span>year02 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(citylong<span class="sc">$</span>year02)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>citylong<span class="sc">$</span>year02 <span class="ot">&lt;-</span> citylong<span class="sc">$</span>year02<span class="dv">-2002</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>citylong<span class="sc">$</span>ridership <span class="ot">&lt;-</span> <span class="fu">replace</span>(citylong<span class="sc">$</span>ridership, citylong<span class="sc">$</span>ridership<span class="sc">==</span><span class="dv">0</span>, <span class="cn">NA</span>)</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>citylong <span class="ot">&lt;-</span> <span class="fu">subset</span>(citylong, <span class="at">select=</span><span class="sc">-</span><span class="fu">c</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">54</span>, <span class="dv">60</span><span class="sc">:</span><span class="dv">78</span>, <span class="dv">81</span><span class="sc">:</span><span class="dv">82</span>))</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>highwayStateWide <span class="ot">&lt;-</span> highwayState <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Measures, <span class="at">values_from =</span> Values)</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>highwayStateWide <span class="ot">&lt;-</span> <span class="fu">subset</span>(highwayStateWide, <span class="at">select=</span><span class="sc">-</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="dv">11</span>))</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>highwayState2020 <span class="ot">&lt;-</span> <span class="fu">subset</span>(highwayState, Year<span class="sc">==</span><span class="dv">2020</span>)</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>highwayState2020<span class="sc">$</span>Transit <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(highwayState2020<span class="sc">$</span>Measures<span class="sc">==</span><span class="st">"Transit Ridership"</span>,highwayState2020<span class="sc">$</span>Values,<span class="dv">0</span>)</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>highwayState2020<span class="sc">$</span>Fatalities <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(highwayState2020<span class="sc">$</span>Measures<span class="sc">==</span><span class="st">"Highway Fatalities"</span>,highwayState2020<span class="sc">$</span>Values,<span class="dv">0</span>)</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>highwayState2020<span class="sc">$</span>Gas <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(highwayState2020<span class="sc">$</span>Measures<span class="sc">==</span><span class="st">"Highway use of gasoline (thousand gallons)"</span>,highwayState2020<span class="sc">$</span>Values,<span class="dv">0</span>)</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>highwayState2020<span class="sc">$</span>Miles <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(highwayState2020<span class="sc">$</span>Measures<span class="sc">==</span><span class="st">"Highway vehicle-miles traveled (millions)"</span>,highwayState2020<span class="sc">$</span>Values,<span class="dv">0</span>)</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>highwayState2020<span class="sc">$</span>Vehicles <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(highwayState2020<span class="sc">$</span>Measures<span class="sc">==</span><span class="st">"Vehicles"</span>,highwayState2020<span class="sc">$</span>Values,<span class="dv">0</span>)</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>highwayState2020<span class="sc">$</span>Licenses <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(highwayState2020<span class="sc">$</span>Measures<span class="sc">==</span><span class="st">"Licensed drivers"</span>,highwayState2020<span class="sc">$</span>Values,<span class="dv">0</span>)</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>highwayCondensed <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(<span class="fu">cbind</span>(Transit, Fatalities, Gas, Miles, Vehicles, Licenses) <span class="sc">~</span> State, <span class="at">data=</span>highwayState2020, <span class="at">FUN=</span>sum)</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>highwayCondensed <span class="ot">&lt;-</span> highwayCondensed[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">40</span>,<span class="dv">46</span>),]</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>houseState <span class="ot">&lt;-</span> houseState[<span class="sc">-</span><span class="dv">40</span>,]</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>houseState<span class="sc">$</span>State <span class="ot">&lt;-</span> houseState<span class="sc">$</span>Label..Grouping.</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>statedata <span class="ot">&lt;-</span> <span class="fu">merge</span>(highwayCondensed,houseState,<span class="at">by=</span><span class="st">"State"</span>)</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>statedata <span class="ot">&lt;-</span> <span class="fu">subset</span>(statedata, <span class="at">select=</span><span class="sc">-</span><span class="dv">8</span>)</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>Total. <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, statedata<span class="sc">$</span>Total.)</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>Total...Occupied <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, statedata<span class="sc">$</span>Total...Occupied)</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>Total...Vacant <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, statedata<span class="sc">$</span>Total...Vacant)</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>statedata[<span class="fu">c</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>)] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(statedata[<span class="fu">c</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>)], <span class="at">FUN =</span> <span class="cf">function</span>(y){<span class="fu">as.numeric</span>(y)})</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>gqState <span class="ot">&lt;-</span> <span class="fu">rename</span>(gqState, <span class="st">"State"</span><span class="ot">=</span>Label)</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>statedata <span class="ot">&lt;-</span> <span class="fu">merge</span>(statedata,gqState,<span class="at">by=</span><span class="st">"State"</span>)</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>statedata <span class="ot">&lt;-</span> <span class="fu">merge</span>(statedata,popState,<span class="at">by=</span><span class="st">"State"</span>)</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>statedata <span class="ot">&lt;-</span> <span class="fu">rename</span>(statedata, <span class="st">"houses"</span><span class="ot">=</span><span class="st">"Total."</span>)</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>statedata <span class="ot">&lt;-</span> <span class="fu">merge</span>(statedata,speedState,<span class="at">by=</span><span class="st">"State"</span>)</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>demogState <span class="ot">&lt;-</span> <span class="fu">subset</span>(demogState, <span class="at">select=</span><span class="sc">-</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>demogState <span class="ot">&lt;-</span> <span class="fu">rename</span>(demogState, <span class="st">"State"</span><span class="ot">=</span>X)</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>statedata <span class="ot">&lt;-</span> <span class="fu">merge</span>(statedata,demogState,<span class="at">by=</span><span class="st">"State"</span>)</span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>demogState2 <span class="ot">&lt;-</span> demogState2[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">16</span>)]</span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>demogState2 <span class="ot">&lt;-</span> <span class="fu">rename</span>(demogState2, <span class="st">"State"</span><span class="ot">=</span>X)</span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>statedata <span class="ot">&lt;-</span> <span class="fu">merge</span>(statedata,demogState2,<span class="at">by=</span><span class="st">"State"</span>)</span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>statedata <span class="ot">&lt;-</span> <span class="fu">merge</span>(statedata,areaState,<span class="at">by=</span><span class="st">"State"</span>)</span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>statedata <span class="ot">&lt;-</span> <span class="fu">merge</span>(statedata,densityState,<span class="at">by=</span><span class="st">"State"</span>)</span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a>NE.name <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Connecticut"</span>, <span class="st">"Maine"</span>, <span class="st">"Massachusetts"</span>, <span class="st">"New Hampshire"</span>, <span class="st">"Rhode Island"</span>, <span class="st">"Vermont"</span>, <span class="st">"New Jersey"</span>, <span class="st">"New York"</span>, <span class="st">"Pennsylvania"</span>)</span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a>MW.name <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Indiana"</span>, <span class="st">"Illinois"</span>, <span class="st">"Michigan"</span>, <span class="st">"Ohio"</span>, <span class="st">"Wisconsin"</span>, <span class="st">"Iowa"</span>, <span class="st">"Kansas"</span>, <span class="st">"Minnesota"</span>, <span class="st">"Missouri"</span>, <span class="st">"Nebraska"</span>, <span class="st">"North Dakota"</span>, <span class="st">"South Dakota"</span>)</span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a>S.name <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Delaware"</span>, <span class="st">"District of Columbia"</span>, <span class="st">"Florida"</span>, <span class="st">"Georgia"</span>, <span class="st">"Maryland"</span>, <span class="st">"North Carolina"</span>, <span class="st">"South Carolina"</span>, <span class="st">"Virginia"</span>, <span class="st">"West Virginia"</span>, <span class="st">"Alabama"</span>, <span class="st">"Kentucky"</span>, <span class="st">"Mississippi"</span>, <span class="st">"Tennessee"</span>, <span class="st">"Arkansas"</span>, <span class="st">"Louisiana"</span>, <span class="st">"Oklahoma"</span>, <span class="st">"Texas"</span>)</span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a>W.name <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Arizona"</span>, <span class="st">"Colorado"</span>, <span class="st">"Idaho"</span>, <span class="st">"New Mexico"</span>, <span class="st">"Montana"</span>, <span class="st">"Utah"</span>, <span class="st">"Nevada"</span>, <span class="st">"Wyoming"</span>, <span class="st">"Alaska"</span>, <span class="st">"California"</span>, <span class="st">"Hawaii"</span>, <span class="st">"Oregon"</span>, <span class="st">"Washington"</span>)</span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a>region.list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">Northeast=</span>NE.name,</span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">Midwest=</span>MW.name,</span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">South=</span>S.name,</span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">West=</span>W.name)</span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="fu">sapply</span>(statedata<span class="sc">$</span>State, </span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">function</span>(x) <span class="fu">names</span>(region.list)[<span class="fu">grep</span>(x,region.list)])</span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="fu">sapply</span>(citydata<span class="sc">$</span>State, </span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">function</span>(x) <span class="fu">names</span>(region.list)[<span class="fu">grep</span>(x,region.list)])</span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a>citylong<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="fu">sapply</span>(citylong<span class="sc">$</span>State, </span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">function</span>(x) <span class="fu">names</span>(region.list)[<span class="fu">grep</span>(x,region.list)])</span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a>statedata <span class="ot">&lt;-</span> <span class="fu">merge</span>(statedata,alcState,<span class="at">by=</span><span class="st">"State"</span>)</span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a>incomeState <span class="ot">&lt;-</span> <span class="fu">rename</span>(incomeState, <span class="st">"State"</span><span class="ot">=</span><span class="st">"Name"</span>)</span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a>incomeState <span class="ot">&lt;-</span> <span class="fu">subset</span>(incomeState, <span class="at">select=</span><span class="sc">-</span><span class="dv">4</span>)</span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a>statedata <span class="ot">&lt;-</span> <span class="fu">merge</span>(statedata,incomeState,<span class="at">by=</span><span class="st">"State"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Most of the city and state-level demographic data comes from the US Census Bureau’s 2021 American Community Survey. This data includes the basic demographic factors (age, race, gender), but in regards to traffic data, it would be valuable to create variables that measure the proportion of people between the ages of 25 and 64, which is what I would consider the prime driving age range. Drivers younger than 25 generally have worse judgment; younger drivers are generally less experienced and “are more likely than older drivers to perform risky driving behaviors such as speeding, close following, and smaller gap acceptance,” (Williams 2006). In contrast, elderly drivers, defined as older than 65, among other factors, tend to have deteriorated motor skills, health problems, and are more likely to experience side effects of medications (Lyon et al., 2020). Therefore, it would make sense that states with higher proportions of people in their “prime driving age” would generally have better driving judgment and fewer fatalities per capita, assuming all other factors are kept constant.</p>
<p>The city data set also includes health-related variables, which come from the CDC and are measured not by city but by census tract. I decided to take the average of each census tract for each city for each variable, and after some quick cleaning, I was able to merge this data set into the full data set. This data set includes 28 different health-related variables, so fully explaining the data set would take forever. The main variables I ended up using were crude prevalence of binge drinking, getting less than 8 hours of sleep per day, high blood pressure, chronic obstructive pulmonary disease, and older people being up to date on their core medical procedures, as well as a few others. I thought this set of variables would be important because health-related factors would almost certainly have something to do with change in traffic due to COVID, as those with pre-existing conditions during the COVID outbreak would be less likely to travel.</p>
<p>As discussed earlier, population density (people per square mile) will be an integral part of this project, so finding a reputable source is paramount. I decided to use the data from the simplemaps website, which cites government-backed sources such as the previously mentioned US Census Bureau and American Community Survey. I was hoping to get much more out of this source, but simplemaps actually has “basic,” “pro,” and “comprehensive” versions of the database, and I had no intentions on paying money just to view extra variables, so I had to stick with the “basic” version. The only relevant variable I could find was density, which was exactly what I was looking for, but the sheer depth of the database could be useful for a potentially larger project. For example, the comprehensive version of the database has data on education, which would no doubt be useful for this project. However, I had to settle for just using population density.</p>
<p>Another one of my preconceived ideas heading into this project was the general importance of setting a reasonable speed limit when planning traffic flow. Hence, state speed limits for urban and rural areas also had to be considered when creating the full state data set. The source I used was the Insurance Institute for Highway Safety (IIHS), a non-profit organization renowned for its scientific use of crash testing and general knowledge about highway safety. This is also perfect for the data set used in my project since the main metric of traffic congestion for the state data set looks at highway fatalities; it is generally a good idea for multiple variables to look at the same area.</p>
<p>Median income can also have some effect on traffic congestion; it would be reasonable to hypothesize that poorer areas generally have less resources to focus on road construction and thus can have higher frequencies of car accidents. The same is true for income growth, but it is less clear what direction the correlation would be. Growth in income can either help with or worsen traffic congestion depending on how willing the state transportation authorities are to invest in beneficial traffic modifications. Both of these variables come from the Federal Reserve Economic Data, a database, owned by the Federal Reserve Bank of St.&nbsp;Louis, that has been measuring various economic factors over time since 1991. Since the data set for my project is a snapshot in time, I only want to look at median income in 2021 and income growth from the preceding period (2020); this growth can also indicate recovery from COVID.</p>
<p>Like the city data set, the state data set also includes a variable relating to alcohol. However, instead of looking at prevalence of binge drinkers, this variable measures the per capita alcohol consumption for each state. As publisher of the data set John Elflein explains, “although New Hampshire consumes the highest amount of alcohol per capita, it reports lower rates of binge drinking than other states,” (Elflein 2022). This highlights the difference between alcohol consumption and binge drinking, which can potentially tell us that alcohol consumption per capita will most likely explain less about highway fatality rate than binge drinking for traffic congestion. Furthermore, Elflein states, “health risks associated with binge drinking include … unintentional injury such as from car crashes,” (Elflein 2022), further solidifying the importance of looking at alcohol consumption in a traffic data project.</p>
<p>Finally, I decided to add group quarters statistics to the data set, since more people living in group quarters tends to indicate a higher population density, in which the average person has to travel fewer miles and uses less high-speed roadways, reducing the chance of highway fatalities. According to the US Census Bureau, this variable can be broken down into two categories: institutionalized, which includes correctional facilities, mental hospitals, and nursing facilities; and non-institutionalized, which includes college dorms and military quarters. Due to the variety of institutionalized group quarters, simply using institutionalized group quarters (or proportion) as a variable does very little to explain anything of value. Instead, we will look at the following variables (measured on a per-100000-people basis): people living in adult correctional facilities, people living in nursing facilities, people living in college dorms, and people living in military quarters. Each of these variables has its own explanation as to why it could potentially be useful.</p>
<p>Theoretically, having a higher proportion of people in prison can indicate one of two things: either more transportation-related crimes are being committed, or law enforcement is stricter. If more crimes are being committed, then this could indicate that the state in question has a higher prevalence of reckless driving. However, if law enforcement is stricter, this could indicate that police officers are more likely to give speeding tickets, which can deter people from driving unreasonably fast and potentially reducing car crashes. Next, people who live in college dorms are generally less likely to travel since most of their required resources are in walking distance. However, it is important to note that college students are in an age range (about 18-22 for 4-year colleges) prone to poor judgment decisions in driving, so there are arguments for both positive and negative correlations between the proportion of people living in college dorms and highway fatality rate.</p>
<p>Finally, the proportion of people who live in military quarters can also reasonably go either way in terms of correlation to highway fatality rate. On one hand, people who live in military quarters are generally less free to travel, as, like college students, most of their resources do not require private transportation. Furthermore, states with more people in military quarters may also have more retired veterans, who may be disabled and may require public transportation, which is hypothesized to be good for reducing highway fatalities. On the other hand, a study conducted by University of Wyoming psychology professor Joshua D. Clapp shows that male veterans with PTSD are more likely to exhibit erratic driving behavior: “Veterans with a diagnosis of PTSD reported performance deficits, exaggerated safety/caution, and hostile/aggressive driving behavior at a greater frequency than student motorists sampled for the development of the [Driving Behavior Survey],” (Clapp et al.&nbsp;2019). Even so, there are drawbacks to this study, as, for example, it only looks at male veterans with PTSD in contrast to the veteran population as a whole. Therefore, it is fair to hypothesize that states with a higher proportion of people in military quarters are likely to have fewer fatalities per capita, if all other variables are kept constant.</p>
<p>In any professional statistics project, exploratory data analysis (EDA) is one of the most important steps. EDA is used to determine what variables may be important to use in a potential statistical model, but it is important to note that not every variable deemed important by EDA will eventually end up in the final model. This is because EDA mainly looks at correlations between variables, which can be misleading since an explanatory variable with a strong correlation to the response variable may not add much to the final model, usually since it explains variation that has already been explained by other variables. So, while EDA is a vital step in developing a statistical model, it does have some drawbacks that may cause contradictions between EDA and the final result. The plan for this project is to generate 4 total models, with each of these response variables: city-level hours lost due to traffic per person per year, city-level change in traffic due to COVID, city-level last-mile speed, and state-level highway fatality rate.</p>
<p>First, for the city-level EDA, I looked at histograms of each response variable to determine potential skewness, and I found that all 3 variables were right-skewed. This might suggest that a log-transformation in the response variable, or a type of model that works logarithmically, would be a good idea. Next, I transformed some of the variables into proportions to account for population, since looking at raw numbers would most likely show the same result as simply looking at population. One of the variables in particular measures the crude prevalence of not having access to health insurance, which is more confusing to interpret than simply having access to health insurance, so I converted this rate statistic into its proportional inverse to create a more understandable variable. Next, I decided to construct a correlation matrix, which shows the correlations between every numerical variable in the data set. Finding the variables with the strongest correlations (highest absolute values in the table) with each of the traffic metrics can give us a good idea of what variables may be important to use in each of the final models. It is also important to have some sort of explanation behind each of these strong correlations rather than simply chalking it up to pure variation in data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(citydata<span class="sc">$</span>hrsLost2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/City%20EDA%20Setup-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(citydata<span class="sc">$</span>preCovidChange)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/City%20EDA%20Setup-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(citydata<span class="sc">$</span>preCovidChange, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="dv">100</span>), <span class="at">breaks=</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/City%20EDA%20Setup-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(citydata<span class="sc">$</span>lastMile)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/City%20EDA%20Setup-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#All 3 traffic metrics are skewed to the right.</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding a few rate variables:</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>pctmale <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>citydata<span class="sc">$</span>Male.Population<span class="sc">/</span>citydata<span class="sc">$</span>Est2021</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>vetpct <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>citydata<span class="sc">$</span>Number.of.Veterans<span class="sc">/</span>citydata<span class="sc">$</span>Est2021</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>forpct <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>citydata<span class="sc">$</span>Foreign.born<span class="sc">/</span>citydata<span class="sc">$</span>Est2021</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>whitepct <span class="ot">&lt;-</span> citydata<span class="sc">$</span>White<span class="sc">/</span>citydata<span class="sc">$</span>Est2021</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>blackpct <span class="ot">&lt;-</span> citydata<span class="sc">$</span>Black<span class="sc">/</span>citydata<span class="sc">$</span>Est2021</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>hispanicpct <span class="ot">&lt;-</span> citydata<span class="sc">$</span>Hispanic<span class="sc">/</span>citydata<span class="sc">$</span>Est2021</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>asianpct <span class="ot">&lt;-</span> citydata<span class="sc">$</span>Asian<span class="sc">/</span>citydata<span class="sc">$</span>Est2021</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>amindpct <span class="ot">&lt;-</span> citydata<span class="sc">$</span>AmInd<span class="sc">/</span>citydata<span class="sc">$</span>Est2021</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>insurance_prev <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">-</span>citydata<span class="sc">$</span>ACCESS2_CrudePrev</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>citydata<span class="sc">$</span>riderrate <span class="ot">&lt;-</span> citydata<span class="sc">$</span>X2021<span class="sc">/</span>citydata<span class="sc">$</span>Est2021</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>citydataKeys <span class="ot">&lt;-</span> citydata[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">13</span><span class="sc">:</span><span class="dv">17</span>, <span class="dv">19</span><span class="sc">:</span><span class="dv">24</span>, <span class="dv">52</span><span class="sc">:</span><span class="dv">72</span>, <span class="dv">77</span><span class="sc">:</span><span class="dv">96</span>)]</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>check <span class="ot">&lt;-</span> <span class="fu">complete.cases</span>(citydataKeys)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>citykeys2 <span class="ot">&lt;-</span> citydataKeys[check,]</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>citykeyscorr <span class="ot">&lt;-</span> <span class="fu">correlate</span>(citydataKeys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Non-numeric variables removed from input: `region`
Correlation computed with
• Method: 'pearson'
• Missing treated using: 'pairwise.complete.obs'</code></pre>
</div>
</div>
<p>The explanatory variables with the strongest correlations with hours lost due to traffic (starting with the strongest) are population density, public transport ridership per capita, population, and population change from 2020 to 2021 (negative). Density and population make the most sense as to why they are correlated with traffic congestion, since denser/more populated areas naturally tend to have more traffic congestion. However, the negative correlation between population change and hours lost seems to suggest that either rapidly-growing cities have less traffic congestion (which makes no intuitive sense), or, the more likely conclusion, people are moving away from cities with high traffic congestion. The most important correlation to discuss, however, is public transport ridership’s positive correlation with hours lost. This is a prime example of correlation not meaning causation, as it would be foolish to conclude that public transportation actually hurts traffic simply by looking at a correlation matrix. The reason this correlation exists is because denser cities, which naturally have high traffic congestion, are more likely to seek investment in public transportation as a means to fix the problem. Therefore, public transportation is not a cause, but a result of high traffic congestion.</p>
<p>The explanatory variables with the strongest correlations (in terms of correlation coefficient) with change in traffic due to COVID are crude prevalence of various health factors (all negative), crude prevalence of having health insurance (negative), and average household size (people per household), but none of these correlations are particularly strong, as none of them go past 0.5 in absolute value. The health factors in question are cholesterol screening, pap smear use, and getting colonoscopy-related tests (for ages 50-75). The negative correlations between the health factors and change in traffic due to COVID seems to suggest that cities with stricter lockdown policies (and thus a stronger decrease in traffic during COVID) also have a higher proportion of people with preexisting conditions, thus increasing the motive for enforcing the lockdown policies in the first place. As for average household size, it would make sense to assume that cities with larger households tend to be more family-oriented. Observational studies have shown that “one-person households…are more prevalent in central cities than suburbia and…married-couple households…tend to reside in suburbia instead of central cities,” (Jung and Yang 2016). The result of more traditional families living in the suburbs is a greater reliance on transportation, which cannot completely be halted by the impact of COVID due to the fact that using transportation is a necessity for these families. This is why larger families’ rate of transportation has not fallen off due to COVID, explaining (to the best of my ability) why cities with more people per household have not seen as severe of a decrease in traffic due to COVID. Since none of the correlations are particularly strong, it is more reasonable to suggest that this is a result of random variation in data, as explaining some of the correlations yields theories that make little intuitive sense. This might suggest that, of the four total models, the one that uses change in traffic due to COVID as the response variable might be the weakest in proving any sort of point.</p>
<p>The explanatory variables with the strongest correlations with last-mile speed are population density and public transport ridership per capita (both negative); no other variable comes close. Intuitively, it makes sense that densely-populated cities have slower last-mile speeds, so the population density correlation makes the most sense. As for public transport ridership per capita, the same reasoning from the hours lost correlation will be used in the last-mile correlation: public transportation is not a cause, but a result of high traffic congestion. While this response variable has only two reasonably important explanatory variables, both of these variables are important for what this project will uncover; they also appear in the hours lost model, suggesting that they have some sort of serious importance in this project.</p>
<p>The next step of EDA is to compare explanatory and response variables using tables, boxplots, scatterplots, or other means. This is different from simply looking at a correlation matrix for two reasons: first, looking at graphs can help one detect potentially non-linear relationships (suggesting that the variable needs to be transformed), and second, graphs can be split into groups of points, potentially showing different correlations for different groups. The “groups” in this case will be regions of the US, split into Northeast, Midwest, South, and West. If there is a significant difference in correlation in a graph between two (or more) regions, this indicates that an interaction term in the final model may be useful, if the non-interaction component is also significant enough to appear in the model. Explaining every graph I constructed would take forever, so only the graphs that serve some importance to the main idea will be explained.</p>
<p>First, I looked at the boxplots between region and each response variable, just to get an idea of which regions have good or bad traffic congestion metrics. According to hours lost and last-mile speed, Northeastern cities have the worst traffic, and there is no clear region with a greater change in traffic due to COVID.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(hrsLost2020 <span class="sc">~</span> region, <span class="at">data=</span>citydata, <span class="at">horizontal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/City%20Data%20Initial%20Boxplots-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(preCovidChange <span class="sc">~</span> region, <span class="at">data=</span>citydata, <span class="at">horizontal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/City%20Data%20Initial%20Boxplots-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers are making the differences hard to see.</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(preCovidChange <span class="sc">~</span> region, <span class="at">data=</span>citydata, <span class="at">horizontal =</span> T, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/City%20Data%20Initial%20Boxplots-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(lastMile <span class="sc">~</span> region, <span class="at">data=</span>citydata, <span class="at">horizontal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/City%20Data%20Initial%20Boxplots-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on what the correlation matrix tells us, Northeastern cities having poor traffic congestion metrics may indicate that cities in this region are densely-populated (since density appears to come up regularly). As expected, Northeastern cities do indeed have the highest population density, but the density graph brings up another interesting issue: while Southern cities clearly have lower population densities than other regions, their traffic congestion metrics are still not as good as would be expected from low-city-density regions. Clearly, this is something that needs to be investigated further, but for now, I will continue to look at other variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(density <span class="sc">~</span> region, <span class="at">data=</span>citydata, <span class="at">horizontal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/City%20Data%20Density%20Boxplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Continuing with the variables with high raw correlation coefficients, the graphs between population change and hours lost due to traffic confirm that, even when dividing by region, population change is universally negatively correlated with hours lost. However, no region in particular has a significantly different distribution of population change, which makes things more confusing when considering that Midwestern and Northeastern cities have noticeably steeper slopes in the aforementioned graph. The steeper slopes suggest the presence of an interaction term in the optimal model, but the lack of difference in population change between regions suggests otherwise. I am willing to argue that the steeper slopes are a product of random variance, since the last-mile graph (which usually serves as the inverse to the hours lost graph) does not show any difference in slopes between regions. Therefore, I would not consider population change as one of the most important variables in the project.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(citydata, <span class="fu">aes</span>(<span class="at">y=</span>hrsLost2020, <span class="at">x=</span>popChange, <span class="at">col=</span>region))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/Population%20Change%20Graphs-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(citydata, <span class="fu">aes</span>(<span class="at">y=</span>lastMile, <span class="at">x=</span>popChange))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing non-finite values (stat_smooth).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/Population%20Change%20Graphs-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Average household size has one of the strongest correlations with change in traffic due to COVID, so looking at a region-split graph between the two variables might be important. However, the graph shows that the correlation is very likely skewed by a few outliers, so a log-transformation is required to make the graph more interpretable. Since change in traffic due to COVID is in percent, it can be negative, with a theoretical minimum of -100, so I added 100 to the variable before using a log-transformation since it is impossible to take the log of a negative number (or 0, but no relatively large city can realistically have a change of -100%). The resulting graph with the log transformation is more legible; the correlations are easier to see and therefore explain. While Northeastern and Southern cities have positive correlations between household size and change in traffic due to COVID, this correlation is negative for Midwestern cities; this might suggest that an interaction term may be present in the model. Northeastern and Southern cities, in terms of density and public transportation, are generally designed in polar opposite fashions, so it is definitely interesting to see an area where both of these regions experience the same effect. However, it is entirely possible that this could simply be more random variation, since none of the correlations by region are particularly strong. Furthermore, the positive correlation for Southern states only exists due to one point that skews the data (Brownsville, TX), so making any kind of conclusion would be a relatively futile effort. This further reinforces the weaknesses of the potential change in traffic due to COVID model, and it raises a significant point: do we even need this response variable to get our point across? If not, what is this variable’s purpose?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(citydata, <span class="fu">aes</span>(<span class="at">y=</span>preCovidChange, <span class="at">x=</span>Average.Household.Size, <span class="at">col=</span>region))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite values (stat_smooth).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/Average%20Household%20Graphs-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(citydata, <span class="fu">aes</span>(<span class="at">y=</span><span class="fu">log</span>(preCovidChange<span class="sc">+</span><span class="dv">100</span>), <span class="at">x=</span>Average.Household.Size, <span class="at">col=</span>region))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite values (stat_smooth).
Removed 2 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/Average%20Household%20Graphs-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>One thing I have neglected to mention until now about this data set is the two time-based variables, both courtesy of the National Transit Database (NTD). One of them measures total public transport ridership (this required a lot of data cleaning) from 2002 to 2022, and the other measures traffic scores (1 is the lowest, lower is better) from 1990 to 2020. Adding these two variables technically allows us to convert the data set into a long data set, in which each observation is a city-year combination instead of just the city. The years in the long data set will only span from 2002 to 2020, since this is where the two time-based variables overlap. First, I looked at public transport ridership over time to get a picture of how each city’s public transportation system has grown/shrunk. I noticed that public transport usage has not changed much prior to COVID, in which the lockdown caused public transportation ridership to plummet nationwide. However, the graph showing traffic score over time shows that the traffic scores (starting in 2002) slowly increased for the first 5 years, then plateaued for the next decade, then sharply increased in recent years. The only thing that halted this sharp increase was, of course, the aforementioned COVID lockdown. Perhaps the lockdown saved us from having to face a potential traffic crisis in the 2020s; the late 2010s certainly gave bad signs of traffic congestion in the future.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>theme<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">hjust=</span>.<span class="dv">9</span>,<span class="at">face=</span><span class="st">"italic"</span>,<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(citylong, <span class="fu">aes</span>(<span class="at">x =</span> year02, <span class="at">y =</span> <span class="fu">log</span>(ridership))) <span class="sc">+</span> </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> City), <span class="at">color =</span> <span class="st">"dark grey"</span>) <span class="sc">+</span> </span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  theme<span class="fl">.1</span> <span class="sc">+</span> </span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Years since 2002"</span>, <span class="at">y =</span> <span class="st">"Log Ridership"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 37 rows containing non-finite values (stat_smooth).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 28 row(s) containing missing values (geom_path).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/Time%20Data-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#I used log ridership since ridership is skewed to the right.</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Public transport is becoming less prevalent, especially with COVID</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(citylong, <span class="fu">aes</span>(<span class="at">x =</span> year02, <span class="at">y =</span> peakRatio)) <span class="sc">+</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> City), <span class="at">color =</span> <span class="st">"dark grey"</span>) <span class="sc">+</span> </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  theme<span class="fl">.1</span> <span class="sc">+</span> </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Years since 2002"</span>, <span class="at">y =</span> <span class="st">"Traffic Ratio"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/Time%20Data-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The only thing that halted the rise of traffic congestion was COVID; traffic was really bad in the late 2010s.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The last thing I did with these two time-based variables was compare each respective city’s public transportation growth to its traffic score growth and see if any correlations can be made. What I found was that, after removing outliers, growth in public transportation ridership was negatively correlated with growth in traffic congestion; this is a potential sign that public transportation is beneficial for traffic over time. Furthermore, comparing cities that saw a decrease in public transport ridership to those that saw an increase, the boxplot shows that cities whose public transport decreased have greater traffic score coefficients than those whose public transport increased; this further reinforces the idea that investment in public transportation has a legitimate effect on reducing traffic congestion. Since all of the other variables show a snapshot in 2021, however, the lack of 2021 data for traffic score means that the two-level model cannot be utilized any further; doing so would require me to use outdated traffic score data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>theme<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">hjust=</span>.<span class="dv">9</span>,<span class="at">face=</span><span class="st">"italic"</span>,<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(citylong, <span class="fu">aes</span>(<span class="at">x =</span> year02, <span class="at">y =</span> <span class="fu">log</span>(ridership))) <span class="sc">+</span> </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> City), <span class="at">color =</span> <span class="st">"dark grey"</span>) <span class="sc">+</span> </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  theme<span class="fl">.1</span> <span class="sc">+</span> </span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Years since 2002"</span>, <span class="at">y =</span> <span class="st">"Log Ridership"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 37 rows containing non-finite values (stat_smooth).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 28 row(s) containing missing values (geom_path).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/Time%20Data%202-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#I used log ridership since ridership is skewed to the right.</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Public transport is becoming less prevalent, especially with COVID</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(citylong, <span class="fu">aes</span>(<span class="at">x =</span> year02, <span class="at">y =</span> peakRatio)) <span class="sc">+</span> </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> City), <span class="at">color =</span> <span class="st">"dark grey"</span>) <span class="sc">+</span> </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  theme<span class="fl">.1</span> <span class="sc">+</span> </span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Years since 2002"</span>, <span class="at">y =</span> <span class="st">"Traffic Ratio"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/Time%20Data%202-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The only thing that halted the rise of traffic congestion was COVID; traffic was really bad in the late 2010s.</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>rates <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">76</span>, <span class="at">ncol =</span> <span class="dv">0</span>))</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>rates<span class="sc">$</span>riderRate <span class="ot">&lt;-</span> <span class="fu">by</span>(citylong, citylong<span class="sc">$</span>City, <span class="cf">function</span>(data)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">coefficients</span>(<span class="fu">lm</span>(ridership <span class="sc">~</span> year02, <span class="at">data =</span> data))[[<span class="dv">2</span>]])</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>rates<span class="sc">$</span>trafficRate <span class="ot">&lt;-</span> <span class="fu">by</span>(citylong, citylong<span class="sc">$</span>City, <span class="cf">function</span>(data)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">coefficients</span>(<span class="fu">lm</span>(peakRatio <span class="sc">~</span> year02, <span class="at">data =</span> data))[[<span class="dv">2</span>]])</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>rates<span class="sc">$</span>riderNegative <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(rates<span class="sc">$</span>riderRate<span class="sc">&lt;=</span><span class="dv">0</span>, <span class="st">"-"</span>, <span class="st">"+"</span>)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers:</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rates, <span class="fu">aes</span>(<span class="at">y=</span>trafficRate, <span class="at">x=</span>riderRate))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Don't know how to automatically pick scale for object of type by. Defaulting to continuous.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Don't know how to automatically pick scale for object of type by. Defaulting to continuous.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing non-finite values (stat_smooth).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/Time%20Data%202-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#No outliers:</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rates, <span class="fu">aes</span>(<span class="at">y=</span>trafficRate, <span class="at">x=</span>riderRate))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">1000000</span>,<span class="dv">1000000</span>)<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Don't know how to automatically pick scale for object of type by. Defaulting to continuous.
`geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing non-finite values (stat_smooth).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/Time%20Data%202-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(trafficRate <span class="sc">~</span> riderNegative, <span class="at">data =</span> rates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/Time%20Data%202-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">#After removing outliers, we find that cities whose public transportation ridership increased over time have almost exclusively had their peak freeflow ratio decrease over time. While RAW public transportation ridership is positively correlated with PREVALENCE of traffic congestion, GROWTH in public transportation is correlated with DECLINE in traffic.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The last thing I did for the city data set EDA was create a test model comparing public transport ridership frequency to population density. Using a test model in this case is a more sophisticated yet interpretable way to show that two variables are related than simply looking at a scatterplot. Starting with a simple boxplot, we see that Northeastern cities have a higher frequency of public transport ridership per person. Immediately, this seems to relate to population density, as Northeastern cities are also more densely-populated than in other regions. To test this theory, I created a small linear model with public transport ridership per person as the response and population density as the explanatory variable. The key to this test is the residuals; if Northeastern cities have higher (more positive) residuals, this indicates that population density does not do enough to explain variation in public transport ridership per person. After a few coding steps, we find that the rank from highest to lowest in the residuals is much different from the rank shown in the boxplot. This shows that population density is enough to explain most of the variation in public transport ridership per person, further reinforcing my hypothesis that densely populated areas are more likely to benefit from public transportation than sprawled-out areas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">log</span>(riderrate) <span class="sc">~</span> region, <span class="at">data=</span>citydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/City%20Test%20Models-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>model.a <span class="ot">&lt;-</span> <span class="fu">lm</span>(riderrate<span class="sc">~</span>density, citydata)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">resid</span>(model.a)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">region=</span>citydata<span class="sc">$</span>region,</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>res,</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="fu">fitted</span>(model.a))</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>mean <span class="ot">&lt;-</span> df<span class="sc">%&gt;%</span> <span class="fu">group_by</span>(region)<span class="sc">%&gt;%</span><span class="fu">summarise</span>(<span class="at">mean_val=</span><span class="fu">mean</span>(y))</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x=</span> x, <span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> region)) <span class="sc">+</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_hline</span>(<span class="at">data=</span> mean, <span class="fu">aes</span>(<span class="at">yintercept =</span> mean_val,<span class="at">col=</span>region))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/City%20Test%20Models-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Despite the discrepancies in public transport ridership rates among regions of the US, after adjusting for density, these discrepancies are either neutralized or very slightly reversed. This tells us that a city's density does a good job of explaining why some cities have more public transport and others may have less.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that the EDA for city data is complete, I will explain my EDA for state data. The metric I chose to use to use for states is highway fatality rate (highway fatalities per 100000 people). This is more fair than city-based metrics like hours lost and last-mile speed since it puts every state, regardless of how many or few major cities they have, on an even playing field. After converting most of my raw variables into rate statistics, as well as adding income growth and population growth, I created another correlation matrix, this one using the variables from the state data set. The variables with the strongest correlations with highway fatality rate are highway vehicle miles per 100 people, gas usage (in gallons) per 100 people, median income (negative), proportion of people in adult correctional facilities, and public transit units per person (negative). Interestingly, population density has little to no correlation with highway fatality rate, which makes sense because highway fatality rate already makes up for population (and population density) by putting every state on a level playing field so denser/less dense states do not have skewed statistics. This is important because we finally get to see the impact of public transportation outside of the context of population density; viewing potentially important variables in different contexts is vital to giving a detailed statistical report.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>adjTransit <span class="ot">&lt;-</span> statedata<span class="sc">$</span>Transit<span class="sc">/</span>statedata<span class="sc">$</span>popApr2020</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="co">#This measures the number of public transit units per person in 2020.</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>fatalityRate <span class="ot">&lt;-</span> <span class="dv">100000</span><span class="sc">*</span>statedata<span class="sc">$</span>Fatalities<span class="sc">/</span>statedata<span class="sc">$</span>popApr2020</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co">#This measures the number of fatalities per 100000 people.</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(statedata<span class="sc">$</span>fatalityRate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/State%20EDA-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Fatality rate is skewed to the right, which means that most states have relatively low fatality rates.</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>adjGas <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>statedata<span class="sc">$</span>Gas<span class="sc">/</span>statedata<span class="sc">$</span>popApr2020</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="co">#This measures the number of gallons of gas used per 100000 people in 2020.</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>adjMiles <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>statedata<span class="sc">$</span>Miles<span class="sc">/</span>statedata<span class="sc">$</span>popApr2020</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co">#This measures the number of highway vehicle miles per 100000 people in 2020.</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>licpct <span class="ot">&lt;-</span> statedata<span class="sc">$</span>Licenses<span class="sc">/</span>statedata<span class="sc">$</span>popApr2020</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="co">#This measures the percentage of people with a driver's license.</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>vehPerPerson <span class="ot">&lt;-</span> statedata<span class="sc">$</span>Vehicles<span class="sc">/</span>statedata<span class="sc">$</span>popApr2020</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="co">#This measures the average number of vehicles per person.</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>prisonpct <span class="ot">&lt;-</span> <span class="dv">100000</span><span class="sc">*</span>statedata<span class="sc">$</span>correcAdult<span class="sc">/</span>statedata<span class="sc">$</span>popApr2020</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="co">#This measures the number of people living in adult correctional facilities per 100000 people.</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>gqpct <span class="ot">&lt;-</span> <span class="dv">100000</span><span class="sc">*</span>statedata<span class="sc">$</span>totGroupQuarters<span class="sc">/</span>statedata<span class="sc">$</span>popApr2020</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="co">#This measures the number of people living in group quarters per 100000 people.</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>juvpct <span class="ot">&lt;-</span> <span class="dv">100000</span><span class="sc">*</span>statedata<span class="sc">$</span>juvFacil<span class="sc">/</span>statedata<span class="sc">$</span>popApr2020</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="co">#This measures the number of people living in juvenile correctional facilities per 100000 people.</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>collegepct <span class="ot">&lt;-</span> <span class="dv">100000</span><span class="sc">*</span>statedata<span class="sc">$</span>collegeHousing<span class="sc">/</span>statedata<span class="sc">$</span>popApr2020</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a><span class="co">#This measures the number of people living on college campus per 100000 people.</span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>mqpct <span class="ot">&lt;-</span> <span class="dv">100000</span><span class="sc">*</span>statedata<span class="sc">$</span>militaryQuarters<span class="sc">/</span>statedata<span class="sc">$</span>popApr2020</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a><span class="co">#This measures the number of people living in military quarters per 100000 people.</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>whitepct <span class="ot">&lt;-</span> statedata<span class="sc">$</span>White<span class="sc">/</span>statedata<span class="sc">$</span>Total.population</span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a><span class="co">#This measures the percentage of white people in each state.</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>blackpct <span class="ot">&lt;-</span> statedata<span class="sc">$</span>Black<span class="sc">/</span>statedata<span class="sc">$</span>Total.population</span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>asianpct <span class="ot">&lt;-</span> statedata<span class="sc">$</span>Asian<span class="sc">/</span>statedata<span class="sc">$</span>Total.population</span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>amindpct <span class="ot">&lt;-</span> statedata<span class="sc">$</span>AmInd<span class="sc">/</span>statedata<span class="sc">$</span>Total.population</span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>hisppct <span class="ot">&lt;-</span> statedata<span class="sc">$</span>Hispanic<span class="sc">/</span>statedata<span class="sc">$</span>Total.population</span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>primepct <span class="ot">&lt;-</span> statedata<span class="sc">$</span>PrimeAge<span class="sc">/</span>statedata<span class="sc">$</span>Total.population</span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>seniorpct <span class="ot">&lt;-</span> statedata<span class="sc">$</span>Senior<span class="sc">/</span>statedata<span class="sc">$</span>Total.population</span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>incomeGrowth <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>(statedata<span class="sc">$</span>X2021<span class="sc">-</span>statedata<span class="sc">$</span>Preceding.Period)<span class="sc">/</span>statedata<span class="sc">$</span>Preceding.Period</span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a><span class="co">#This measures the percent income growth from 2020 to 2021 for each state.</span></span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a>statedata<span class="sc">$</span>popGrowth <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>(statedata<span class="sc">$</span>popJuly2021<span class="sc">-</span>statedata<span class="sc">$</span>popApr2020)<span class="sc">/</span>statedata<span class="sc">$</span>popApr2020</span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>statedataKeys <span class="ot">&lt;-</span> statedata[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">23</span>, <span class="dv">26</span><span class="sc">:</span><span class="dv">27</span>, <span class="dv">29</span><span class="sc">:</span><span class="dv">31</span>, <span class="dv">33</span><span class="sc">:</span><span class="dv">37</span>, <span class="dv">43</span>)]</span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a>check2 <span class="ot">&lt;-</span> <span class="fu">complete.cases</span>(statedataKeys)</span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a>statekeys2 <span class="ot">&lt;-</span> statedataKeys[check2,]</span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a>statekeyscorr <span class="ot">&lt;-</span> <span class="fu">correlate</span>(statedataKeys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Non-numeric variables removed from input: `region`
Correlation computed with
• Method: 'pearson'
• Missing treated using: 'pairwise.complete.obs'</code></pre>
</div>
</div>
<p>First, looking at highway fatality rate by region paints a concerning picture: Southern states clearly have the highest highway fatality rates of all regions. This alone should raise some concerns as to how Southern roads or cities are constructed, especially since Southern states also have more miles driven per 100 people and gallons of gas used per 100 people than most other regions. This indicates that Southerners are incentivized, if not required, to drive longer distances to get to their destination, which, conveniently enough, corresponds to the graph from the city data set that shows that Southern cities are the least densely populated. Furthermore, Southern states generally have a lower median income than in other regions, which is important because median income is strongly negatively correlated with highway fatality rate. Adding still to the list of problems with Southern states, they also have the highest proportion of people in adult correctional facilities, and, as stated earlier, this is a variable that is strongly positively correlated with highway fatality rate. This raises another important question: Are these problems all related to each other? If so, what does it mean for the US, or, more specifically, the South?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(fatalityRate <span class="sc">~</span> region, <span class="at">data=</span>statedata, <span class="at">horizontal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/State%20Boxplots-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(adjGas <span class="sc">~</span> region, <span class="at">data=</span>statedata, <span class="at">horizontal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/State%20Boxplots-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(adjMiles <span class="sc">~</span> region, <span class="at">data=</span>statedata, <span class="at">horizontal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/State%20Boxplots-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(X2021 <span class="sc">~</span> region, <span class="at">data=</span>statedata, <span class="at">horizontal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/State%20Boxplots-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#X2021 = median income</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(prisonpct <span class="sc">~</span> region, <span class="at">data=</span>statedata, <span class="at">horizontal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/State%20Boxplots-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Further analysis shows that median income is negatively correlated with proportion of people in prison, which shows that two of the aforementioned problems may be related to each other. This correlation is backed up by intensive research on the US incarceration crisis; “poverty and excessive legal punishments contribute significantly to the United States’ high rate of imprisonment, which has disproportionately affected low-income and minority populations,” (Hayes and Barnhorst 2020). Since this research also notes that minority populations are being incarcerated at a disproportionately high rate, it might make sense to add race-based variables to the analysis. However, the correlation matrix shows that the proportion of white people (by state) has little to no correlation with median income, prison population proportion, or highway fatality rate. Obviously, this does not mean that race has absolutely nothing to do with any of these problems; measuring these variables on an individual level, rather than state-level, may yield more informative results. Even so, we have proven that median income is heavily related to proportion of people in prison, not just via our data, but also through prior advanced research.</p>
<p>When looking at correlations between population density and our other variables, we find that both prison population proportion and median income have a non-linear relationship with population density. For prison population proportion, this correlation is negative, and for median income, this correlation is positive. Furthermore, both graphs show that Southern and Western states follow the main correlation the strongest, which might suggest that median income acts as an inverse to prison population proportion. This reinforces the idea that median income is heavily negatively correlated with prison population proportion, so using only one of these variables in our analysis would suffice. I would use median income instead of prison population proportion, because a) using incarceration statistics that have little correlation to race-based data contradicts prior research that proves otherwise, and b) studies show that median income has a reasonable relationship with population density. A study from 1999 from the Journal of Energy and Development found that there is “a significant positive correlation between median household income and population density for 1980…and 1990,” (Vandegrift and DiCaro, 1999), and that “for U.S. states, high incomes are associated with high population densities and people migrate toward states with high incomes. Another more recent study from Slippery Rock University shows that this can be due to more employment opportunities in densely populated areas: the relationship between density and employment is positive indicating that an increase in population or housing density increases employment in a metropolitan area,” (Hummel 2020). Therefore, prison population, median income, population density, and fatality rate all have significant and reasonable connections to each other, according to our state-based data and the studies of prior researchers.</p>
<p>The state-level data set also has a variable that measures frequency of public transport ridership per capita, which has been proven (in the city data set) to be valuable in explaining variance in traffic congestion. Moving from city-based traffic data to highway-based data will most likely add information to this study, as population density is no longer the largest factor in measuring highway fatality rate. The basic boxplots show that Southern and Midwestern states have lower frequencies of public transport ridership per capita, while Northeastern and Western states have higher frequencies; this is something that has already been proven.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(adjTransit <span class="sc">~</span> region, <span class="at">data=</span>statedata, <span class="at">horizontal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/State%20Boxplots%202-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As expected, there is a negative correlation between public transport ridership per capita and highway fatality rate, which intuitively makes sense because states (or metropolitan areas) that use more public transit are less likely to use highways and more likely to focus their transportation efforts on cities, as cities are more densely populated than highways and can benefit more from public transit. Just like in the city-level data set, I created a small test model to determine if public transport ridership per capita is the main factor behind highway fatality rate.</p>
<div class="cell">
<pre class="state cell-code"><code>model.b &lt;- lm(fatalityRate~adjTransit, statedata)
res &lt;- resid(model.b)
df &lt;- data.frame(
    region=statedata$region,
    y=res,
    x=fitted(model.b))
mean &lt;- df%&gt;% group_by(region)%&gt;%summarise(mean_val=mean(y))
ggplot(data = df, aes(x= x, y=y)) +
geom_point(aes(colour = region)) +
geom_hline(data= mean, aes(yintercept = mean_val,col=region))
#Southern states still have a disproportionately high fatality rate even after accounting for public transport ridership per capita. This means that there are other important variables to measure.</code></pre>
</div>
<p>However, the result this time was different: Southern states still had a disproportionately high highway fatality rate even after accounting for public transport ridership per capita, which indicates that public transit may not be the main determining factor behind Southern states’ highway fatality problem.</p>
<p>One of my biggest ideas going into this project was that speed limits are one of the most important factors determining highway fatality rates. This stems from conventional wisdom that “speed kills;” driving faster reduces one’s margin of error, meaning that one slip-up when driving at a high speed can have more devastating results than at lower speeds. I decided to test this theory by introducing urban (and to a lesser extent rural) highway speed limit to my EDA. The reason I focused more on urban speed limits is because urban highways are more densely-packed, providing a potential “breeding ground” for highway fatalities in comparison to the less dense rural highways. Since the speed limits (courtesy of IIHS) are in increments of 5, they can essentially be treated as categorical variables for now, so I used a table instead of a boxplot to compare speed limit to region.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cross_cases</span>(statedata, region, ruralLimit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;"></th>
<th colspan="5" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">&nbsp;ruralLimit&nbsp;</th>
</tr>
<tr><th style="border-bottom: 1px solid grey; font-weight: 900; text-align: center;"></th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">&nbsp;60&nbsp;</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">&nbsp;65&nbsp;</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">&nbsp;70&nbsp;</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">&nbsp;75&nbsp;</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">&nbsp;80&nbsp;</th>
</tr>
</thead>
<tbody> 
<tr><td colspan="6" style="font-weight: 900;">&nbsp;region&nbsp;</td></tr>
<tr>
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Midwest&nbsp;</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Northeast&nbsp;</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
</tr>
<tr>
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;South&nbsp;</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;"></td>
</tr>
<tr>
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;West&nbsp;</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">&nbsp;&nbsp;&nbsp;#Total cases&nbsp;</td>
<td style="border-bottom: 2px solid grey; text-align: right;">1</td>
<td style="border-bottom: 2px solid grey; text-align: right;">11</td>
<td style="border-bottom: 2px solid grey; text-align: right;">21</td>
<td style="border-bottom: 2px solid grey; text-align: right;">14</td>
<td style="border-bottom: 2px solid grey; text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cross_cases</span>(statedata, region, urbanLimit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;"></th>
<th colspan="6" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">&nbsp;urbanLimit&nbsp;</th>
</tr>
<tr><th style="border-bottom: 1px solid grey; font-weight: 900; text-align: center;"></th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">&nbsp;55&nbsp;</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">&nbsp;60&nbsp;</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">&nbsp;65&nbsp;</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">&nbsp;70&nbsp;</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">&nbsp;75&nbsp;</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">&nbsp;80&nbsp;</th>
</tr>
</thead>
<tbody> 
<tr><td colspan="7" style="font-weight: 900;">&nbsp;region&nbsp;</td></tr>
<tr>
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Midwest&nbsp;</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Northeast&nbsp;</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
</tr>
<tr>
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;South&nbsp;</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
</tr>
<tr>
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;West&nbsp;</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">&nbsp;&nbsp;&nbsp;#Total cases&nbsp;</td>
<td style="border-bottom: 2px solid grey; text-align: right;">11</td>
<td style="border-bottom: 2px solid grey; text-align: right;">3</td>
<td style="border-bottom: 2px solid grey; text-align: right;">15</td>
<td style="border-bottom: 2px solid grey; text-align: right;">13</td>
<td style="border-bottom: 2px solid grey; text-align: right;">7</td>
<td style="border-bottom: 2px solid grey; text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(fatalityRate <span class="sc">~</span> <span class="fu">as.factor</span>(ruralLimit), <span class="at">data=</span>statedata, <span class="at">horizontal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/Speed%20Limit-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(fatalityRate <span class="sc">~</span> <span class="fu">as.factor</span>(urbanLimit), <span class="at">data=</span>statedata, <span class="at">horizontal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/Speed%20Limit-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The tables show that Northeastern states have the lowest urban speed limits of each region, but they also show something interesting: over half of all Southern states (9 of 16) have an urban highway speed limit of 70 mph. Next, I looked at the boxplots for each speed limit compared to highway fatality rate, and I found that fatality rate appears to increase as speed limit increases. This immediately reinforced my suspicions that speed limit had something to do with highway fatalities, and I started to come up with what I believed to be an easy solution: simply reduce the speed limit in areas with high fatality rates (more specifically, go from 70 to 65 mph in certain Southern states). To confirm once and for all if my suspicions were correct, I ran a test model to see if urban highway speed limit is the most important determining factor for highway fatality rate.</p>
<p>First, the fact that Northeastern states have the lowest speed limits makes it reasonable to suggest that higher speed limits appear in low-population-density areas; this makes intuitive sense because people in less densely-populated areas can drive much faster due to the relative lack of cars on the highways.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(density <span class="sc">~</span> urbanLimit, <span class="at">data=</span>statedata, <span class="at">horizontal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/Speed%20Limit%202-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(density <span class="sc">~</span> ruralLimit, <span class="at">data=</span>statedata, <span class="at">horizontal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/Speed%20Limit%202-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The boxplots back up this notion, as states with an urban highway speed limit of 55 mph (lowest in the data set) are by far the most densely populated. So, since population density has some sort of effect on highway speed limit, a few extra test models will have to be executed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>model.c <span class="ot">&lt;-</span> <span class="fu">lm</span>(fatalityRate<span class="sc">~</span>density, statedata)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">resid</span>(model.c)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">region=</span>statedata<span class="sc">$</span>region,</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>res,</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="fu">fitted</span>(model.c))</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>mean <span class="ot">&lt;-</span> df<span class="sc">%&gt;%</span> <span class="fu">group_by</span>(region)<span class="sc">%&gt;%</span><span class="fu">summarise</span>(<span class="at">mean_val=</span><span class="fu">mean</span>(y))</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x=</span> x, <span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> region)) <span class="sc">+</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_hline</span>(<span class="at">data=</span> mean, <span class="fu">aes</span>(<span class="at">yintercept =</span> mean_val,<span class="at">col=</span>region))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/State%20Test%20Models-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Southern states have a disproportionately high fatality rate compared to their population density; this might suggest that density is not the only factor that explains variation in fatality rate.</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>model.d <span class="ot">&lt;-</span> <span class="fu">lm</span>(urbanLimit<span class="sc">~</span>density, statedata)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">resid</span>(model.d)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">region=</span>statedata<span class="sc">$</span>region,</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>res,</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="fu">fitted</span>(model.d))</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>mean <span class="ot">&lt;-</span> df<span class="sc">%&gt;%</span> <span class="fu">group_by</span>(region)<span class="sc">%&gt;%</span><span class="fu">summarise</span>(<span class="at">mean_val=</span><span class="fu">mean</span>(y))</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x=</span> x, <span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> region)) <span class="sc">+</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_hline</span>(<span class="at">data=</span> mean, <span class="fu">aes</span>(<span class="at">yintercept =</span> mean_val,<span class="at">col=</span>region))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/State%20Test%20Models-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Southern states have disproportionately high speed limits compared to their population density.</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>model.e <span class="ot">&lt;-</span> <span class="fu">lm</span>(fatalityRate<span class="sc">~</span>urbanLimit<span class="sc">+</span>density, statedata)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">resid</span>(model.e)</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">region=</span>statedata<span class="sc">$</span>region,</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>res,</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="fu">fitted</span>(model.e))</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>mean <span class="ot">&lt;-</span> df<span class="sc">%&gt;%</span> <span class="fu">group_by</span>(region)<span class="sc">%&gt;%</span><span class="fu">summarise</span>(<span class="at">mean_val=</span><span class="fu">mean</span>(y))</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x=</span> x, <span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> region)) <span class="sc">+</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_hline</span>(<span class="at">data=</span> mean, <span class="fu">aes</span>(<span class="at">yintercept =</span> mean_val,<span class="at">col=</span>region))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics-Capstone-Project_files/figure-html/State%20Test%20Models-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">#However, the fatality rates are still disproportionately high even after accounting for speed limit, which might indicate that speed limit is not the ultimate factor that explains why Southern states have high fatality rates.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first test model (explanatory = density, response = fatality rate) shows that Southern states still have disproportionately high fatality rates even after accounting for density, proving that density is not the sole factor in explaining variation in highway fatality rate. The second model (explanatory = density, response = speed limit) shows that Southern states also have disproportionately high speed limits in comparison to their population density; perhaps this could be the biggest factor behind Southern states’ highway fatality problem. This is tested in the final model, where population density and urban highway speed limit are the explanatory variables, and highway fatality rate is the response variable. The result: Southern states’ highway fatality rates are still disproportionately high, even after accounting for both population density and speed limit, which indicates that perhaps highway speed limit is not as important as I presumed. Further research echoes these results; a study conducted by Lahore University of Management Sciences in conjunction with Texas A &amp; M University concluded that “factors such as safety regulations, drunk driving, driving in the wrong lane etc. play a dominant role in fatal crashes. Thus, increasing the speed limit does not play a fundamental role in fatal crashes in [the states studied],” (Malik and Aftab, 2017). Due to this prior research, as well as the test model results, it is reasonable to suggest that highway speed limit, contrary to conventional wisdom, has an insignificant effect on highway fatality rate.</p>
<p>The next step in analysis is to create advanced statistical models that intend to show more informative results than in the EDA section. As discussed prior, there will be 4 models, 3 for the city-level data, and 1 for the state-level data. The first model uses hours lost due to traffic per person per year as the response variable, so only variables that can reasonably have some sort of relationship to hours lost will be used (this is done by taking a subset of the original data). Since the response variable is not Normally distributed, a Poisson model will be the starting model. Also, since there are many possible variables that can end up becoming variables in the resulting model, a backwards regression strategy will be done. This strategy starts by creating a model with every variable, then gradually taking away the least significant variable until every variable is significant. This process is accelerated by using the stepAIC function, which removes variables based on how they affect the model’s AIC (lower is better). AIC is calculated using log-likelihood, and rewards explaining more variation in the data while also penalizing excessive use of variables. Since stepAIC is an automated function, it will be used very often throughout the rest of this project. Using stepAIC on the full Poisson model yields a model with 10 different variables, but, according to the goodness-of-fit test, this model fails. The goodness-of-fit test uses chi-squared distributions to compare the values in the model to the values in the data; if the resulting value is less than 0.05, the test fails, meaning the model does not fit the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>model1keys <span class="ot">&lt;-</span> citydataKeys[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span><span class="sc">:</span><span class="dv">34</span>, <span class="dv">36</span>, <span class="dv">40</span>, <span class="dv">43</span><span class="sc">:</span><span class="dv">48</span>)]</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>model1<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">log</span>(hrsLost2020) <span class="sc">~</span> ., <span class="at">family =</span> <span class="st">"poisson"</span>, model1keys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.970292</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.610918</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.356709</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.833213</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.644391</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.708050</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.688879</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.060443</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438

Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.332205</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.127134</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.189655</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.091042</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.772589</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.143135</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.624973</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.499810</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.871201</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.637586</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.218876</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.158883</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.401197</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.995732</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.944439</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = log(hrsLost2020) ~ ., family = "poisson", data = model1keys)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.02809  -0.30836  -0.03889   0.25911   0.72843  

Coefficients:
                         Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)             1.023e+00  1.244e+00   0.822    0.411
Est2021                 6.755e-08  8.100e-08   0.834    0.404
density                -1.532e-05  1.340e-04  -0.114    0.909
Average.Household.Size -2.721e-01  3.861e-01  -0.705    0.481
BINGE_CrudePrev         4.584e-02  4.083e-02   1.123    0.262
popChange              -1.393e-02  8.603e-02  -0.162    0.871
Median                 -6.450e-07  5.134e-06  -0.126    0.900
Stdev                  -6.622e-06  1.675e-05  -0.395    0.693
regionNortheast         1.591e-01  3.037e-01   0.524    0.600
regionSouth             1.730e-01  2.922e-01   0.592    0.554
regionWest              2.521e-01  3.096e-01   0.814    0.415
vetpct                 -2.247e-02  6.130e-02  -0.367    0.714
forpct                  7.650e-03  1.164e-02   0.657    0.511
riderrate               1.247e-03  2.966e-03   0.421    0.674

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 23.304  on 75  degrees of freedom
Residual deviance: 11.575  on 62  degrees of freedom
AIC: Inf

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>model1<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(model1<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=Inf
log(hrsLost2020) ~ Est2021 + density + Average.Household.Size + 
    BINGE_CrudePrev + popChange + Median + Stdev + region + vetpct + 
    forpct + riderrate</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.970292</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.610918</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.356709</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.833213</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.644391</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.708050</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.688879</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.060443</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438

Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.332205</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.127134</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.189655</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.091042</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.772589</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.143135</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.624973</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.499810</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.871201</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.637586</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.218876</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.158883</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.401197</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.995732</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.944439</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.970292</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.610918</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.356709</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.833213</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.644391</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.708050</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.688879</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.060443</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438

Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.332205</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.127134</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.189655</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.091042</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.772589</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.143135</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.624973</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.499810</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.871201</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.637586</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.218876</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.158883</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.401197</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.995732</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.944439</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.970292</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.610918</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.356709</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.833213</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.644391</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.708050</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.688879</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.060443</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438

Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.332205</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.127134</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.189655</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.091042</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.772589</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.143135</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.624973</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.499810</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.871201</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.637586</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.218876</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.158883</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.401197</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.995732</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.944439</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.970292</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.610918</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.356709</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.833213</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.644391</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.708050</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.688879</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.060443</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438

Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.332205</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.127134</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.189655</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.091042</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.772589</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.143135</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.624973</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.499810</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.871201</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.637586</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.218876</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.158883</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.401197</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.995732</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.944439</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.970292</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.610918</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.356709</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.833213</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.644391</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.708050</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.688879</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.060443</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438

Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.332205</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.127134</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.189655</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.091042</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.772589</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.143135</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.624973</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.499810</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.871201</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.637586</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.218876</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.158883</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.401197</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.995732</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.944439</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.970292</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.610918</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.356709</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.833213</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.644391</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.708050</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.688879</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.060443</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438

Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.332205</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.127134</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.189655</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.091042</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.772589</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.143135</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.624973</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.499810</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.871201</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.637586</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.218876</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.158883</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.401197</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.995732</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.944439</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.970292</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.610918</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.356709</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.833213</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.644391</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.708050</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.688879</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.060443</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438

Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.332205</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.127134</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.189655</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.091042</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.772589</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.143135</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.624973</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.499810</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.871201</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.637586</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.218876</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.158883</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.401197</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.995732</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.944439</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.970292</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.610918</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.356709</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.833213</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.644391</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.708050</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.688879</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.060443</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438

Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.332205</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.127134</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.189655</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.091042</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.772589</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.143135</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.624973</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.499810</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.871201</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.637586</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.218876</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.158883</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.401197</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.995732</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.944439</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.970292</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.610918</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.356709</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.833213</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.644391</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.708050</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.688879</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.060443</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438

Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.332205</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.127134</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.189655</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.091042</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.772589</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.143135</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.624973</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.499810</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.871201</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.637586</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.218876</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.158883</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.401197</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.995732</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.944439</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.970292</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.610918</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.356709</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.833213</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.644391</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.708050</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.688879</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.060443</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438

Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.332205</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.127134</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.189655</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.091042</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.772589</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.143135</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.624973</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.499810</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.871201</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.637586</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.218876</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.158883</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.401197</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.995732</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.944439</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.970292</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.610918</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.356709</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.833213</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.644391</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.708050</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.688879</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.178054</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.060443</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438

Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.332205</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.098612</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.127134</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.945910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.484907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.189655</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.091042</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.772589</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.143135</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.624973</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.564949</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.197225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.499810</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.871201</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.637586</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.791759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.218876</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.890372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.135494</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.465736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 4.158883</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.401197</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.995732</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.079442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.302585</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.044522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.609438</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.944439</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 1.386294</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 3.784190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dpois(y, mu, log = TRUE): non-integer x = 2.639057</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                         Df Deviance AIC
&lt;none&gt;                        11.575 Inf
- Est2021                 1   12.264 Inf
- density                 1   11.588 Inf
- Average.Household.Size  1   12.079 Inf
- BINGE_CrudePrev         1   12.838 Inf
- popChange               1   11.601 Inf
- Median                  1   11.591 Inf
- Stdev                   1   11.731 Inf
- region                  3   12.252 Inf
- vetpct                  1   11.710 Inf
- forpct                  1   12.004 Inf
- riderrate               1   11.751 Inf</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1024"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1024-1"><a href="#cb1024-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = log(hrsLost2020) ~ Est2021 + density + Average.Household.Size + 
    BINGE_CrudePrev + popChange + Median + Stdev + region + vetpct + 
    forpct + riderrate, family = "poisson", data = model1keys)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.02809  -0.30836  -0.03889   0.25911   0.72843  

Coefficients:
                         Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)             1.023e+00  1.244e+00   0.822    0.411
Est2021                 6.755e-08  8.100e-08   0.834    0.404
density                -1.532e-05  1.340e-04  -0.114    0.909
Average.Household.Size -2.721e-01  3.861e-01  -0.705    0.481
BINGE_CrudePrev         4.584e-02  4.083e-02   1.123    0.262
popChange              -1.393e-02  8.603e-02  -0.162    0.871
Median                 -6.450e-07  5.134e-06  -0.126    0.900
Stdev                  -6.622e-06  1.675e-05  -0.395    0.693
regionNortheast         1.591e-01  3.037e-01   0.524    0.600
regionSouth             1.730e-01  2.922e-01   0.592    0.554
regionWest              2.521e-01  3.096e-01   0.814    0.415
vetpct                 -2.247e-02  6.130e-02  -0.367    0.714
forpct                  7.650e-03  1.164e-02   0.657    0.511
riderrate               1.247e-03  2.966e-03   0.421    0.674

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 23.304  on 75  degrees of freedom
Residual deviance: 11.575  on 62  degrees of freedom
AIC: Inf

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1026"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1026-1"><a href="#cb1026-1" aria-hidden="true" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(model1<span class="fl">.2</span><span class="sc">$</span>deviance, model1<span class="fl">.2</span><span class="sc">$</span>df.residual)</span>
<span id="cb1026-2"><a href="#cb1026-2" aria-hidden="true" tabindex="-1"></a>gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1028"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1028-1"><a href="#cb1028-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Backwards regression using the stepAIC function yields a model that has 10 variables, but the model does not fit the data according to goodness-of-fit. This may suggest there is something wrong with the data.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There is a good reason for why the first model failed: for every numerical variable, the variances in hours lost for most groups is far larger than the means, as shown in these tables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1029"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1029-1"><a href="#cb1029-1" aria-hidden="true" tabindex="-1"></a>bin_function <span class="ot">&lt;-</span> <span class="cf">function</span>(var){</span>
<span id="cb1029-2"><a href="#cb1029-2" aria-hidden="true" tabindex="-1"></a>  my_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(var), <span class="fu">max</span>(var), <span class="at">length.out =</span> <span class="dv">6</span>)</span>
<span id="cb1029-3"><a href="#cb1029-3" aria-hidden="true" tabindex="-1"></a>  bins <span class="ot">&lt;-</span> <span class="fu">case_when</span>(var <span class="sc">&lt;</span> my_seq[<span class="dv">2</span>] <span class="sc">~</span> <span class="fu">paste0</span>(my_seq[<span class="dv">2</span>]),</span>
<span id="cb1029-4"><a href="#cb1029-4" aria-hidden="true" tabindex="-1"></a>                   var <span class="sc">&lt;</span> my_seq[<span class="dv">3</span>] <span class="sc">~</span> <span class="fu">paste0</span>(my_seq[<span class="dv">3</span>]),</span>
<span id="cb1029-5"><a href="#cb1029-5" aria-hidden="true" tabindex="-1"></a>                   var <span class="sc">&lt;</span> my_seq[<span class="dv">4</span>] <span class="sc">~</span> <span class="fu">paste0</span>(my_seq[<span class="dv">4</span>]),</span>
<span id="cb1029-6"><a href="#cb1029-6" aria-hidden="true" tabindex="-1"></a>                   var <span class="sc">&lt;</span> my_seq[<span class="dv">5</span>] <span class="sc">~</span> <span class="fu">paste0</span>(my_seq[<span class="dv">5</span>]),</span>
<span id="cb1029-7"><a href="#cb1029-7" aria-hidden="true" tabindex="-1"></a>                   var <span class="sc">&lt;=</span> my_seq[<span class="dv">6</span>] <span class="sc">~</span> <span class="fu">paste0</span>(my_seq[<span class="dv">6</span>]))</span>
<span id="cb1029-8"><a href="#cb1029-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1029-9"><a href="#cb1029-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1029-10"><a href="#cb1029-10" aria-hidden="true" tabindex="-1"></a>make_bins <span class="ot">&lt;-</span> <span class="cf">function</span>(var){</span>
<span id="cb1029-11"><a href="#cb1029-11" aria-hidden="true" tabindex="-1"></a>  citydata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">var_bin =</span> <span class="fu">bin_function</span>(var)) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(var_bin) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean_counts =</span> <span class="fu">mean</span>(hrsLost2020), <span class="at">var_counts =</span> <span class="fu">var</span>(hrsLost2020))</span>
<span id="cb1029-12"><a href="#cb1029-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1029-13"><a href="#cb1029-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1029-14"><a href="#cb1029-14" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins</span>(citydata<span class="sc">$</span>Est2021)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  var_bin   mean_counts var_counts
  &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;
1 1776842.6        20.6       343.
2 3449510.2        81        1058 
3 5122177.8        62          NA 
4 8467513         102          NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb1031"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1031-1"><a href="#cb1031-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins</span>(citydata<span class="sc">$</span>Average.Household.Size)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  var_bin mean_counts var_counts
  &lt;chr&gt;         &lt;dbl&gt;      &lt;dbl&gt;
1 2.36          18.8      186.  
2 2.64          26.1      695.  
3 2.92          33        736.  
4 3.2           11.8       60.9 
5 3.48           5.33       2.33</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1033"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1033-1"><a href="#cb1033-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins</span>(citydata<span class="sc">$</span>BINGE_CrudePrev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  var_bin          mean_counts var_counts
  &lt;chr&gt;                  &lt;dbl&gt;      &lt;dbl&gt;
1 13.0372405372405        8.43       36.6
2 15.7783272283272       18.4       288. 
3 18.5194139194139       25.6       656. 
4 21.2605006105006       33.2       684. 
5 24.0015873015873       40.7      1145. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb1035"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1035-1"><a href="#cb1035-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins</span>(citydata<span class="sc">$</span>popChange)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  var_bin            mean_counts var_counts
  &lt;chr&gt;                    &lt;dbl&gt;      &lt;dbl&gt;
1 -0.387723512256541        30        703. 
2 -1.865853495282           42       1372  
3 -3.34398347830745        102         NA  
4 -4.82211346133291         64         NA  
5 1.09040647076892          14.6       80.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1037"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1037-1"><a href="#cb1037-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins</span>(citydata<span class="sc">$</span>Median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  var_bin          mean_counts var_counts
  &lt;chr&gt;                  &lt;dbl&gt;      &lt;dbl&gt;
1 114068.454545455        33.6      834. 
2 43755.5018181818        10         42.7
3 61333.74                18.9      561. 
4 78911.9781818182        27.8      752. 
5 96490.2163636364        22.2      260. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb1039"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1039-1"><a href="#cb1039-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins</span>(citydata<span class="sc">$</span>Stdev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  var_bin          mean_counts var_counts
  &lt;chr&gt;                  &lt;dbl&gt;      &lt;dbl&gt;
1 37835.4493506493        10         39.4
2 46366.5415584416        18.1      298. 
3 54897.6337662338        30.5      726. 
4 63428.725974026         43.6      825. 
5 71959.8181818182        53.3      985. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb1041"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1041-1"><a href="#cb1041-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins</span>(citydata<span class="sc">$</span>forpct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  var_bin          mean_counts var_counts
  &lt;chr&gt;                  &lt;dbl&gt;      &lt;dbl&gt;
1 12.8126657188845        14.2       158.
2 24.4307614228786        27.4       598.
3 36.0488571268728        36         597.
4 47.6669528308669        76         508 
5 59.285048534861         66          NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb1043"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1043-1"><a href="#cb1043-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins</span>(citydata<span class="sc">$</span>riderrate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  var_bin          mean_counts var_counts
  &lt;chr&gt;                  &lt;dbl&gt;      &lt;dbl&gt;
1 100.919882203133        44.3       879.
2 150.854687715547        41.5       264.
3 200.78949322796         65           2 
4 250.724298740374        74.7       849.
5 50.9850766907194        15.2       155.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1045"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1045-1"><a href="#cb1045-1" aria-hidden="true" tabindex="-1"></a><span class="co">#For every numerical variable, the variances in hours lost for most groups is far larger than the means; this means we will need a quasi-poisson model.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If the variances are much greater than the means in a GLM model, the model is over-dispersed, which means that it must be changed to a quasi-poisson model, which introduces a dispersion parameter that accounts for the over-dispersion. Unfortunately, quasi-poisson models do not have an AIC, so the stepAIC function cannot be used. Therefore, each variable will have to be manually removed until every remaining variable is significant. It took 5 iterations to get to the resulting model, but this model also failed the goodness-of-fit test, which might suggest that even a quasi-poisson model is not enough to fit the data.</p>
<div class="cell">
<pre class="models cell-code"><code>model1.3 &lt;- glm(hrsLost2020 ~ ., family = "quasipoisson",  model1keys)
summary(model1.3)
#The dispersion parameter is about 8.086, suggesting that this was indeed the right move.
qqnorm(model1.3$residuals)
#Since quasi-poisson models have no AIC, the stepAIC function will not work, so we will have to manually remove each insignificant variable.

model1.4 &lt;- glm(hrsLost2020 ~ . -density, family = "quasipoisson",  model1keys)
summary(model1.4)
anova(model1.4, model1.3, test="Chisq")
model1.5 &lt;- glm(hrsLost2020 ~ . -density -riderrate, family = "quasipoisson",  model1keys)
summary(model1.5)
anova(model1.5, model1.4, test="Chisq")
model1.6 &lt;- glm(hrsLost2020 ~ . -density -vetpct -riderrate, family = "quasipoisson",  model1keys)
summary(model1.6)
anova(model1.6, model1.5, test="Chisq")
model1.7 &lt;- glm(hrsLost2020 ~ . -density -vetpct -riderrate -Stdev, family = "quasipoisson",  model1keys)
summary(model1.7)
anova(model1.7, model1.6, test="Chisq")
model1.8 &lt;- glm(hrsLost2020 ~ . -density -vetpct -riderrate -popChange -Stdev, family = "quasipoisson",  model1keys)
summary(model1.8)
anova(model1.8, model1.7, test="Chisq")
#Every variable is significant. Model 1.8 is the best quasi-poisson model.
gof &lt;- 1-pchisq(model1.8$deviance, model1.8$df.residual)
gof
#However, it does not fit the data.</code></pre>
</div>
<p>This may cause concerns about the data itself; perhaps the data was collected incorrectly or arbitrary variables were ruining every potential model. However, there is one more option: a negative binomial model, which generally serves the same function as the quasi-poisson model. The only difference is that the variance of the negative binomial model is a quadratic function of the mean, while the variance of the quasi-poisson model is a linear function of the mean; this difference can cause variables to be weighted differently, which can affect how well each model fits the data. Hours lost due to traffic, fortunately, is measured in whole numbers, so a negative binomial model would work. Backwards regression was used again for negative binomial, and, surprisingly, the full model passed the goodness-of-fit test, which is a good sign that the correct model type had finally been used. After running stepAIC, we get a model with 8 different variables that also fits the data. This indicates that the optimal model has been found, so the next step in analysis is to interpret each coefficient.</p>
<div class="cell">
<pre class="models cell-code"><code>#Negative Binomial:
model1.9 &lt;- glm.nb(hrsLost2020 ~ ., data = model1keys)
summary(model1.9)
qqnorm(model1.9$residuals)
gof &lt;- 1-pchisq(model1.9$deviance, model1.9$df.residual)
gof
#This model fits the data, but many of our variables are insignificant.

model1.10 &lt;- stepAIC(model1.9)
summary(model1.10)
qqnorm(model1.10$residuals)
gof &lt;- 1-pchisq(model1.10$deviance, model1.10$df.residual)
gof
#This model fits the data.</code></pre>
</div>
<p>Negative binomial is a type of logistic regression, so it automatically log-transforms the response variable. This means that the coefficient actually measures the change in the log of the response as the explanatory variable in question increases by 1 unit. As a result, a change in -log(e^c-1)/c, in the explanatory variable, where c is the coefficient, is enough to change the response variable by 1 unit. The reason this mathematical reasoning is implemented in the analysis is to make it seem more useful. A change in one person in population will hardly cause a dent in hours lost, so it is much more useful to know how much the population can increase before the city loses another hour due to traffic per person per year. By the way, these coefficients work under the assumption that every other possible variable is kept constant; the coefficient is meant to compare two hypothetical nearly identical observations instead of observations with a variety of differences. The 8 different variables in the model are population, people per household, crude prevalence of binge drinking, population change, wealth disparity, region (as a factor), percentage of foreign-born people, and public transport ridership per capita.</p>
<p>Population has a coefficient of .0000002774, which is still positive, but very small; this makes sense when considering the relative lack of impact one person has on a city-wide phenomenon. It also makes sense that the coefficient is positive because, as shown in the EDA, larger cities in terms of population tend to have more city-wide traffic congestion. This number means that, with all other variables kept constant, a city with exactly one more person will have an hours lost due to traffic value higher than another identical city by a factor of about 1.000000277, a factor so minuscule that it is not even worth explaining. When dealing with such small (in magnitude) correlation coefficients, it would make more sense to determine the effect of greater population differences to produce ratios that are more meaningful. Selecting a specific population difference requires that it fits the data relatively well; my estimate for a “good” number (in general terms) would be half of the interquartile range of the desired variable. The reason I chose this metric is because it represents the typical difference between two random observations, which is a 25-percentile difference.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1048"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1048-1"><a href="#cb1048-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model1keys<span class="sc">$</span>Est2021)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 235624.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1050"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1050-1"><a href="#cb1050-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model1keys<span class="sc">$</span>Average.Household.Size)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.15625</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1052"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1052-1"><a href="#cb1052-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model1keys<span class="sc">$</span>BINGE_CrudePrev)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.514369</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1054"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1054-1"><a href="#cb1054-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model1keys<span class="sc">$</span>popChange)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6074441</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1056"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1056-1"><a href="#cb1056-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model1keys<span class="sc">$</span>Stdev)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3871.072</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1058"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1058-1"><a href="#cb1058-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model1keys<span class="sc">$</span>forpct)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.448525</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1060"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1060-1"><a href="#cb1060-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model1keys<span class="sc">$</span>riderrate)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.83816</code></pre>
</div>
</div>
<p>This makes it possible to calculate a standardized ratio for each variable to determine the effect of changing each variable by 25 percentiles. Ratios above 1 indicate positive correlations, and ratios below 1 indicate negative correlations. Here is a table containing all of these results:</p>
<table class="table">
<caption>Coefficient Table for Each Variable</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th style="text-align: center;">Coeff</th>
<th style="text-align: center;">Ratio (x+1)</th>
<th style="text-align: center;">IQR/2</th>
<th style="text-align: center;">Ratio (x+IQR/2)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Population</td>
<td style="text-align: center;">2.774*10<sup>-7</sup></td>
<td style="text-align: center;">1.000000277</td>
<td style="text-align: center;">235624</td>
<td style="text-align: center;">1.067</td>
</tr>
<tr class="even">
<td>People Per Household</td>
<td style="text-align: center;">-6.451*10<sup>-1</sup></td>
<td style="text-align: center;">.5246</td>
<td style="text-align: center;">.15625</td>
<td style="text-align: center;">.9041</td>
</tr>
<tr class="odd">
<td>Crude Prevalence of Binge Drinking</td>
<td style="text-align: center;">1.338*10<sup>-1</sup></td>
<td style="text-align: center;">1.143</td>
<td style="text-align: center;">1.514</td>
<td style="text-align: center;">1.225</td>
</tr>
<tr class="even">
<td>Population Change</td>
<td style="text-align: center;">-1.167*10<sup>-1</sup></td>
<td style="text-align: center;">.8899</td>
<td style="text-align: center;">.6074</td>
<td style="text-align: center;">.9316</td>
</tr>
<tr class="odd">
<td>Standard Deviation of Income</td>
<td style="text-align: center;">-3.199*10<sup>-5</sup></td>
<td style="text-align: center;">.9999680</td>
<td style="text-align: center;">3871</td>
<td style="text-align: center;">.8835</td>
</tr>
<tr class="even">
<td>Percentage of Foreign-Born People</td>
<td style="text-align: center;">1.966*10<sup>-2</sup></td>
<td style="text-align: center;">1.0199</td>
<td style="text-align: center;">5.449</td>
<td style="text-align: center;">1.113</td>
</tr>
<tr class="odd">
<td>Public Transport Ridership Per Capita</td>
<td style="text-align: center;">4.239*10<sup>-3</sup></td>
<td style="text-align: center;">1.00425</td>
<td style="text-align: center;">20.84</td>
<td style="text-align: center;">1.092</td>
</tr>
</tbody>
</table>
<p>In terms of change in the explanatory variable by half the IQR, crude prevalence of binge drinking appears to have the greatest effect relative to its range of data; an increase of 1.514 percentage points causes hours lost due to traffic to increase by a factor of 1.225. Since the region variable (default: Midwest) is categorical, using the methods used in the other variables does not make much sense. The coefficient (or e raised to the coefficient) explains the ratio between hours lost due to traffic and each of the other regions, with all other variables kept constant. These ratios are:</p>
<p>e<sup>.5542</sup> = 1.741 for Northeastern to Midwestern cities,</p>
<p>e<sup>.6928</sup> = 1.999 for Southern to Midwestern cities, and</p>
<p>e<sup>.5542</sup> = 1.971 for Western to Midwestern cities.</p>
<p>The fact that all of these ratios are considerably higher than the binge drinking IQR ratio suggests one of two things: a) either region truly is the most impactful factor in determining traffic congestion, or b) a change in region has an impact greater than a change in half the IQR for each variable. For reference, to get an increase by a factor of 1.999 (the largest change in region) from crude prevalence of binge drinking, it would take about 5.177 percentage points, which is almost 2 standard deviations; for the lowest change in region, it would take 4.144 percentage points, about 1.5 standard deviations. So, it can be concluded that the effect of changing region is somewhere between 1.5 to 2 standard deviations for the most impactful numerical variable, which suggests that a change in region can heavily impact hours lost due to traffic. This may be due to other factors such as how the roads were structured or how long the cities have been around; older cities are generally more densely-populated. Perhaps more telling than the resulting IQR ratio for each of the variables is the sign of the coefficient, as it is much easier to explain and can more easily make reference to conventional wisdom or prior research to back it up.</p>
<p>Starting with population change, the coefficient sign being negative indicates that cities with a higher growth rate (or lower rate of population decline) tend to have fewer hours lost due to traffic after accounting for all other variables. This might suggest that traffic congestion is one of the main reasons why people are moving out of certain areas; while high-population areas usually have more traffic congestion, areas that are growing in population tend to have less traffic congestion. This might suggest that the cities experiencing the most growth are designed in such a way that ideally limits traffic congestion; this is backed up by the fact that density has a relatively strong negative correlation with population growth.</p>
<p>Next, wealth disparity has a negative coefficient, indicating that cities with more wealth disparity tend to have less traffic congestion. One theory as to why this is the case is the fact that cities with higher wealth disparity tend to have higher proportions of people living in poverty, which indicates a high unemployment rate; less employment means that fewer people need to (or can afford to) drive, thus reducing traffic. This is backed up by an MIT study in 2009 that outlines the positive correlation between wealth inequality and unemployment using complex mathematical systems that are beyond the scope of this project.</p>
<p>The next variable is percentage of foreign-born people, which has a positive coefficient. It is conventional wisdom that foreign-born people generally immigrate to the US to find job opportunities, so they will most likely move to cities (or neighborhoods) with an extensive presence of businesses. According to the Federal Reserve Bank of St.&nbsp;Louis, “more populous neighborhoods tend to see larger increases in the number of businesses than do less populous ones,” (Wheeler 2006), which can extend to cities as well. This indicates that foreign-born people are more likely to move into more populous cities, which, as proven before, tend to have more traffic congestion than less populated cities. Therefore, by a combination of conventional wisdom and prior research, it can be proven that the positive coefficient makes intuitive sense.</p>
<p>However, the most interesting finding from this model is that public transport ridership per capita has a positive coefficient, meaning that cities in which people are more likely to use public transportation tend to have more hours lost due to traffic per person per year. While this is consistent with the scatterplot from the EDA, unlike the scatterplot, the model takes every other variable (notably, including population) into account when calculating the coefficient. The model simply adds more weight to the notion that cities with more developed public transportation systems have worse traffic congestion. However, this does not mean that public transportation causes traffic congestion; it is more reasonable to assume the inverse: areas that naturally have high traffic congestion are more likely to invest in public transportation as a solution. Furthermore, city planners believing in the positive impact of public transportation is also consistent with the time series graphs shown at the end of the city-level EDA, which proved that growth in public transportation is negatively correlated with growth in traffic congestion. This is an example of how it is important to understand the realistic implications of the model results instead of blindly following the numbers without any reasonable context.</p>
<p>The second model focuses on change in traffic congestion due to COVID, according to INRIX, as the response variable. This model is expected to include more health-related variables than the first model, since prevalence of pre-existing conditions can determine how susceptible the population is to COVID, thus relating to change in traffic congestion due to COVID.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1062"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1062-1"><a href="#cb1062-1" aria-hidden="true" tabindex="-1"></a>model2keys <span class="ot">&lt;-</span> citydataKeys[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">36</span>, <span class="dv">40</span><span class="sc">:</span><span class="dv">47</span>)]</span>
<span id="cb1062-2"><a href="#cb1062-2" aria-hidden="true" tabindex="-1"></a>model2keys<span class="sc">$</span>preCovidChange <span class="ot">&lt;-</span> citydata<span class="sc">$</span>preCovidChange <span class="sc">+</span> <span class="dv">100</span></span>
<span id="cb1062-3"><a href="#cb1062-3" aria-hidden="true" tabindex="-1"></a>model2keys<span class="sc">$</span>preCovidChange[<span class="fu">is.na</span>(model2keys<span class="sc">$</span>preCovidChange)] <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1062-4"><a href="#cb1062-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1062-5"><a href="#cb1062-5" aria-hidden="true" tabindex="-1"></a>model2<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(preCovidChange <span class="sc">~</span> ., <span class="at">family =</span> <span class="st">"poisson"</span>,  model2keys)</span>
<span id="cb1062-6"><a href="#cb1062-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = preCovidChange ~ ., family = "poisson", data = model2keys)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-10.5675   -1.6820   -0.4233    2.1588   10.2391  

Coefficients:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             3.543e+00  1.476e+00   2.400 0.016378 *  
Est2021                -2.508e-07  2.607e-08  -9.620  &lt; 2e-16 ***
density                 4.435e-04  3.682e-05  12.046  &lt; 2e-16 ***
Median.Age             -1.160e-01  1.372e-02  -8.453  &lt; 2e-16 ***
Average.Household.Size  3.928e-02  1.471e-01   0.267 0.789481    
ARTHRITIS_CrudePrev     2.739e-02  1.886e-02   1.453 0.146346    
BINGE_CrudePrev         1.705e-01  1.903e-02   8.963  &lt; 2e-16 ***
BPHIGH_CrudePrev       -1.206e-01  2.170e-02  -5.559 2.71e-08 ***
BPMED_CrudePrev         7.672e-02  2.149e-02   3.571 0.000356 ***
CANCER_CrudePrev        1.010e+00  1.049e-01   9.628  &lt; 2e-16 ***
CASTHMA_CrudePrev       2.604e-01  5.002e-02   5.205 1.94e-07 ***
CHD_CrudePrev           1.630e-01  1.232e-01   1.324 0.185625    
CHECKUP_CrudePrev      -5.159e-02  1.094e-02  -4.718 2.38e-06 ***
CHOLSCREEN_CrudePrev   -1.084e-01  1.854e-02  -5.844 5.10e-09 ***
COLON_SCREEN_CrudePrev  6.952e-02  1.566e-02   4.439 9.06e-06 ***
COPD_CrudePrev         -3.333e-01  5.996e-02  -5.559 2.71e-08 ***
COREM_CrudePrev        -1.920e-02  1.008e-02  -1.906 0.056704 .  
COREW_CrudePrev        -1.641e-02  1.125e-02  -1.458 0.144873    
CSMOKING_CrudePrev     -8.611e-02  2.028e-02  -4.245 2.18e-05 ***
DENTAL_CrudePrev       -7.221e-02  1.401e-02  -5.155 2.53e-07 ***
DIABETES_CrudePrev      1.632e-01  4.908e-02   3.324 0.000886 ***
HIGHCHOL_CrudePrev      1.384e-01  1.905e-02   7.268 3.66e-13 ***
KIDNEY_CrudePrev       -3.962e-01  2.440e-01  -1.623 0.104488    
LPA_CrudePrev           2.833e-02  1.584e-02   1.789 0.073674 .  
MAMMOUSE_CrudePrev     -8.617e-02  1.191e-02  -7.238 4.56e-13 ***
MHLTH_CrudePrev         2.291e-01  3.941e-02   5.814 6.11e-09 ***
OBESITY_CrudePrev      -5.917e-02  1.359e-02  -4.353 1.34e-05 ***
PAPTEST_CrudePrev       7.208e-02  1.794e-02   4.018 5.88e-05 ***
PHLTH_CrudePrev        -2.469e-01  6.005e-02  -4.113 3.91e-05 ***
SLEEP_CrudePrev         1.100e-01  1.260e-02   8.729  &lt; 2e-16 ***
STROKE_CrudePrev       -1.990e-01  1.355e-01  -1.469 0.141863    
TEETHLOST_CrudePrev     1.248e-01  1.536e-02   8.124 4.51e-16 ***
popChange               1.149e-01  2.218e-02   5.179 2.23e-07 ***
Median                  7.873e-07  1.535e-06   0.513 0.607973    
Stdev                   1.911e-05  5.627e-06   3.396 0.000683 ***
regionNortheast        -7.980e-01  1.263e-01  -6.320 2.62e-10 ***
regionSouth             9.984e-01  1.254e-01   7.961 1.71e-15 ***
regionWest              9.804e-01  1.605e-01   6.110 9.95e-10 ***
insurance_prev         -5.307e-02  1.532e-02  -3.465 0.000531 ***
riderrate              -6.858e-03  9.293e-04  -7.379 1.59e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 5397.11  on 75  degrees of freedom
Residual deviance:  916.78  on 36  degrees of freedom
AIC: 1451.9

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1064"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1064-1"><a href="#cb1064-1" aria-hidden="true" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(model2<span class="fl">.1</span><span class="sc">$</span>deviance, model2<span class="fl">.1</span><span class="sc">$</span>df.residual)</span>
<span id="cb1064-2"><a href="#cb1064-2" aria-hidden="true" tabindex="-1"></a>gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1066"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1066-1"><a href="#cb1066-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Using all terms does not fit the model.</span></span>
<span id="cb1066-2"><a href="#cb1066-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1066-3"><a href="#cb1066-3" aria-hidden="true" tabindex="-1"></a>model2<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(model2<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1451.94
preCovidChange ~ Est2021 + density + Median.Age + Average.Household.Size + 
    ARTHRITIS_CrudePrev + BINGE_CrudePrev + BPHIGH_CrudePrev + 
    BPMED_CrudePrev + CANCER_CrudePrev + CASTHMA_CrudePrev + 
    CHD_CrudePrev + CHECKUP_CrudePrev + CHOLSCREEN_CrudePrev + 
    COLON_SCREEN_CrudePrev + COPD_CrudePrev + COREM_CrudePrev + 
    COREW_CrudePrev + CSMOKING_CrudePrev + DENTAL_CrudePrev + 
    DIABETES_CrudePrev + HIGHCHOL_CrudePrev + KIDNEY_CrudePrev + 
    LPA_CrudePrev + MAMMOUSE_CrudePrev + MHLTH_CrudePrev + OBESITY_CrudePrev + 
    PAPTEST_CrudePrev + PHLTH_CrudePrev + SLEEP_CrudePrev + STROKE_CrudePrev + 
    TEETHLOST_CrudePrev + popChange + Median + Stdev + region + 
    insurance_prev + riderrate

                         Df Deviance    AIC
- Average.Household.Size  1   916.85 1450.0
- Median                  1   917.05 1450.2
- CHD_CrudePrev           1   918.54 1451.7
&lt;none&gt;                        916.78 1451.9
- ARTHRITIS_CrudePrev     1   918.90 1452.0
- COREW_CrudePrev         1   918.91 1452.1
- STROKE_CrudePrev        1   918.93 1452.1
- KIDNEY_CrudePrev        1   919.43 1452.6
- LPA_CrudePrev           1   919.98 1453.1
- COREM_CrudePrev         1   920.41 1453.6
- DIABETES_CrudePrev      1   927.83 1461.0
- Stdev                   1   928.35 1461.5
- insurance_prev          1   928.86 1462.0
- BPMED_CrudePrev         1   929.54 1462.7
- PAPTEST_CrudePrev       1   932.82 1466.0
- PHLTH_CrudePrev         1   933.81 1467.0
- CSMOKING_CrudePrev      1   935.00 1468.2
- OBESITY_CrudePrev       1   935.69 1468.8
- COLON_SCREEN_CrudePrev  1   936.68 1469.8
- CHECKUP_CrudePrev       1   939.01 1472.2
- DENTAL_CrudePrev        1   943.63 1476.8
- CASTHMA_CrudePrev       1   943.88 1477.0
- popChange               1   944.26 1477.4
- BPHIGH_CrudePrev        1   947.62 1480.8
- COPD_CrudePrev          1   948.37 1481.5
- MHLTH_CrudePrev         1   950.62 1483.8
- CHOLSCREEN_CrudePrev    1   950.92 1484.1
- HIGHCHOL_CrudePrev      1   969.38 1502.5
- MAMMOUSE_CrudePrev      1   970.13 1503.3
- riderrate               1   972.35 1505.5
- TEETHLOST_CrudePrev     1   982.11 1515.3
- Median.Age              1   987.10 1520.3
- SLEEP_CrudePrev         1   993.40 1526.5
- BINGE_CrudePrev         1   999.93 1533.1
- CANCER_CrudePrev        1  1009.07 1542.2
- Est2021                 1  1013.49 1546.7
- density                 1  1063.86 1597.0
- region                  3  1100.89 1630.0

Step:  AIC=1450.01
preCovidChange ~ Est2021 + density + Median.Age + ARTHRITIS_CrudePrev + 
    BINGE_CrudePrev + BPHIGH_CrudePrev + BPMED_CrudePrev + CANCER_CrudePrev + 
    CASTHMA_CrudePrev + CHD_CrudePrev + CHECKUP_CrudePrev + CHOLSCREEN_CrudePrev + 
    COLON_SCREEN_CrudePrev + COPD_CrudePrev + COREM_CrudePrev + 
    COREW_CrudePrev + CSMOKING_CrudePrev + DENTAL_CrudePrev + 
    DIABETES_CrudePrev + HIGHCHOL_CrudePrev + KIDNEY_CrudePrev + 
    LPA_CrudePrev + MAMMOUSE_CrudePrev + MHLTH_CrudePrev + OBESITY_CrudePrev + 
    PAPTEST_CrudePrev + PHLTH_CrudePrev + SLEEP_CrudePrev + STROKE_CrudePrev + 
    TEETHLOST_CrudePrev + popChange + Median + Stdev + region + 
    insurance_prev + riderrate

                         Df Deviance    AIC
- Median                  1   917.05 1448.2
- CHD_CrudePrev           1   918.77 1449.9
&lt;none&gt;                        916.85 1450.0
- ARTHRITIS_CrudePrev     1   918.94 1450.1
- COREW_CrudePrev         1   918.99 1450.1
- STROKE_CrudePrev        1   919.16 1450.3
- LPA_CrudePrev           1   920.00 1451.2
- KIDNEY_CrudePrev        1   920.22 1451.4
- COREM_CrudePrev         1   920.49 1451.6
- DIABETES_CrudePrev      1   928.07 1459.2
- Stdev                   1   928.41 1459.6
- insurance_prev          1   929.85 1461.0
- BPMED_CrudePrev         1   930.31 1461.5
- CSMOKING_CrudePrev      1   935.16 1466.3
- PHLTH_CrudePrev         1   935.24 1466.4
- OBESITY_CrudePrev       1   935.88 1467.0
- PAPTEST_CrudePrev       1   936.88 1468.0
- COLON_SCREEN_CrudePrev  1   937.49 1468.7
- CHECKUP_CrudePrev       1   939.27 1470.4
- DENTAL_CrudePrev        1   943.73 1474.9
- popChange               1   944.29 1475.5
- CASTHMA_CrudePrev       1   944.82 1476.0
- BPHIGH_CrudePrev        1   948.03 1479.2
- COPD_CrudePrev          1   948.39 1479.5
- MHLTH_CrudePrev         1   951.02 1482.2
- CHOLSCREEN_CrudePrev    1   954.19 1485.3
- HIGHCHOL_CrudePrev      1   969.38 1500.5
- MAMMOUSE_CrudePrev      1   973.59 1504.7
- riderrate               1   979.00 1510.2
- TEETHLOST_CrudePrev     1   984.78 1515.9
- Median.Age              1   991.06 1522.2
- BINGE_CrudePrev         1  1004.88 1536.0
- SLEEP_CrudePrev         1  1010.55 1541.7
- CANCER_CrudePrev        1  1010.69 1541.8
- Est2021                 1  1014.01 1545.2
- density                 1  1075.60 1606.8
- region                  3  1101.61 1628.8

Step:  AIC=1448.2
preCovidChange ~ Est2021 + density + Median.Age + ARTHRITIS_CrudePrev + 
    BINGE_CrudePrev + BPHIGH_CrudePrev + BPMED_CrudePrev + CANCER_CrudePrev + 
    CASTHMA_CrudePrev + CHD_CrudePrev + CHECKUP_CrudePrev + CHOLSCREEN_CrudePrev + 
    COLON_SCREEN_CrudePrev + COPD_CrudePrev + COREM_CrudePrev + 
    COREW_CrudePrev + CSMOKING_CrudePrev + DENTAL_CrudePrev + 
    DIABETES_CrudePrev + HIGHCHOL_CrudePrev + KIDNEY_CrudePrev + 
    LPA_CrudePrev + MAMMOUSE_CrudePrev + MHLTH_CrudePrev + OBESITY_CrudePrev + 
    PAPTEST_CrudePrev + PHLTH_CrudePrev + SLEEP_CrudePrev + STROKE_CrudePrev + 
    TEETHLOST_CrudePrev + popChange + Stdev + region + insurance_prev + 
    riderrate

                         Df Deviance    AIC
&lt;none&gt;                        917.05 1448.2
- CHD_CrudePrev           1   919.31 1448.5
- STROKE_CrudePrev        1   919.35 1448.5
- ARTHRITIS_CrudePrev     1   919.36 1448.5
- COREW_CrudePrev         1   919.43 1448.6
- LPA_CrudePrev           1   920.16 1449.3
- KIDNEY_CrudePrev        1   920.38 1449.5
- COREM_CrudePrev         1   920.54 1449.7
- Stdev                   1   928.47 1457.6
- DIABETES_CrudePrev      1   928.66 1457.8
- insurance_prev          1   930.28 1459.4
- BPMED_CrudePrev         1   930.38 1459.5
- CSMOKING_CrudePrev      1   935.19 1464.3
- PHLTH_CrudePrev         1   936.11 1465.3
- OBESITY_CrudePrev       1   937.62 1466.8
- COLON_SCREEN_CrudePrev  1   937.91 1467.1
- PAPTEST_CrudePrev       1   938.97 1468.1
- CHECKUP_CrudePrev       1   939.75 1468.9
- popChange               1   944.46 1473.6
- DENTAL_CrudePrev        1   944.90 1474.0
- CASTHMA_CrudePrev       1   945.87 1475.0
- COPD_CrudePrev          1   948.39 1477.5
- MHLTH_CrudePrev         1   951.36 1480.5
- CHOLSCREEN_CrudePrev    1   959.13 1488.3
- BPHIGH_CrudePrev        1   964.92 1494.1
- HIGHCHOL_CrudePrev      1   969.39 1498.5
- MAMMOUSE_CrudePrev      1   973.93 1503.1
- riderrate               1   980.92 1510.1
- TEETHLOST_CrudePrev     1   984.98 1514.1
- Median.Age              1   991.27 1520.4
- BINGE_CrudePrev         1  1008.53 1537.7
- SLEEP_CrudePrev         1  1010.61 1539.8
- CANCER_CrudePrev        1  1011.53 1540.7
- Est2021                 1  1014.01 1543.2
- density                 1  1086.31 1615.5
- region                  3  1116.04 1641.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1068"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1068-1"><a href="#cb1068-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = preCovidChange ~ Est2021 + density + Median.Age + 
    ARTHRITIS_CrudePrev + BINGE_CrudePrev + BPHIGH_CrudePrev + 
    BPMED_CrudePrev + CANCER_CrudePrev + CASTHMA_CrudePrev + 
    CHD_CrudePrev + CHECKUP_CrudePrev + CHOLSCREEN_CrudePrev + 
    COLON_SCREEN_CrudePrev + COPD_CrudePrev + COREM_CrudePrev + 
    COREW_CrudePrev + CSMOKING_CrudePrev + DENTAL_CrudePrev + 
    DIABETES_CrudePrev + HIGHCHOL_CrudePrev + KIDNEY_CrudePrev + 
    LPA_CrudePrev + MAMMOUSE_CrudePrev + MHLTH_CrudePrev + OBESITY_CrudePrev + 
    PAPTEST_CrudePrev + PHLTH_CrudePrev + SLEEP_CrudePrev + STROKE_CrudePrev + 
    TEETHLOST_CrudePrev + popChange + Stdev + region + insurance_prev + 
    riderrate, family = "poisson", data = model2keys)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-10.5119   -1.6442   -0.4337    2.0393   10.2971  

Coefficients:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             3.752e+00  1.399e+00   2.683 0.007305 ** 
Est2021                -2.496e-07  2.586e-08  -9.652  &lt; 2e-16 ***
density                 4.491e-04  3.489e-05  12.872  &lt; 2e-16 ***
Median.Age             -1.161e-01  1.340e-02  -8.662  &lt; 2e-16 ***
ARTHRITIS_CrudePrev     2.836e-02  1.866e-02   1.520 0.128576    
BINGE_CrudePrev         1.698e-01  1.807e-02   9.396  &lt; 2e-16 ***
BPHIGH_CrudePrev       -1.262e-01  1.826e-02  -6.910 4.86e-12 ***
BPMED_CrudePrev         7.592e-02  2.082e-02   3.646 0.000266 ***
CANCER_CrudePrev        9.988e-01  1.023e-01   9.763  &lt; 2e-16 ***
CASTHMA_CrudePrev       2.517e-01  4.699e-02   5.356 8.51e-08 ***
CHD_CrudePrev           1.790e-01  1.192e-01   1.502 0.133050    
CHECKUP_CrudePrev      -5.069e-02  1.066e-02  -4.755 1.99e-06 ***
CHOLSCREEN_CrudePrev   -1.118e-01  1.720e-02  -6.502 7.95e-11 ***
COLON_SCREEN_CrudePrev  7.034e-02  1.549e-02   4.540 5.62e-06 ***
COPD_CrudePrev         -3.299e-01  5.950e-02  -5.544 2.95e-08 ***
COREM_CrudePrev        -1.874e-02  1.001e-02  -1.872 0.061259 .  
COREW_CrudePrev        -1.719e-02  1.113e-02  -1.545 0.122447    
CSMOKING_CrudePrev     -8.495e-02  2.004e-02  -4.238 2.25e-05 ***
DENTAL_CrudePrev       -7.294e-02  1.391e-02  -5.242 1.59e-07 ***
DIABETES_CrudePrev      1.660e-01  4.873e-02   3.407 0.000658 ***
HIGHCHOL_CrudePrev      1.378e-01  1.900e-02   7.252 4.11e-13 ***
KIDNEY_CrudePrev       -4.169e-01  2.289e-01  -1.821 0.068576 .  
LPA_CrudePrev           2.788e-02  1.579e-02   1.766 0.077445 .  
MAMMOUSE_CrudePrev     -8.620e-02  1.156e-02  -7.459 8.69e-14 ***
MHLTH_CrudePrev         2.246e-01  3.842e-02   5.848 4.99e-09 ***
OBESITY_CrudePrev      -5.634e-02  1.239e-02  -4.546 5.46e-06 ***
PAPTEST_CrudePrev       7.550e-02  1.607e-02   4.697 2.65e-06 ***
PHLTH_CrudePrev        -2.443e-01  5.603e-02  -4.360 1.30e-05 ***
SLEEP_CrudePrev         1.112e-01  1.149e-02   9.683  &lt; 2e-16 ***
STROKE_CrudePrev       -2.044e-01  1.341e-01  -1.524 0.127620    
TEETHLOST_CrudePrev     1.232e-01  1.486e-02   8.286  &lt; 2e-16 ***
popChange               1.132e-01  2.186e-02   5.177 2.25e-07 ***
Stdev                   1.894e-05  5.609e-06   3.377 0.000732 ***
regionNortheast        -7.823e-01  1.220e-01  -6.414 1.42e-10 ***
regionSouth             1.022e+00  1.154e-01   8.853  &lt; 2e-16 ***
regionWest              1.007e+00  1.415e-01   7.116 1.11e-12 ***
insurance_prev         -5.195e-02  1.430e-02  -3.633 0.000280 ***
riderrate              -6.970e-03  8.833e-04  -7.891 2.99e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 5397.11  on 75  degrees of freedom
Residual deviance:  917.05  on 38  degrees of freedom
AIC: 1448.2

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1070"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1070-1"><a href="#cb1070-1" aria-hidden="true" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(model2<span class="fl">.2</span><span class="sc">$</span>deviance, model2<span class="fl">.2</span><span class="sc">$</span>df.residual)</span>
<span id="cb1070-2"><a href="#cb1070-2" aria-hidden="true" tabindex="-1"></a>gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1072"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1072-1"><a href="#cb1072-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Even the stepAIC function doesn't help improve the goodness of fit. This might have something to do with the fact that there are too many variables.</span></span>
<span id="cb1072-2"><a href="#cb1072-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1072-3"><a href="#cb1072-3" aria-hidden="true" tabindex="-1"></a>model2<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(preCovidChange <span class="sc">~</span> CHOLSCREEN_CrudePrev <span class="sc">+</span> PAPTEST_CrudePrev <span class="sc">+</span> COLON_SCREEN_CrudePrev <span class="sc">+</span> Average.Household.Size <span class="sc">+</span> insurance_prev, <span class="at">family =</span> <span class="st">"poisson"</span>, model2keys)</span>
<span id="cb1072-4"><a href="#cb1072-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = preCovidChange ~ CHOLSCREEN_CrudePrev + PAPTEST_CrudePrev + 
    COLON_SCREEN_CrudePrev + Average.Household.Size + insurance_prev, 
    family = "poisson", data = model2keys)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-15.269   -3.780   -0.030    3.153   21.326  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)            16.543335   0.517208   31.99  &lt; 2e-16 ***
CHOLSCREEN_CrudePrev   -0.123809   0.007474  -16.57  &lt; 2e-16 ***
PAPTEST_CrudePrev      -0.113287   0.007517  -15.07  &lt; 2e-16 ***
COLON_SCREEN_CrudePrev  0.074164   0.005939   12.49  &lt; 2e-16 ***
Average.Household.Size  0.967474   0.055698   17.37  &lt; 2e-16 ***
insurance_prev         -0.016418   0.002578   -6.37  1.9e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 5397.1  on 75  degrees of freedom
Residual deviance: 2316.3  on 70  degrees of freedom
AIC: 2783.5

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1074"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1074-1"><a href="#cb1074-1" aria-hidden="true" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(model2<span class="fl">.3</span><span class="sc">$</span>deviance, model2<span class="fl">.3</span><span class="sc">$</span>df.residual)</span>
<span id="cb1074-2"><a href="#cb1074-2" aria-hidden="true" tabindex="-1"></a>gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1076"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1076-1"><a href="#cb1076-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Despite the fact that every variable is significant, the goodness-of-fit test still fails. Let's try quasi-poisson.</span></span>
<span id="cb1076-2"><a href="#cb1076-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1076-3"><a href="#cb1076-3" aria-hidden="true" tabindex="-1"></a>make_bins2 <span class="ot">&lt;-</span> <span class="cf">function</span>(var){</span>
<span id="cb1076-4"><a href="#cb1076-4" aria-hidden="true" tabindex="-1"></a>  model2keys <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">var_bin =</span> <span class="fu">bin_function</span>(var)) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(var_bin) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean_counts =</span> <span class="fu">mean</span>(preCovidChange), <span class="at">var_counts =</span> <span class="fu">var</span>(preCovidChange))</span>
<span id="cb1076-5"><a href="#cb1076-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1076-6"><a href="#cb1076-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1076-7"><a href="#cb1076-7" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins2</span>(citydata<span class="sc">$</span>CHOLSCREEN_CrudePrev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  var_bin          mean_counts var_counts
  &lt;chr&gt;                  &lt;dbl&gt;      &lt;dbl&gt;
1 66.1874531835206       877          NA 
2 69.0165730337079       151.      29806.
3 71.8456928838951        69.5      1276.
4 74.6748127340824        62.7       500.
5 77.5039325842697        49.8       228.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1078"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1078-1"><a href="#cb1078-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins2</span>(citydata<span class="sc">$</span>PAPTEST_CrudePrev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  var_bin          mean_counts var_counts
  &lt;chr&gt;                  &lt;dbl&gt;      &lt;dbl&gt;
1 72.589706959707        320.     232457.
2 75.7252472527473       117.      15255.
3 78.8607875457875        80.4      6027.
4 81.9963278388278        62.2       766.
5 85.1318681318681        48.1       294.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1080"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1080-1"><a href="#cb1080-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins2</span>(citydata<span class="sc">$</span>COLON_SCREEN_CrudePrev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  var_bin          mean_counts var_counts
  &lt;chr&gt;                  &lt;dbl&gt;      &lt;dbl&gt;
1 47.380873015873        877         NA  
2 52.555496031746         32.5       12.5
3 57.730119047619         88.1     8345. 
4 62.9047420634921        74.1     4106. 
5 68.0793650793651        55.9      767. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb1082"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1082-1"><a href="#cb1082-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins2</span>(citydata<span class="sc">$</span>Average.Household.Size)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  var_bin mean_counts var_counts
  &lt;chr&gt;         &lt;dbl&gt;      &lt;dbl&gt;
1 2.36           72.9      6262.
2 2.64           61.2       605.
3 2.92           87.8      2679.
4 3.2           156.      48700.
5 3.48          334.     221424.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1084"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1084-1"><a href="#cb1084-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins2</span>(citydata<span class="sc">$</span>insurance_prev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  var_bin          mean_counts var_counts
  &lt;chr&gt;                  &lt;dbl&gt;      &lt;dbl&gt;
1 60.3742063492063       877          NA 
2 68.0921626984127        55.5      1300.
3 75.8101190476191        73.8       768.
4 83.5280753968254        76.7      5437.
5 91.2460317460317        71.6      5230.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1086"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1086-1"><a href="#cb1086-1" aria-hidden="true" tabindex="-1"></a>model2<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(preCovidChange <span class="sc">~</span> CHOLSCREEN_CrudePrev <span class="sc">+</span> PAPTEST_CrudePrev <span class="sc">+</span> COLON_SCREEN_CrudePrev <span class="sc">+</span> Average.Household.Size <span class="sc">+</span> insurance_prev, <span class="at">family =</span> <span class="st">"quasipoisson"</span>, model2keys)</span>
<span id="cb1086-2"><a href="#cb1086-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = preCovidChange ~ CHOLSCREEN_CrudePrev + PAPTEST_CrudePrev + 
    COLON_SCREEN_CrudePrev + Average.Household.Size + insurance_prev, 
    family = "quasipoisson", data = model2keys)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-15.269   -3.780   -0.030    3.153   21.326  

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            16.54333    3.10954   5.320 1.18e-06 ***
CHOLSCREEN_CrudePrev   -0.12381    0.04493  -2.755  0.00747 ** 
PAPTEST_CrudePrev      -0.11329    0.04519  -2.507  0.01451 *  
COLON_SCREEN_CrudePrev  0.07416    0.03571   2.077  0.04147 *  
Average.Household.Size  0.96747    0.33486   2.889  0.00514 ** 
insurance_prev         -0.01642    0.01550  -1.059  0.29304    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for quasipoisson family taken to be 36.14616)

    Null deviance: 5397.1  on 75  degrees of freedom
Residual deviance: 2316.3  on 70  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1088"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1088-1"><a href="#cb1088-1" aria-hidden="true" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(model2<span class="fl">.4</span><span class="sc">$</span>deviance, model2<span class="fl">.4</span><span class="sc">$</span>df.residual)</span>
<span id="cb1088-2"><a href="#cb1088-2" aria-hidden="true" tabindex="-1"></a>gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1090"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1090-1"><a href="#cb1090-1" aria-hidden="true" tabindex="-1"></a>model2<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(preCovidChange <span class="sc">~</span> CHOLSCREEN_CrudePrev <span class="sc">+</span> PAPTEST_CrudePrev <span class="sc">+</span> COLON_SCREEN_CrudePrev <span class="sc">+</span> Average.Household.Size, <span class="at">family =</span> <span class="st">"quasipoisson"</span>, model2keys)</span>
<span id="cb1090-2"><a href="#cb1090-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = preCovidChange ~ CHOLSCREEN_CrudePrev + PAPTEST_CrudePrev + 
    COLON_SCREEN_CrudePrev + Average.Household.Size, family = "quasipoisson", 
    data = model2keys)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-16.4806   -4.0063   -0.2209    2.9625   21.1114  

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            15.98401    2.99169   5.343 1.05e-06 ***
CHOLSCREEN_CrudePrev   -0.12008    0.04476  -2.683  0.00907 ** 
PAPTEST_CrudePrev      -0.11414    0.04504  -2.534  0.01347 *  
COLON_SCREEN_CrudePrev  0.05389    0.03002   1.795  0.07694 .  
Average.Household.Size  1.05244    0.31610   3.329  0.00138 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for quasipoisson family taken to be 35.76252)

    Null deviance: 5397.1  on 75  degrees of freedom
Residual deviance: 2357.1  on 71  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1092"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1092-1"><a href="#cb1092-1" aria-hidden="true" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(model2<span class="fl">.5</span><span class="sc">$</span>deviance, model2<span class="fl">.5</span><span class="sc">$</span>df.residual)</span>
<span id="cb1092-2"><a href="#cb1092-2" aria-hidden="true" tabindex="-1"></a>gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1094"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1094-1"><a href="#cb1094-1" aria-hidden="true" tabindex="-1"></a>model2<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(preCovidChange <span class="sc">~</span> CHOLSCREEN_CrudePrev <span class="sc">+</span> PAPTEST_CrudePrev <span class="sc">+</span> Average.Household.Size, <span class="at">family =</span> <span class="st">"quasipoisson"</span>, model2keys)</span>
<span id="cb1094-2"><a href="#cb1094-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = preCovidChange ~ CHOLSCREEN_CrudePrev + PAPTEST_CrudePrev + 
    Average.Household.Size, family = "quasipoisson", data = model2keys)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-14.5070   -4.3702   -0.1956    3.0614   23.7287  

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            14.93813    3.04933   4.899 5.74e-06 ***
CHOLSCREEN_CrudePrev   -0.10823    0.04694  -2.306  0.02400 *  
PAPTEST_CrudePrev      -0.06134    0.03525  -1.740  0.08611 .  
Average.Household.Size  0.75450    0.27997   2.695  0.00876 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for quasipoisson family taken to be 39.36682)

    Null deviance: 5397.1  on 75  degrees of freedom
Residual deviance: 2471.7  on 72  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1096"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1096-1"><a href="#cb1096-1" aria-hidden="true" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(model2<span class="fl">.6</span><span class="sc">$</span>deviance, model2<span class="fl">.6</span><span class="sc">$</span>df.residual)</span>
<span id="cb1096-2"><a href="#cb1096-2" aria-hidden="true" tabindex="-1"></a>gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1098"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1098-1"><a href="#cb1098-1" aria-hidden="true" tabindex="-1"></a>model2<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(preCovidChange <span class="sc">~</span> CHOLSCREEN_CrudePrev <span class="sc">+</span> Average.Household.Size, <span class="at">family =</span> <span class="st">"quasipoisson"</span>, model2keys)</span>
<span id="cb1098-2"><a href="#cb1098-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2<span class="fl">.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = preCovidChange ~ CHOLSCREEN_CrudePrev + Average.Household.Size, 
    family = "quasipoisson", data = model2keys)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-15.3485   -4.2292    0.0784    3.3556   22.6808  

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            13.85779    3.01698   4.593 1.78e-05 ***
CHOLSCREEN_CrudePrev   -0.16174    0.03503  -4.618 1.63e-05 ***
Average.Household.Size  0.79162    0.28009   2.826  0.00607 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for quasipoisson family taken to be 39.16839)

    Null deviance: 5397.1  on 75  degrees of freedom
Residual deviance: 2590.9  on 73  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1100-1"><a href="#cb1100-1" aria-hidden="true" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(model2<span class="fl">.7</span><span class="sc">$</span>deviance, model2<span class="fl">.7</span><span class="sc">$</span>df.residual)</span>
<span id="cb1100-2"><a href="#cb1100-2" aria-hidden="true" tabindex="-1"></a>gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>I chose to start with Poisson models since the response variable is a) a whole number and b) extremely right-skewed. Backwards regression (models 2.1, 2.2) yielded a model that had far too many variables to be interpretable, while still failing the goodness-of-fit test. I tried adding the 5 most significant variables from the EDA (model 1.3), but this also failed; what is interesting to note was that the goodness-of-fit value for both models was 0, meaning that the models completely failed the test. Again, this might indicate that there may be something unusual with the data, as most data sets do not have this problem; this may be because my data was taken from a variety of sources instead of just one database. As shown in the first model analysis, many of the significant variables have variances much higher than their respective means, suggesting that overdispersion is present. Thus, a quasi-poisson model (model 2.4) may be at least somewhat useful, this notion is confirmed by the fact that the dispersion parameter is about 36.146. Removing each insignificant variable step-by-step yields a model (2.7) with only 2 variables, but none of the models in each step even registered a blip on the goodness-of-fit test; all of them recorded 0s. Just like in the first set of models, the last resort is the negative binomial model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1102-1"><a href="#cb1102-1" aria-hidden="true" tabindex="-1"></a>model2<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(preCovidChange <span class="sc">~</span> CHOLSCREEN_CrudePrev <span class="sc">+</span> PAPTEST_CrudePrev <span class="sc">+</span> COLON_SCREEN_CrudePrev <span class="sc">+</span> Average.Household.Size <span class="sc">+</span> insurance_prev, model2keys)</span>
<span id="cb1102-2"><a href="#cb1102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2<span class="fl">.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm.nb(formula = preCovidChange ~ CHOLSCREEN_CrudePrev + PAPTEST_CrudePrev + 
    COLON_SCREEN_CrudePrev + Average.Household.Size + insurance_prev, 
    data = model2keys, init.theta = 3.676175329, link = log)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1908  -0.9494  -0.2241   0.4886   3.3467  

Coefficients:
                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)            12.96250    2.51667   5.151  2.6e-07 ***
CHOLSCREEN_CrudePrev   -0.08900    0.03360  -2.648  0.00809 ** 
PAPTEST_CrudePrev      -0.08691    0.03409  -2.549  0.01079 *  
COLON_SCREEN_CrudePrev  0.06173    0.02732   2.259  0.02388 *  
Average.Household.Size  0.78558    0.28695   2.738  0.00619 ** 
insurance_prev         -0.01330    0.01426  -0.933  0.35091    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Negative Binomial(3.6762) family taken to be 1)

    Null deviance: 155.890  on 75  degrees of freedom
Residual deviance:  78.156  on 70  degrees of freedom
AIC: 771.73

Number of Fisher Scoring iterations: 1

              Theta:  3.676 
          Std. Err.:  0.597 

 2 x log-likelihood:  -757.732 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb1104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1104-1"><a href="#cb1104-1" aria-hidden="true" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(model2<span class="fl">.8</span><span class="sc">$</span>deviance, model2<span class="fl">.8</span><span class="sc">$</span>df.residual)</span>
<span id="cb1104-2"><a href="#cb1104-2" aria-hidden="true" tabindex="-1"></a>gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2357461</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1106-1"><a href="#cb1106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This model fits the data. This is a good sign.</span></span>
<span id="cb1106-2"><a href="#cb1106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1106-3"><a href="#cb1106-3" aria-hidden="true" tabindex="-1"></a>model2<span class="fl">.9</span> <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(model2<span class="fl">.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=769.73
preCovidChange ~ CHOLSCREEN_CrudePrev + PAPTEST_CrudePrev + COLON_SCREEN_CrudePrev + 
    Average.Household.Size + insurance_prev

                         Df    AIC
- insurance_prev          1 768.59
&lt;none&gt;                      769.73
- COLON_SCREEN_CrudePrev  1 772.43
- PAPTEST_CrudePrev       1 773.47
- CHOLSCREEN_CrudePrev    1 774.42
- Average.Household.Size  1 774.45

Step:  AIC=768.59
preCovidChange ~ CHOLSCREEN_CrudePrev + PAPTEST_CrudePrev + COLON_SCREEN_CrudePrev + 
    Average.Household.Size

                         Df    AIC
&lt;none&gt;                      768.59
- COLON_SCREEN_CrudePrev  1 770.53
- PAPTEST_CrudePrev       1 772.26
- CHOLSCREEN_CrudePrev    1 772.68
- Average.Household.Size  1 774.64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1108-1"><a href="#cb1108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2<span class="fl">.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm.nb(formula = preCovidChange ~ CHOLSCREEN_CrudePrev + PAPTEST_CrudePrev + 
    COLON_SCREEN_CrudePrev + Average.Household.Size, data = model2keys, 
    init.theta = 3.63666243, link = log)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1355  -0.9068  -0.2540   0.4049   3.2738  

Coefficients:
                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)            12.19745    2.35954   5.169 2.35e-07 ***
CHOLSCREEN_CrudePrev   -0.08431    0.03336  -2.527  0.01150 *  
PAPTEST_CrudePrev      -0.08680    0.03426  -2.534  0.01129 *  
COLON_SCREEN_CrudePrev  0.04741    0.02403   1.973  0.04853 *  
Average.Household.Size  0.85772    0.27605   3.107  0.00189 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Negative Binomial(3.6367) family taken to be 1)

    Null deviance: 154.278  on 75  degrees of freedom
Residual deviance:  78.205  on 71  degrees of freedom
AIC: 770.59

Number of Fisher Scoring iterations: 1

              Theta:  3.637 
          Std. Err.:  0.590 

 2 x log-likelihood:  -758.589 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb1110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1110-1"><a href="#cb1110-1" aria-hidden="true" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(model2<span class="fl">.9</span><span class="sc">$</span>deviance, model2<span class="fl">.9</span><span class="sc">$</span>df.residual)</span>
<span id="cb1110-2"><a href="#cb1110-2" aria-hidden="true" tabindex="-1"></a>gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2608054</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1112-1"><a href="#cb1112-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The model still fits the data.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After removing all insignificant variables, the final model is a model that includes crude prevalence of cholesterol screening, crude prevalence of pap smear use, crude prevalence of colonoscopy-related tests (ages 50-75), and people per household. According to the goodness-of-fit test, this model fits the data, with a score of .261; this again suggests that the negative binomial model is clearly the best type of model for the data in question. Just like in the first set of models, I will create a table showing the true value behind each coefficient relative to the data using the same IQR/2 strategy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1113-1"><a href="#cb1113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model2keys<span class="sc">$</span>CHOLSCREEN_CrudePrev)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.662852</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1115-1"><a href="#cb1115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model2keys<span class="sc">$</span>PAPTEST_CrudePrev)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.93287</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1117-1"><a href="#cb1117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model2keys<span class="sc">$</span>COLON_SCREEN_CrudePrev)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.43715</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1119-1"><a href="#cb1119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model2keys<span class="sc">$</span>Average.Household.Size)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.15625</code></pre>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th style="text-align: center;">Coeff</th>
<th style="text-align: center;">Ratio (x+1)</th>
<th style="text-align: center;">IQR/2</th>
<th style="text-align: center;">Ratio (x+IQR/2)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Crude Prev. Cholesterol Screening</td>
<td style="text-align: center;">-.08431</td>
<td style="text-align: center;">.9191</td>
<td style="text-align: center;">1.662852</td>
<td style="text-align: center;">.8692</td>
</tr>
<tr class="even">
<td>Crude Prev. Pap Smear Use</td>
<td style="text-align: center;">-.0868</td>
<td style="text-align: center;">.9169</td>
<td style="text-align: center;">1.93287</td>
<td style="text-align: center;">.8455</td>
</tr>
<tr class="odd">
<td>Crude Prev. Colonoscopy-Related Tests</td>
<td style="text-align: center;">.04741</td>
<td style="text-align: center;">1.049</td>
<td style="text-align: center;">3.43715</td>
<td style="text-align: center;">1.177</td>
</tr>
<tr class="even">
<td>People Per Household</td>
<td style="text-align: center;">.85772</td>
<td style="text-align: center;">2.358</td>
<td style="text-align: center;">.15625</td>
<td style="text-align: center;">1.143</td>
</tr>
</tbody>
</table>
<p>According to the coefficients shown in the model summary, it would appear that people per household has the greatest effect on change in traffic congestion due to COVID. However, this coefficient is based on an increase of one person per household, which is over 6 times larger than the IQR of this variable. Adjusting for IQR/2 yields much different results; in fact, by this metric, crude prevalence of colonoscopy-related tests has the greatest effect on change in traffic congestion due to COVID.</p>
<p>Crude prevalence of cholesterol screening and crude prevalence of pap smear use both have negative coefficients, which suggests they have negative correlations with change in traffic congestion due to COVID after accounting for all other variables. The cholesterol coefficient makes sense because cholesterol problems can make people more susceptible to COVID (Chidambaram 2022) and thus less likely to travel during the pandemic. The pap smear coefficient also makes sense, but for the opposite reason; studies show that COVID can be a trigger for cervical cancer (Davies 2022), which influences women with COVID-like symptoms, who are less likely to drive due to said symptoms, to get tested. However, the coefficient for colonoscopy-related tests is positive, suggesting that cities with a higher rate of colonoscopy tests within the ages of 50-75 had their traffic congestion decrease less or even increase during COVID lockdown. This implies that colonoscopies and pap smear tests, both of which are done to determine potential problems (such as cancer) in each respective area, have opposing effects on change in traffic congestion due to COVID, which does not seem to make much sense. That is, until considering that each variable works in different age ranges; the colonoscopy variable works in ages 50-75, while the pap test variable works in ages 21-65. Since the pap test variable works for a greater proportion of the population (and includes the entirety of the prime driving age range), it will be more likely to affect city-wide factors such as traffic congestion, or, more specifically, change in traffic congestion due to COVID. Since the age range for the colonoscopy variable is relatively old, the tests will be more likely to show prevalence of cancer (as opposed to the pap test variable), since the risk of cancer generally increases with age (White 2014). This necessitates employment of more essential healthcare workers, which causes more people to drive during COVID lockdown, thus lessening the decrease (or strengthening the increase) of traffic congestion due to COVID.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1121-1"><a href="#cb1121-1" aria-hidden="true" tabindex="-1"></a>model3keys <span class="ot">&lt;-</span> citydataKeys[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span><span class="sc">:</span><span class="dv">34</span>, <span class="dv">36</span>, <span class="dv">40</span>, <span class="dv">43</span><span class="sc">:</span><span class="dv">48</span>)]</span>
<span id="cb1121-2"><a href="#cb1121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1121-3"><a href="#cb1121-3" aria-hidden="true" tabindex="-1"></a>model3<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(lastMile <span class="sc">~</span> ., <span class="at">family =</span> <span class="st">"poisson"</span>, <span class="at">data =</span> model3keys)</span>
<span id="cb1121-4"><a href="#cb1121-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = lastMile ~ ., family = "poisson", data = model3keys)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.2707  -0.5474  -0.2046   0.4721   2.3487  

Coefficients:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             2.855e+00  4.474e-01   6.382 1.75e-10 ***
Est2021                -2.172e-08  3.970e-08  -0.547    0.584    
density                -7.707e-05  5.687e-05  -1.355    0.175    
Average.Household.Size  1.417e-01  1.356e-01   1.045    0.296    
BINGE_CrudePrev        -1.559e-02  1.491e-02  -1.046    0.296    
popChange              -9.735e-03  3.384e-02  -0.288    0.774    
Median                  1.527e-07  1.872e-06   0.082    0.935    
Stdev                   5.514e-06  6.100e-06   0.904    0.366    
regionNortheast         4.964e-02  1.204e-01   0.412    0.680    
regionSouth            -7.271e-02  1.012e-01  -0.718    0.473    
regionWest             -3.330e-02  1.107e-01  -0.301    0.764    
vetpct                  7.575e-03  2.148e-02   0.353    0.724    
forpct                  2.999e-04  4.863e-03   0.062    0.951    
riderrate              -6.731e-04  1.234e-03  -0.545    0.586    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 78.471  on 72  degrees of freedom
Residual deviance: 48.284  on 59  degrees of freedom
  (3 observations deleted due to missingness)
AIC: 431.89

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1123-1"><a href="#cb1123-1" aria-hidden="true" tabindex="-1"></a>model3<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(model3<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=431.89
lastMile ~ Est2021 + density + Average.Household.Size + BINGE_CrudePrev + 
    popChange + Median + Stdev + region + vetpct + forpct + riderrate

                         Df Deviance    AIC
- region                  3   49.436 427.04
- forpct                  1   48.288 429.89
- Median                  1   48.291 429.89
- popChange               1   48.367 429.97
- vetpct                  1   48.409 430.01
- riderrate               1   48.583 430.19
- Est2021                 1   48.586 430.19
- Stdev                   1   49.102 430.70
- Average.Household.Size  1   49.371 430.97
- BINGE_CrudePrev         1   49.379 430.98
- density                 1   50.122 431.72
&lt;none&gt;                        48.284 431.89

Step:  AIC=427.04
lastMile ~ Est2021 + density + Average.Household.Size + BINGE_CrudePrev + 
    popChange + Median + Stdev + vetpct + forpct + riderrate

                         Df Deviance    AIC
- popChange               1   49.436 425.04
- Median                  1   49.445 425.05
- forpct                  1   49.469 425.07
- vetpct                  1   49.479 425.08
- Stdev                   1   49.870 425.47
- density                 1   50.202 425.80
- riderrate               1   50.218 425.82
- Est2021                 1   50.300 425.90
- BINGE_CrudePrev         1   50.347 425.95
- Average.Household.Size  1   50.738 426.34
&lt;none&gt;                        49.436 427.04

Step:  AIC=425.04
lastMile ~ Est2021 + density + Average.Household.Size + BINGE_CrudePrev + 
    Median + Stdev + vetpct + forpct + riderrate

                         Df Deviance    AIC
- Median                  1   49.445 423.05
- forpct                  1   49.470 423.07
- vetpct                  1   49.479 423.08
- Stdev                   1   49.871 423.47
- riderrate               1   50.234 423.84
- density                 1   50.291 423.89
- Est2021                 1   50.301 423.90
- BINGE_CrudePrev         1   50.349 423.95
- Average.Household.Size  1   50.739 424.34
&lt;none&gt;                        49.436 425.04

Step:  AIC=423.05
lastMile ~ Est2021 + density + Average.Household.Size + BINGE_CrudePrev + 
    Stdev + vetpct + forpct + riderrate

                         Df Deviance    AIC
- forpct                  1   49.471 421.07
- vetpct                  1   49.505 421.11
- Stdev                   1   50.053 421.66
- density                 1   50.292 421.90
- Est2021                 1   50.304 421.91
- BINGE_CrudePrev         1   50.386 421.99
- riderrate               1   50.396 422.00
- Average.Household.Size  1   50.757 422.36
&lt;none&gt;                        49.445 423.05

Step:  AIC=421.07
lastMile ~ Est2021 + density + Average.Household.Size + BINGE_CrudePrev + 
    Stdev + vetpct + riderrate

                         Df Deviance    AIC
- vetpct                  1   49.564 419.17
- Stdev                   1   50.053 419.66
- Est2021                 1   50.361 419.96
- BINGE_CrudePrev         1   50.390 419.99
- density                 1   50.412 420.01
- riderrate               1   50.484 420.09
- Average.Household.Size  1   51.059 420.66
&lt;none&gt;                        49.471 421.07

Step:  AIC=419.17
lastMile ~ Est2021 + density + Average.Household.Size + BINGE_CrudePrev + 
    Stdev + riderrate

                         Df Deviance    AIC
- Stdev                   1   50.174 417.78
- Est2021                 1   50.396 418.00
- riderrate               1   50.602 418.20
- BINGE_CrudePrev         1   50.604 418.21
- density                 1   50.792 418.39
- Average.Household.Size  1   51.060 418.66
&lt;none&gt;                        49.564 419.17

Step:  AIC=417.78
lastMile ~ Est2021 + density + Average.Household.Size + BINGE_CrudePrev + 
    riderrate

                         Df Deviance    AIC
- BINGE_CrudePrev         1   50.700 416.30
- riderrate               1   50.833 416.44
- Est2021                 1   50.855 416.46
- Average.Household.Size  1   51.527 417.13
- density                 1   51.550 417.15
&lt;none&gt;                        50.174 417.78

Step:  AIC=416.3
lastMile ~ Est2021 + density + Average.Household.Size + riderrate

                         Df Deviance    AIC
- Est2021                 1   51.346 414.95
- riderrate               1   51.447 415.05
- Average.Household.Size  1   52.281 415.88
- density                 1   52.300 415.90
&lt;none&gt;                        50.700 416.30

Step:  AIC=414.95
lastMile ~ density + Average.Household.Size + riderrate

                         Df Deviance    AIC
- riderrate               1   51.960 413.56
- Average.Household.Size  1   52.630 414.23
&lt;none&gt;                        51.346 414.95
- density                 1   54.416 416.02

Step:  AIC=413.56
lastMile ~ density + Average.Household.Size

                         Df Deviance    AIC
&lt;none&gt;                        51.960 413.56
- Average.Household.Size  1   54.069 413.67
- density                 1   75.761 435.36</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1125-1"><a href="#cb1125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = lastMile ~ density + Average.Household.Size, family = "poisson", 
    data = model3keys)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.44140  -0.60448  -0.09394   0.50976   2.55250  

Coefficients:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             2.876e+00  2.293e-01  12.542  &lt; 2e-16 ***
density                -8.444e-05  1.842e-05  -4.585 4.54e-06 ***
Average.Household.Size  1.288e-01  8.807e-02   1.462    0.144    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 78.471  on 72  degrees of freedom
Residual deviance: 51.960  on 70  degrees of freedom
  (3 observations deleted due to missingness)
AIC: 413.56

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1127-1"><a href="#cb1127-1" aria-hidden="true" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(model3<span class="fl">.2</span><span class="sc">$</span>deviance, model3<span class="fl">.2</span><span class="sc">$</span>df.residual)</span>
<span id="cb1127-2"><a href="#cb1127-2" aria-hidden="true" tabindex="-1"></a>gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9475985</code></pre>
</div>
</div>
<p>The third model, which uses last-mile speed as the response variable, is by far the easiest to explain, with only two variables, both of which were heavily considered as significant variables in the EDA. Unlike the first two models, simply using Poisson regression is enough for the model to pass the goodness-of-fit test, meaning that a dispersion parameter is not required. Even so, the coefficients are interpreted in the same way as in the negative binomial model, which was explained in the first model analysis. Here is the IQR/2 table for Model 3:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1129-1"><a href="#cb1129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model1keys<span class="sc">$</span>density)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 504.625</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1131-1"><a href="#cb1131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model1keys<span class="sc">$</span>Average.Household.Size)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.15625</code></pre>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th style="text-align: center;">Coeff</th>
<th style="text-align: center;">Ratio (x+1)</th>
<th style="text-align: center;">IQR/2</th>
<th style="text-align: center;">Ratio (x+IQR/2)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Population Density</td>
<td style="text-align: center;">-8.444*10<sup>-5</sup></td>
<td style="text-align: center;">.9999156</td>
<td style="text-align: center;">504.625</td>
<td style="text-align: center;">.9583</td>
</tr>
<tr class="even">
<td>People Per Household</td>
<td style="text-align: center;">1.288*10<sup>-1</sup></td>
<td style="text-align: center;">1.137</td>
<td style="text-align: center;">.15625</td>
<td style="text-align: center;">1.020</td>
</tr>
</tbody>
</table>
<p>According to the resulting ratios, population density has the greatest effect on last-mile speed, although the effect is not as great as, for example, binge drinking on hours lost due to traffic. Even so, the negative correlation between population density and last-mile speed makes sense because denser cities have more congested city centers, compared to less dense cities, in which traffic congestion is more spread out throughout the entirety of the city. The people per household coefficient (positive) also makes sense because households with more people tend to have more people traveling in the same car, which helps with reducing traffic congestion. Another notable thing about this model is the fact that, unlike the first model, it uses population density instead of population total; this suggests that while total population is better at explaining city-wide traffic congestion, population density is better for explaining city-center congestion.</p>
<p>The final model intends to use highway fatality rate as the response variable, but since highway fatality rate uses decimal numbers, the amount of options for model types would be limited. So, the model will use total fatalities as the response variable and include total population as an offset term. Offset terms are mainly used for situations in which there exists a response variable that is known to be related to the response variable prior to any analysis; in general, total population (or log(total population)) is one of the most common offset terms.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1133-1"><a href="#cb1133-1" aria-hidden="true" tabindex="-1"></a>model4keys <span class="ot">&lt;-</span> statedata[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">23</span>, <span class="dv">26</span><span class="sc">:</span><span class="dv">27</span>, <span class="dv">29</span><span class="sc">:</span><span class="dv">37</span>, <span class="dv">43</span>, <span class="dv">45</span>, <span class="dv">51</span><span class="sc">:</span><span class="dv">54</span>, <span class="dv">56</span><span class="sc">:</span><span class="dv">59</span>, <span class="dv">61</span>)]</span>
<span id="cb1133-2"><a href="#cb1133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1133-3"><a href="#cb1133-3" aria-hidden="true" tabindex="-1"></a>model4<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(Fatalities <span class="sc">~</span> . <span class="sc">-</span>Total.population <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(Total.population)), <span class="at">family =</span> <span class="st">"poisson"</span>, model4keys)</span>
<span id="cb1133-4"><a href="#cb1133-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model4<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Fatalities ~ . - Total.population + offset(log(Total.population)), 
    family = "poisson", data = model4keys)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-5.3282  -1.5579  -0.0959   1.6255   7.0141  

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -5.506e+00  5.365e-01 -10.262  &lt; 2e-16 ***
ruralLimit                 2.946e-03  2.898e-03   1.017 0.309312    
urbanLimit                -1.279e-03  1.404e-03  -0.911 0.362424    
sqmi                       3.232e-07  1.279e-07   2.527 0.011512 *  
density                   -1.342e-04  5.401e-05  -2.485 0.012951 *  
regionNortheast           -1.022e-01  3.594e-02  -2.843 0.004463 ** 
regionSouth                1.091e-01  2.495e-02   4.372 1.23e-05 ***
regionWest                 1.460e-01  2.544e-02   5.741 9.43e-09 ***
alcoholConsumptionGallons -4.415e-02  1.964e-02  -2.247 0.024610 *  
X2021                     -4.532e-06  1.191e-06  -3.805 0.000142 ***
adjTransit                -2.831e-03  7.572e-04  -3.739 0.000185 ***
adjGas                     1.182e-02  2.796e-03   4.228 2.36e-05 ***
adjMiles                   5.679e-01  9.521e-02   5.964 2.46e-09 ***
licpct                    -3.663e-01  1.847e-01  -1.983 0.047354 *  
vehPerPerson              -1.880e-01  6.668e-02  -2.819 0.004824 ** 
prisonpct                  2.805e-04  5.699e-05   4.921 8.59e-07 ***
whitepct                  -1.480e-01  1.033e-01  -1.433 0.151871    
primepct                  -4.607e+00  5.655e-01  -8.148 3.70e-16 ***
incomeGrowth               8.989e-03  1.641e-03   5.476 4.34e-08 ***
popGrowth                  6.146e-03  1.007e-02   0.610 0.541752    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 4832.79  on 49  degrees of freedom
Residual deviance:  311.02  on 30  degrees of freedom
AIC: 751.21

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1135-1"><a href="#cb1135-1" aria-hidden="true" tabindex="-1"></a>model4<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(model4<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=751.21
Fatalities ~ (ruralLimit + urbanLimit + Total.population + sqmi + 
    density + region + alcoholConsumptionGallons + X2021 + adjTransit + 
    adjGas + adjMiles + licpct + vehPerPerson + prisonpct + whitepct + 
    primepct + incomeGrowth + popGrowth) - Total.population + 
    offset(log(Total.population))

                            Df Deviance    AIC
- popGrowth                  1   311.39 749.58
- urbanLimit                 1   311.85 750.04
- ruralLimit                 1   312.05 750.24
&lt;none&gt;                           311.02 751.21
- whitepct                   1   313.06 751.25
- licpct                     1   314.95 753.13
- alcoholConsumptionGallons  1   316.11 754.30
- density                    1   317.21 755.39
- sqmi                       1   317.34 755.52
- vehPerPerson               1   319.07 757.26
- adjTransit                 1   325.03 763.22
- X2021                      1   325.54 763.72
- adjGas                     1   328.92 767.11
- prisonpct                  1   335.26 773.45
- incomeGrowth               1   340.73 778.91
- adjMiles                   1   346.00 784.19
- region                     3   361.18 795.37
- primepct                   1   377.64 815.83

Step:  AIC=749.58
Fatalities ~ ruralLimit + urbanLimit + sqmi + density + region + 
    alcoholConsumptionGallons + X2021 + adjTransit + adjGas + 
    adjMiles + licpct + vehPerPerson + prisonpct + whitepct + 
    primepct + incomeGrowth + offset(log(Total.population))

                            Df Deviance    AIC
- urbanLimit                 1   312.25 748.44
- whitepct                   1   313.06 749.25
- ruralLimit                 1   313.14 749.33
&lt;none&gt;                           311.39 749.58
- licpct                     1   315.01 751.20
- alcoholConsumptionGallons  1   316.40 752.58
- density                    1   317.24 753.42
- sqmi                       1   318.97 755.16
- vehPerPerson               1   320.37 756.56
- X2021                      1   326.24 762.43
- adjTransit                 1   326.51 762.70
- adjGas                     1   329.91 766.10
- prisonpct                  1   335.65 771.83
- incomeGrowth               1   341.59 777.78
- adjMiles                   1   346.10 782.29
- primepct                   1   378.34 814.52
- region                     3   382.96 815.15

Step:  AIC=748.44
Fatalities ~ ruralLimit + sqmi + density + region + alcoholConsumptionGallons + 
    X2021 + adjTransit + adjGas + adjMiles + licpct + vehPerPerson + 
    prisonpct + whitepct + primepct + incomeGrowth + offset(log(Total.population))

                            Df Deviance    AIC
- ruralLimit                 1   313.31 747.50
- whitepct                   1   313.69 747.87
&lt;none&gt;                           312.25 748.44
- licpct                     1   316.26 750.45
- alcoholConsumptionGallons  1   317.28 751.47
- density                    1   317.37 751.56
- sqmi                       1   319.29 753.47
- vehPerPerson               1   320.51 754.69
- X2021                      1   326.64 760.83
- adjTransit                 1   327.01 761.19
- adjGas                     1   330.07 764.26
- prisonpct                  1   339.93 774.12
- incomeGrowth               1   342.36 776.55
- adjMiles                   1   348.46 782.65
- region                     3   383.69 813.88
- primepct                   1   380.23 814.41

Step:  AIC=747.5
Fatalities ~ sqmi + density + region + alcoholConsumptionGallons + 
    X2021 + adjTransit + adjGas + adjMiles + licpct + vehPerPerson + 
    prisonpct + whitepct + primepct + incomeGrowth + offset(log(Total.population))

                            Df Deviance    AIC
- whitepct                   1   314.61 746.80
&lt;none&gt;                           313.31 747.50
- licpct                     1   317.09 749.28
- alcoholConsumptionGallons  1   317.97 750.16
- density                    1   319.68 751.87
- vehPerPerson               1   321.48 753.67
- sqmi                       1   322.34 754.53
- X2021                      1   327.26 759.45
- adjTransit                 1   330.39 762.58
- adjGas                     1   330.90 763.09
- prisonpct                  1   347.31 779.50
- incomeGrowth               1   347.32 779.51
- adjMiles                   1   349.14 781.32
- region                     3   383.98 812.17
- primepct                   1   380.29 812.48

Step:  AIC=746.8
Fatalities ~ sqmi + density + region + alcoholConsumptionGallons + 
    X2021 + adjTransit + adjGas + adjMiles + licpct + vehPerPerson + 
    prisonpct + primepct + incomeGrowth + offset(log(Total.population))

                            Df Deviance    AIC
&lt;none&gt;                           314.61 746.80
- licpct                     1   317.52 747.70
- alcoholConsumptionGallons  1   318.58 748.77
- density                    1   319.69 749.88
- sqmi                       1   324.22 754.40
- vehPerPerson               1   327.49 757.68
- X2021                      1   329.41 759.60
- adjTransit                 1   331.01 761.20
- adjGas                     1   332.75 762.94
- adjMiles                   1   350.16 780.35
- incomeGrowth               1   350.81 780.99
- prisonpct                  1   350.81 781.00
- primepct                   1   381.59 811.78
- region                     3   440.23 866.42</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1137-1"><a href="#cb1137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model4<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Fatalities ~ sqmi + density + region + alcoholConsumptionGallons + 
    X2021 + adjTransit + adjGas + adjMiles + licpct + vehPerPerson + 
    prisonpct + primepct + incomeGrowth + offset(log(Total.population)), 
    family = "poisson", data = model4keys)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-5.3326  -1.8159  -0.1421   1.7246   7.2699  

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -5.714e+00  4.653e-01 -12.282  &lt; 2e-16 ***
sqmi                       3.688e-07  1.186e-07   3.110 0.001868 ** 
density                   -1.031e-04  4.588e-05  -2.247 0.024608 *  
regionNortheast           -1.229e-01  3.197e-02  -3.845 0.000120 ***
regionSouth                1.187e-01  1.834e-02   6.471 9.71e-11 ***
regionWest                 1.606e-01  2.262e-02   7.100 1.24e-12 ***
alcoholConsumptionGallons -3.828e-02  1.928e-02  -1.986 0.047050 *  
X2021                     -4.533e-06  1.180e-06  -3.842 0.000122 ***
adjTransit                -2.647e-03  6.548e-04  -4.042 5.29e-05 ***
adjGas                     1.173e-02  2.756e-03   4.258 2.06e-05 ***
adjMiles                   5.674e-01  9.443e-02   6.009 1.87e-09 ***
licpct                    -2.968e-01  1.742e-01  -1.704 0.088437 .  
vehPerPerson              -2.120e-01  5.956e-02  -3.560 0.000371 ***
prisonpct                  3.074e-04  5.104e-05   6.021 1.73e-09 ***
primepct                  -4.417e+00  5.412e-01  -8.162 3.31e-16 ***
incomeGrowth               9.589e-03  1.588e-03   6.040 1.55e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 4832.79  on 49  degrees of freedom
Residual deviance:  314.61  on 34  degrees of freedom
AIC: 746.8

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1139-1"><a href="#cb1139-1" aria-hidden="true" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(model4<span class="fl">.2</span><span class="sc">$</span>deviance, model4<span class="fl">.2</span><span class="sc">$</span>df.residual)</span>
<span id="cb1139-2"><a href="#cb1139-2" aria-hidden="true" tabindex="-1"></a>gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1141-1"><a href="#cb1141-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Clearly starting with all terms and using stepAIC does not work. Let's try including the variables highlighted in the EDA.</span></span>
<span id="cb1141-2"><a href="#cb1141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1141-3"><a href="#cb1141-3" aria-hidden="true" tabindex="-1"></a>model4<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(Fatalities <span class="sc">~</span> adjGas <span class="sc">+</span> adjMiles <span class="sc">+</span> X2021 <span class="sc">+</span> prisonpct <span class="sc">+</span> adjTransit <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(Total.population)), <span class="at">family =</span> <span class="st">"poisson"</span>, model4keys)</span>
<span id="cb1141-4"><a href="#cb1141-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model4<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Fatalities ~ adjGas + adjMiles + X2021 + prisonpct + 
    adjTransit + offset(log(Total.population)), family = "poisson", 
    data = model4keys)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-6.8610  -2.3873  -0.2446   1.7427  11.4581  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -9.446e+00  1.004e-01 -94.075  &lt; 2e-16 ***
adjGas      -6.121e-03  1.782e-03  -3.435 0.000593 ***
adjMiles     9.730e-01  6.618e-02  14.701  &lt; 2e-16 ***
X2021       -7.290e-06  7.759e-07  -9.395  &lt; 2e-16 ***
prisonpct    5.164e-04  3.919e-05  13.176  &lt; 2e-16 ***
adjTransit  -4.478e-03  4.865e-04  -9.204  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 4832.79  on 49  degrees of freedom
Residual deviance:  589.69  on 44  degrees of freedom
AIC: 1001.9

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1143-1"><a href="#cb1143-1" aria-hidden="true" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(model4<span class="fl">.3</span><span class="sc">$</span>deviance, model4<span class="fl">.3</span><span class="sc">$</span>df.residual)</span>
<span id="cb1143-2"><a href="#cb1143-2" aria-hidden="true" tabindex="-1"></a>gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1145-1"><a href="#cb1145-1" aria-hidden="true" tabindex="-1"></a>make_bins4 <span class="ot">&lt;-</span> <span class="cf">function</span>(var){</span>
<span id="cb1145-2"><a href="#cb1145-2" aria-hidden="true" tabindex="-1"></a>  model4keys <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">var_bin =</span> <span class="fu">bin_function</span>(var)) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(var_bin) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean_counts =</span> <span class="fu">mean</span>(Fatalities), <span class="at">var_counts =</span> <span class="fu">var</span>(Fatalities))</span>
<span id="cb1145-3"><a href="#cb1145-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1145-4"><a href="#cb1145-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1145-5"><a href="#cb1145-5" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins4</span>(model4keys<span class="sc">$</span>Total.population)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  var_bin    mean_counts var_counts
  &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;
1 16128125.8       1159.    119652.
2 23903868.2       2188.   2610612.
3 31679610.6       3874         NA 
4 39455353         3847         NA 
5 8352383.4         458.    109853.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1147-1"><a href="#cb1147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins4</span>(model4keys<span class="sc">$</span>adjGas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  var_bin          mean_counts var_counts
  &lt;chr&gt;                  &lt;dbl&gt;      &lt;dbl&gt;
1 28.2876392487003        399.    313714.
2 34.6615641523123        793.    944661.
3 41.0354890559243        799.    605774.
4 47.4094139595363        848.    995759.
5 53.7833388631483        609     172549 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb1149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1149-1"><a href="#cb1149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins4</span>(model4keys<span class="sc">$</span>adjMiles)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  var_bin           mean_counts var_counts
  &lt;chr&gt;                   &lt;dbl&gt;      &lt;dbl&gt;
1 0.745610785931439        591.    238490.
2 0.983941677931567        871.   1285996.
3 1.22227256993169         757.    239444.
4 1.46060346193182         843      16562 
5 1.69893435393195         127         NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb1151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1151-1"><a href="#cb1151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins4</span>(model4keys<span class="sc">$</span>X2021)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  var_bin mean_counts var_counts
  &lt;chr&gt;         &lt;dbl&gt;      &lt;dbl&gt;
1 56776          567      50799 
2 66915         1158.    599167.
3 77054          648     892415.
4 87193          767.   1154990.
5 97332          418.     47170.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1153-1"><a href="#cb1153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins4</span>(model4keys<span class="sc">$</span>prisonpct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  var_bin          mean_counts var_counts
  &lt;chr&gt;                  &lt;dbl&gt;      &lt;dbl&gt;
1 1100.12179682195        625.     62077.
2 371.67027423928         291      88856.
3 553.783154884947        816.   1130674.
4 735.896035530613        884.    584614.
5 918.00891617628        1298.   1500723.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1155-1"><a href="#cb1155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_bins4</span>(model4keys<span class="sc">$</span>adjTransit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  var_bin          mean_counts var_counts
  &lt;chr&gt;                  &lt;dbl&gt;      &lt;dbl&gt;
1 18.7570693896514        725.    616180.
2 36.538459351596        1095.   1635922.
3 54.3198493135406        343         NA 
4 89.8826292374298       1046         NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb1157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1157-1"><a href="#cb1157-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Clearly, a dispersion parameter would help.</span></span>
<span id="cb1157-2"><a href="#cb1157-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1157-3"><a href="#cb1157-3" aria-hidden="true" tabindex="-1"></a>model4<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(Fatalities <span class="sc">~</span> adjGas <span class="sc">+</span> adjMiles <span class="sc">+</span> X2021 <span class="sc">+</span> prisonpct <span class="sc">+</span> adjTransit <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(Total.population)), <span class="at">family =</span> <span class="st">"quasipoisson"</span>, model4keys)</span>
<span id="cb1157-4"><a href="#cb1157-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model4<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Fatalities ~ adjGas + adjMiles + X2021 + prisonpct + 
    adjTransit + offset(log(Total.population)), family = "quasipoisson", 
    data = model4keys)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-6.8610  -2.3873  -0.2446   1.7427  11.4581  

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -9.446e+00  3.714e-01 -25.433  &lt; 2e-16 ***
adjGas      -6.121e-03  6.591e-03  -0.929 0.358147    
adjMiles     9.730e-01  2.448e-01   3.974 0.000259 ***
X2021       -7.290e-06  2.870e-06  -2.540 0.014689 *  
prisonpct    5.164e-04  1.450e-04   3.562 0.000899 ***
adjTransit  -4.478e-03  1.800e-03  -2.488 0.016690 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for quasipoisson family taken to be 13.68178)

    Null deviance: 4832.79  on 49  degrees of freedom
Residual deviance:  589.69  on 44  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1159-1"><a href="#cb1159-1" aria-hidden="true" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(model4<span class="fl">.4</span><span class="sc">$</span>deviance, model4<span class="fl">.4</span><span class="sc">$</span>df.residual)</span>
<span id="cb1159-2"><a href="#cb1159-2" aria-hidden="true" tabindex="-1"></a>gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1161-1"><a href="#cb1161-1" aria-hidden="true" tabindex="-1"></a>model4<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(Fatalities <span class="sc">~</span> adjMiles <span class="sc">+</span> X2021 <span class="sc">+</span> prisonpct <span class="sc">+</span> adjTransit <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(Total.population)), <span class="at">family =</span> <span class="st">"quasipoisson"</span>, model4keys)</span>
<span id="cb1161-2"><a href="#cb1161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model4<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Fatalities ~ adjMiles + X2021 + prisonpct + adjTransit + 
    offset(log(Total.population)), family = "quasipoisson", data = model4keys)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-6.9669  -2.1700  -0.5607   1.8740  10.6044  

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -9.501e+00  3.663e-01 -25.940  &lt; 2e-16 ***
adjMiles     8.133e-01  1.744e-01   4.664 2.79e-05 ***
X2021       -7.385e-06  2.863e-06  -2.580  0.01322 *  
prisonpct    4.803e-04  1.390e-04   3.454  0.00121 ** 
adjTransit  -4.095e-03  1.738e-03  -2.356  0.02289 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for quasipoisson family taken to be 13.56982)

    Null deviance: 4832.8  on 49  degrees of freedom
Residual deviance:  601.5  on 45  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1163-1"><a href="#cb1163-1" aria-hidden="true" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(model4<span class="fl">.5</span><span class="sc">$</span>deviance, model4<span class="fl">.5</span><span class="sc">$</span>df.residual)</span>
<span id="cb1163-2"><a href="#cb1163-2" aria-hidden="true" tabindex="-1"></a>gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1165-1"><a href="#cb1165-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Quasi-poisson does not work.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When simply fitting a Poisson regression model, neither strategy for finding variables yields a model that fits the data, indicating that a dispersion parameter must be added. This presumption is proven by the mean-variance tables for each variable; the variances are almost always far higher than the means for each group. With a dispersion parameter of over 13, the quasi-poisson model appears to be valuable, but, just like in the first and second models, this model does not fit the data. Again, the last resort is a negative binomial model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1166-1"><a href="#cb1166-1" aria-hidden="true" tabindex="-1"></a>model4<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(Fatalities <span class="sc">~</span> . <span class="sc">-</span>Total.population <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(Total.population)), model4keys)</span>
<span id="cb1166-2"><a href="#cb1166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model4<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm.nb(formula = Fatalities ~ . - Total.population + offset(log(Total.population)), 
    data = model4keys, init.theta = 110.4242817, link = log)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1930  -0.5752  -0.0061   0.6854   2.2072  

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -6.169e+00  1.335e+00  -4.621 3.82e-06 ***
ruralLimit                 8.131e-03  6.566e-03   1.238   0.2156    
urbanLimit                -8.185e-04  3.387e-03  -0.242   0.8090    
sqmi                       3.555e-07  2.859e-07   1.243   0.2137    
density                   -1.232e-05  1.208e-04  -0.102   0.9188    
regionNortheast           -1.382e-01  8.230e-02  -1.680   0.0930 .  
regionSouth                1.118e-01  6.542e-02   1.708   0.0876 .  
regionWest                 1.415e-01  7.005e-02   2.020   0.0434 *  
alcoholConsumptionGallons -6.092e-02  4.238e-02  -1.438   0.1505    
X2021                     -3.824e-06  2.964e-06  -1.290   0.1970    
adjTransit                -1.441e-03  1.887e-03  -0.764   0.4450    
adjGas                     1.803e-02  7.540e-03   2.392   0.0168 *  
adjMiles                   4.524e-01  2.146e-01   2.108   0.0350 *  
licpct                    -9.395e-02  4.639e-01  -0.203   0.8395    
vehPerPerson              -1.373e-01  1.370e-01  -1.002   0.3161    
prisonpct                  3.326e-04  1.398e-04   2.378   0.0174 *  
whitepct                   7.085e-02  2.288e-01   0.310   0.7568    
primepct                  -5.005e+00  1.576e+00  -3.175   0.0015 ** 
incomeGrowth               9.822e-03  4.199e-03   2.339   0.0193 *  
popGrowth                 -7.895e-03  2.812e-02  -0.281   0.7789    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Negative Binomial(110.4243) family taken to be 1)

    Null deviance: 624.440  on 49  degrees of freedom
Residual deviance:  46.926  on 30  degrees of freedom
AIC: 576.91

Number of Fisher Scoring iterations: 1

              Theta:  110.4 
          Std. Err.:  27.1 

 2 x log-likelihood:  -534.908 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb1168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1168-1"><a href="#cb1168-1" aria-hidden="true" tabindex="-1"></a>model4<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(model4<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=574.91
Fatalities ~ (ruralLimit + urbanLimit + Total.population + sqmi + 
    density + region + alcoholConsumptionGallons + X2021 + adjTransit + 
    adjGas + adjMiles + licpct + vehPerPerson + prisonpct + whitepct + 
    primepct + incomeGrowth + popGrowth) - Total.population + 
    offset(log(Total.population))

                            Df    AIC
- density                    1 572.92
- licpct                     1 572.95
- urbanLimit                 1 572.97
- popGrowth                  1 572.99
- whitepct                   1 573.00
- adjTransit                 1 573.48
- vehPerPerson               1 573.92
- sqmi                       1 574.41
- ruralLimit                 1 574.44
- X2021                      1 574.56
&lt;none&gt;                         574.91
- alcoholConsumptionGallons  1 574.91
- region                     3 576.97
- adjMiles                   1 577.18
- incomeGrowth               1 578.00
- prisonpct                  1 578.32
- adjGas                     1 578.38
- primepct                   1 582.13

Step:  AIC=572.92
Fatalities ~ ruralLimit + urbanLimit + sqmi + region + alcoholConsumptionGallons + 
    X2021 + adjTransit + adjGas + adjMiles + licpct + vehPerPerson + 
    prisonpct + whitepct + primepct + incomeGrowth + popGrowth + 
    offset(log(Total.population))

                            Df    AIC
- licpct                     1 570.96
- urbanLimit                 1 570.97
- popGrowth                  1 571.01
- whitepct                   1 571.08
- adjTransit                 1 571.48
- vehPerPerson               1 571.97
- ruralLimit                 1 572.46
- sqmi                       1 572.49
- X2021                      1 572.72
&lt;none&gt;                         572.92
- alcoholConsumptionGallons  1 572.92
- adjMiles                   1 575.34
- prisonpct                  1 576.32
- incomeGrowth               1 576.59
- adjGas                     1 576.84
- region                     3 579.12
- primepct                   1 580.15

Step:  AIC=570.96
Fatalities ~ ruralLimit + urbanLimit + sqmi + region + alcoholConsumptionGallons + 
    X2021 + adjTransit + adjGas + adjMiles + vehPerPerson + prisonpct + 
    whitepct + primepct + incomeGrowth + popGrowth + offset(log(Total.population))

                            Df    AIC
- urbanLimit                 1 569.00
- popGrowth                  1 569.07
- whitepct                   1 569.15
- adjTransit                 1 569.50
- vehPerPerson               1 570.00
- ruralLimit                 1 570.47
- sqmi                       1 570.52
&lt;none&gt;                         570.96
- alcoholConsumptionGallons  1 571.05
- X2021                      1 571.19
- adjMiles                   1 573.35
- prisonpct                  1 574.40
- incomeGrowth               1 574.59
- adjGas                     1 574.94
- region                     3 577.19
- primepct                   1 579.61

Step:  AIC=569
Fatalities ~ ruralLimit + sqmi + region + alcoholConsumptionGallons + 
    X2021 + adjTransit + adjGas + adjMiles + vehPerPerson + prisonpct + 
    whitepct + primepct + incomeGrowth + popGrowth + offset(log(Total.population))

                            Df    AIC
- popGrowth                  1 567.11
- whitepct                   1 567.21
- adjTransit                 1 567.61
- vehPerPerson               1 568.00
- sqmi                       1 568.52
- ruralLimit                 1 568.79
&lt;none&gt;                         569.00
- alcoholConsumptionGallons  1 569.12
- X2021                      1 569.32
- adjMiles                   1 571.36
- prisonpct                  1 572.59
- incomeGrowth               1 572.60
- adjGas                     1 573.03
- region                     3 575.28
- primepct                   1 577.61

Step:  AIC=567.11
Fatalities ~ ruralLimit + sqmi + region + alcoholConsumptionGallons + 
    X2021 + adjTransit + adjGas + adjMiles + vehPerPerson + prisonpct + 
    whitepct + primepct + incomeGrowth + offset(log(Total.population))

                            Df    AIC
- whitepct                   1 565.25
- adjTransit                 1 565.62
- vehPerPerson               1 566.06
- sqmi                       1 566.64
- ruralLimit                 1 566.79
&lt;none&gt;                         567.11
- alcoholConsumptionGallons  1 567.30
- X2021                      1 567.44
- adjMiles                   1 570.08
- incomeGrowth               1 570.60
- adjGas                     1 571.11
- prisonpct                  1 571.30
- region                     3 574.93
- primepct                   1 575.68

Step:  AIC=565.25
Fatalities ~ ruralLimit + sqmi + region + alcoholConsumptionGallons + 
    X2021 + adjTransit + adjGas + adjMiles + vehPerPerson + prisonpct + 
    primepct + incomeGrowth + offset(log(Total.population))

                            Df    AIC
- vehPerPerson               1 564.06
- adjTransit                 1 564.08
- sqmi                       1 564.72
- ruralLimit                 1 565.05
&lt;none&gt;                         565.25
- X2021                      1 565.69
- alcoholConsumptionGallons  1 565.72
- adjMiles                   1 568.16
- incomeGrowth               1 568.63
- adjGas                     1 569.27
- prisonpct                  1 569.35
- primepct                   1 573.89
- region                     3 575.18

Step:  AIC=564.06
Fatalities ~ ruralLimit + sqmi + region + alcoholConsumptionGallons + 
    X2021 + adjTransit + adjGas + adjMiles + prisonpct + primepct + 
    incomeGrowth + offset(log(Total.population))

                            Df    AIC
- adjTransit                 1 562.86
- sqmi                       1 563.08
- ruralLimit                 1 563.51
&lt;none&gt;                         564.06
- alcoholConsumptionGallons  1 564.94
- X2021                      1 565.04
- adjMiles                   1 566.51
- incomeGrowth               1 567.10
- adjGas                     1 567.44
- prisonpct                  1 568.36
- primepct                   1 572.09
- region                     3 573.18

Step:  AIC=562.86
Fatalities ~ ruralLimit + sqmi + region + alcoholConsumptionGallons + 
    X2021 + adjGas + adjMiles + prisonpct + primepct + incomeGrowth + 
    offset(log(Total.population))

                            Df    AIC
- sqmi                       1 562.14
- ruralLimit                 1 562.64
&lt;none&gt;                         562.86
- X2021                      1 563.23
- alcoholConsumptionGallons  1 563.73
- adjMiles                   1 565.39
- incomeGrowth               1 565.59
- prisonpct                  1 567.74
- adjGas                     1 568.45
- primepct                   1 572.75
- region                     3 573.36

Step:  AIC=562.14
Fatalities ~ ruralLimit + region + alcoholConsumptionGallons + 
    X2021 + adjGas + adjMiles + prisonpct + primepct + incomeGrowth + 
    offset(log(Total.population))

                            Df    AIC
- ruralLimit                 1 561.72
&lt;none&gt;                         562.14
- alcoholConsumptionGallons  1 562.23
- X2021                      1 563.20
- adjMiles                   1 563.97
- incomeGrowth               1 565.23
- prisonpct                  1 567.88
- adjGas                     1 567.92
- primepct                   1 571.01
- region                     3 574.32

Step:  AIC=561.72
Fatalities ~ region + alcoholConsumptionGallons + X2021 + adjGas + 
    adjMiles + prisonpct + primepct + incomeGrowth + offset(log(Total.population))

                            Df    AIC
&lt;none&gt;                         561.72
- alcoholConsumptionGallons  1 561.77
- X2021                      1 562.71
- adjMiles                   1 563.19
- incomeGrowth               1 567.15
- adjGas                     1 569.13
- primepct                   1 569.74
- prisonpct                  1 569.82
- region                     3 575.11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1170-1"><a href="#cb1170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model4<span class="fl">.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm.nb(formula = Fatalities ~ region + alcoholConsumptionGallons + 
    X2021 + adjGas + adjMiles + prisonpct + primepct + incomeGrowth + 
    offset(log(Total.population)), data = model4keys, init.theta = 99.20913967, 
    link = log)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.39924  -0.53921   0.05646   0.61397   2.07162  

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -6.764e+00  9.237e-01  -7.323 2.43e-13 ***
regionNortheast           -1.624e-01  5.986e-02  -2.713 0.006676 ** 
regionSouth                6.550e-02  5.143e-02   1.274 0.202823    
regionWest                 1.429e-01  5.385e-02   2.654 0.007963 ** 
alcoholConsumptionGallons -5.885e-02  4.071e-02  -1.446 0.148297    
X2021                     -4.553e-06  2.599e-06  -1.752 0.079832 .  
adjGas                     2.020e-02  6.338e-03   3.188 0.001433 ** 
adjMiles                   3.856e-01  2.044e-01   1.886 0.059263 .  
prisonpct                  4.393e-04  1.321e-04   3.326 0.000882 ***
primepct                  -3.847e+00  1.163e+00  -3.307 0.000944 ***
incomeGrowth               1.091e-02  3.836e-03   2.845 0.004437 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Negative Binomial(99.2091) family taken to be 1)

    Null deviance: 572.772  on 49  degrees of freedom
Residual deviance:  47.574  on 39  degrees of freedom
AIC: 563.72

Number of Fisher Scoring iterations: 1

              Theta:  99.2 
          Std. Err.:  24.0 

 2 x log-likelihood:  -539.724 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb1172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1172-1"><a href="#cb1172-1" aria-hidden="true" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(model4<span class="fl">.7</span><span class="sc">$</span>deviance, model4<span class="fl">.7</span><span class="sc">$</span>df.residual)</span>
<span id="cb1172-2"><a href="#cb1172-2" aria-hidden="true" tabindex="-1"></a>gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1630885</code></pre>
</div>
</div>
<p>Using backwards regression on the negative binomial model yields a model with 8 variables that fits the data relatively well. The variables included are region, alcohol consumption in gallons per capita per year, median income, gas used in gallons per person per year, miles driven per person per year, percentage of people in prison, percentage (values 0 to 1) of people in prime driving age (25-64), and change in median income from 2020 to 2021.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1174-1"><a href="#cb1174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model4keys<span class="sc">$</span>alcoholConsumptionGallons)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3225</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1176-1"><a href="#cb1176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model4keys<span class="sc">$</span>X2021)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8829.125</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1178-1"><a href="#cb1178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model4keys<span class="sc">$</span>adjGas)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.31136</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1180-1"><a href="#cb1180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model4keys<span class="sc">$</span>adjMiles)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1172371</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1182-1"><a href="#cb1182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model4keys<span class="sc">$</span>prisonpct)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 146.3768</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1184-1"><a href="#cb1184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model4keys<span class="sc">$</span>primepct)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.008957902</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1186-1"><a href="#cb1186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iqr</span>(model4keys<span class="sc">$</span>incomeGrowth)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.203699</code></pre>
</div>
</div>
<p>Once again, my IQR/2 strategy will be used to determine the effect of each variable relative to the data. Here is the table containing the results (with the exception of region, which is non-numeric):</p>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th style="text-align: center;">Coeff</th>
<th style="text-align: center;">Ratio (x+1)</th>
<th style="text-align: center;">IQR/2</th>
<th style="text-align: center;">Ratio (x+IQR/2)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Alcohol Consumption</td>
<td style="text-align: center;">-5.885*10<sup>-2</sup></td>
<td style="text-align: center;">.9428</td>
<td style="text-align: center;">.3225</td>
<td style="text-align: center;">.9812</td>
</tr>
<tr class="even">
<td>Median Income</td>
<td style="text-align: center;">-4.553*10<sup>-6</sup></td>
<td style="text-align: center;">.99999545</td>
<td style="text-align: center;">8829.125</td>
<td style="text-align: center;">.9606</td>
</tr>
<tr class="odd">
<td>Gas Used Per Person</td>
<td style="text-align: center;">2.020*10<sup>-2</sup></td>
<td style="text-align: center;">1.020</td>
<td style="text-align: center;">4.31136</td>
<td style="text-align: center;">1.091</td>
</tr>
<tr class="even">
<td>Miles Driven Per Person</td>
<td style="text-align: center;">3.856*10<sup>-1</sup></td>
<td style="text-align: center;">1.470</td>
<td style="text-align: center;">.1172371</td>
<td style="text-align: center;">1.046</td>
</tr>
<tr class="odd">
<td>Prison Percent</td>
<td style="text-align: center;">4.393*10<sup>-4</sup></td>
<td style="text-align: center;">1.000439</td>
<td style="text-align: center;">146.3768</td>
<td style="text-align: center;">1.066</td>
</tr>
<tr class="even">
<td>Prime Driving Age Percent</td>
<td style="text-align: center;">-3.847</td>
<td style="text-align: center;">.02134</td>
<td style="text-align: center;">.00896</td>
<td style="text-align: center;">.9661</td>
</tr>
<tr class="odd">
<td>Median Income Change</td>
<td style="text-align: center;">1.091*10<sup>-2</sup></td>
<td style="text-align: center;">1.0110</td>
<td style="text-align: center;">2.203699</td>
<td style="text-align: center;">1.024</td>
</tr>
</tbody>
</table>
<p>Relative to their respective data ranges, the variable with the greatest effect on highway fatality rate is gas usage per person. This is interesting because gas usage and miles driven per person explain pretty much the same things about highway fatality rate, which might suggest that only one of these variables is useful, yet both variables show up in the final model. The best explanation for this is that fuel-efficiency (driving more miles while using less gas) has been proven to lessen the risk of traffic fatalities; “fuel efficiency has a statistically significant and negative effect on traffic fatalities at the state level; given that the results of all three models are the same, this result would be considered robust,” (Gius 2009). However, this relationship must be taken with a grain of salt, as “this result runs counter to the results of most of the prior research,” (Gius 2009). The fact that prior research exists to counter this explanation may suggest that the ratios shown in the table may be slightly misleading; conventional wisdom would first assume that miles driven can affect highway fatality rates before considering gas usage. Even so, both gas usage and miles driven show positive correlations with highway fatality rate, which makes sense because driving more miles increases one’s risk of getting into an accident.</p>
<p>Alcohol consumption per capita actually has a negative correlation, which is interesting since binge drinking has been proven to be correlated with irresponsible driving behaviors. Again, this shows the difference between binge drinking and alcohol consumption, reinforcing John Elflein’s New Hampshire explanation earlier in this paper. Even so, there is no doubt that drinking and driving significantly increases one’s risk of getting into an accident, so why is there a negative correlation between alcohol consumption per capita and highway fatality rate? The best explanation is that people who live in states where alcohol is more readily available are generally more educated on how to drink responsibly and avoid drinking and driving. This is backed up by prior research; “on-premise availability of alcohol was significantly and inversely associated with motor vehicle fatalities. This suggests that when on-premise outlets are fewer and more geographically spread out, the chances of drinking and driving are greater,” (Colon 2002).</p>
<p>The negative coefficient for median income makes sense because states that are generally poorer might not have the resources to invest in major beneficial changes in traffic. This negative coefficient also helps explain the positive coefficient for prison population proportion, as median income is heavily negatively correlated with prison population proportion. However, prison population proportion must be significant regardless of whether the income variable is present, since it does not get removed from the model via the stepAIC function. [include explanation here when I find a good explanation] Prime driving age percent has a negative coefficient, which also makes intuitive sense because states with more people in their driving prime have fewer people who are more prone to making poor decisions on the road. Finally, median income change has a positive coefficient, which suggests that states with growing incomes generally have higher fatality rates. Income inequality is a constant problem in the US that has only worsened over time, so states that are seeing recent growth in income are also more likely to have their income inequality increase. Furthermore, studies from the Canadian Economics Association show that income inequality is also a determining factor for highway fatality rate (Anbarci 2009), so, using income inequality as a proxy, it can be logically proven that the positive coefficient for median income change makes sense in this context.</p>
<p>The effect of regions, however, appears to be by far the most drastic. The ratios in highway fatality rate when going between regions, accounting for all other variables in the model, are:</p>
<p>e<sup>-.1624</sup> = .8501 for Northeastern to Midwestern cities,</p>
<p>e<sup>.0655</sup> = 1.068 for Southern to Midwestern cities, and</p>
<p>e<sup>.1429</sup> = 1.154 for Western to Midwestern cities.</p>
<p>This means that there are certain ways in which roads or highway systems are constructed in each region that affects highway fatality rate. The most interesting thing about this is that accounting for all other variables shows that Western states have a higher ratio to Midwestern states than Southern states, contradicting the EDA that paints Southern states in a bad light. This is because variables that are associated with Southern states scoring the lowest or highest, such as gas usage, miles driven, prison population proportion, median income, etc. are all already present in the model. This is a good sign because it shows that there exists a combination of variables in the model that can at least somewhat explain Southern states’ highway fatality problem.</p>
<p>Another thing that should be noted about the final model is the absence of population density and public transport ridership as variables. This does not suggest that these variables are useless for explaining highway fatality rate, it simply means that other variables that explain the same things are more significant. For example, the reason population density is not included can be attributed to the presence of miles driven per person in the model; as shown in the EDA, less dense states require drivers to drive more miles (and use more gas). The presence of miles driven (and gas used) per person also makes the inclusion of public transport ridership per person unnecessary since both variables are heavily negatively correlated with public transport ridership per person, omitting what would seem like a very important variable from the final model.</p>
</section>
<section id="discussionconclusions" class="level3">
<h3 class="anchored" data-anchor-id="discussionconclusions">5. Discussion/Conclusions</h3>
<p>Restate your objective and draw connections between your analyses and objective. In other words, how did (or didn’t) you answer/address your objective. Place these all in the larger scope of previous research on your topic (i.e.&nbsp;what you found from the literature review), that is, how do your findings help the field move forward? Talk about the limitations of your findings and possible areas for future research to better investigate your research question. End with a concluding sentence or two that summarizes your key findings and impact on the field.</p>
<section id="assessment" class="level5">
<h5 class="anchored" data-anchor-id="assessment">Assessment:</h5>
<ul>
<li>Does the author clearly state whether the results answer the question (support or disprove the hypothesis)?</li>
<li>Were specific data cited from the results to support each interpretation? Does the author clearly articulate the basis for supporting or rejecting each hypothesis?</li>
<li>Does the author adequately relate the results of the current work to previous research?</li>
</ul>
</section>
</section>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">6. References</h3>
<section id="assessment-1" class="level5">
<h5 class="anchored" data-anchor-id="assessment-1">Assessment:</h5>
<ul>
<li>Are the references appropriate and of adequate quality? Are the references cited properly (both in the text and at the end of the paper)?</li>
</ul>
</section>
<section id="some-general-criteria-that-may-be-used-include" class="level5">
<h5 class="anchored" data-anchor-id="some-general-criteria-that-may-be-used-include">Some general criteria that may be used include:</h5>
<ul>
<li>Description of the data source</li>
<li>Accuracy of data analysis</li>
<li>Accuracy of conclusions and discussion</li>
<li>Overall clarity and presentation</li>
<li>Originality and significance of the study</li>
<li>Writing quality and organization of the paper</li>
</ul>
<p>*<strong>This template is based on the <a href="https://www.causeweb.org/usproc/report-template">USPROC competition</a>.</strong></p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>